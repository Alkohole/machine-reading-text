!function(e){function t(i){if(s[i])return s[i].exports;var n=s[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var s={};t.m=e,t.c=s,t.d=function(e,s,i){t.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,s){if(1&s&&(e=t(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var n in e)t.d(i,n,function(t){return e[t]}.bind(null,n));return i},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=199)}([function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,s){const i=Boolean(t);return e in{scroll:!0}&&s&&S?{passive:s,capture:i}:i}t.__esModule=!0,t.default=void 0,s(1),i(s(97));var r=i(s(98)),o=i(s(99)),a=s(14),l=s(8),c=s(100),d=s(19);let u=0;const h=/image/i,p={ar:!0,fa:!0,he:!0,ur:!0,yi:!0},g=navigator.userAgent.toLowerCase(),E=[[223,223],[880,1791],[2304,3711],[4256,4351],[12352,12543],[19968,40879],[44032,55215]],_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},T=E.length,m={tm:0,val:null},f=Boolean(document.documentElement.classList)&&Boolean(document.createElementNS("http://www.w3.org/2000/svg","svg").classList);let S=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get(){S=!0}}))}catch(e){}const C=document.createElement("link"),A={yandexuid:"yu",_ym_uid:"yum",spravka:"sprvk"},L={mob:/mobi|tablet/.test(g),iOS:function(e){if(/ip(hone|ad|od)/.test(e)){const t=e.match(/os ([0-9_]+)/);return t?parseFloat(t[1].replace(/_/g,".")):1}return 0}(g),android:function(e){const t=e.match(/android ([0-9.]*)/);return t?parseFloat(t[1]||1):0}(g),IE:/msie|trident/.test(g),macOS:/mac os/.test(g),chromeVersion:function(e){const t=e.match(/chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}(g),firefoxVersion:function(e){const t=e.match(/firefox\/([0-9]+)\./);return t?parseInt(t[1]):0}(g),ieVersion:(y=g,y.indexOf("msie ")>0?10:y.indexOf("trident/")>0?11:y.indexOf("edge/")>0?12:0),safariVersion:function(e){if(!e.match(/chrom(e|ium)\/([0-9]+)\./)&&e.indexOf("safari/")>0){const t=e.match(/version\/([0-9]+)/);return t?parseInt(t[1]||1):0}return 0}(g),yaBro:-1!==g.indexOf("yabrowser"),isLinux:-1!==g.indexOf("linux")&&-1===g.indexOf("android"),assertTrue(e,t){if(!e)throw new Error(t)},assertNotEmptyString(e,t){this.assertTrue(e&&this.isString(e),t)},noop(){},trim(e){return this.isString(e)?e.trim():e},bind(e,t,s,i,r=!0){e.addEventListener(t,s,n(t,i,r))},unbind(e,t,s,i,r=!0){e.removeEventListener(t,s,n(t,i,r))},isUrl:e=>e.includes(".")&&!e.includes(" ")&&!/\s/.test(e)&&r.default.test(e)&&RegExp.$4.length>1,getHostname(e){return this.isUrl(e)?e.match(r.default)[2]:""},isEmail:e=>o.default.test(e),isImageFile:e=>e&&h.test(e.type),clone(e){return this.isArray(e)?e.slice():this.isObject(e)?this.extend({},e):e},toObject(e){const t={};for(const s in e)t[s]=e[s];return t},slice:(e,t,s)=>Array.prototype.slice.call(e,t,s),findIndex:(e,t,s)=>!1,findIndexInternal:(e,t,s)=>!1,extend:Object.assign||function(e={}){return!1},capitalizeWord:e=>e.charAt(0).toUpperCase()+e.substr(1),isAlpha(e){if(e.toLowerCase()!==e.toUpperCase())return!0;for(let t=0,s=e.charCodeAt(0);t<T;t++)if(s>=E[t][0]&&s<=E[t][1])return!0;return!1},isDigit(e){const t=e.charCodeAt(0);return t>=48&&t<=57},isEqual:Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t},isEmpty(e){return!e||(this.isArray(e)?0===e.length:!!this.isObject(e)&&0===Object.keys(e).length)},forEach(e,t,s){for(let i=0;i<e.length&&!1!==t.call(s,e[i],i,e);i++);},hasAlpha(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(this.isAlpha(e.charAt(t)))return!0;return!1},hasDigit(e){if(!e)return!1;for(let t=0;t<e.length;t++)if(this.isDigit(e.charAt(t)))return!0;return!1},getEmoji:e=>!1,hasEmojiOnly:e=>!1,getEmojiCodes:e=>!1,getValueTokens(e,t){return this.trim(e).split(/\s+/,t)},hasAlphaOrDigit(e){return this.hasAlpha(e)||this.hasDigit(e)},getStyle(e,t){const s=window.getComputedStyle(e,null)||e.style;return t?s[t]:s},setStyles(e,t){for(const s in t)t.hasOwnProperty(s)&&(e.style[s]=t[s])},throttle(e,t){let s=!0;const i=this.isNumber(t)?t:50;return function(){s&&(e.apply(this,arguments),s=!1,setTimeout(function(){s=!0},i))}},throttleWithCallGuarantee(e,t=50){let s,i;return(...n)=>{const r=this.now();clearTimeout(i),!s||r-s>=t?(s=r,e(...n)):i=setTimeout(()=>{s=this.now(),e(...n)},t-r+s)}},debounce(e,t=50){let s;const i=this.isNumber(t)?t:50,n=function(){const t=this,n=arguments;return clearTimeout(s),s=setTimeout(function(){e.apply(t,n)},i),this};return n.callNow=function(){return clearTimeout(s),e.apply(this,arguments),this},n},hasClass:f?function(e,t){return!!(e&&e instanceof HTMLElement)&&e.classList&&e.classList.contains(t)}:function(e,t){if(!(e&&e instanceof HTMLElement))return!1;const s=e.getAttributeNS(null,"class");return!!s&&(" "+s+" ").replace(/\s+/g," ").indexOf(" "+t+" ")>=0},saveFile:(e,t,s)=>!1,copyText:(window.clipboardData,function(e){return!1}),isRTLLang(e){return this.hasProperty(p,e)},hasCtrlKey:e=>Boolean(e.metaKey||e.ctrlKey),escapeHTML:e=>String(e).replace(/[&<>"']/g,e=>_[e]),unescapeHTML:e=>!1,generateId:(e="")=>e+ ++u,hasProperty(e,t){return this.isObject(e)&&Object.prototype.hasOwnProperty.call(e,t)},parseString:(e,...t)=>e?e.replace(/{([0-9]+)}/g,function(e,s){return t[s]}):"",activateClass(e,t,s){this.hasClass(e,t)!==Boolean(s)&&this.toggleClass(e,t)},toggleClass:f?function(e,t){return!!(e&&e instanceof HTMLElement)&&e.classList&&e.classList.toggle(t)}:function(e,t){const s=this.hasClass(e,t);let i=e.getAttributeNS(null,"class")||"";return s?i=(" "+i+" ").replace(/\s+/g," ").replace(" "+t+" "," "):i+=" "+t,e.setAttributeNS(null,"class",this.trim(i)),!s},createEvent(e,t,s){let i;try{i=new Event(e,{bubbles:t,cancelable:s})}catch(n){i=document.createEvent("Event"),i.initEvent(e,t,s)}return i},preventEvent(e){e.cancelable&&e.preventDefault()},shuffleArray:e=>!1,downloadFile:(e,t)=>!1,truncateText:(e,t)=>!1,startsWith:String.prototype.startsWith?function(e,t,s=0){return e.startsWith(t,s)}:function(e,t,s){return e.indexOf(t,s)===s},endsWith:String.prototype.endsWith?function(e,t,s){return e.endsWith(t,s)}:function(e,t,s){let i=s;return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t},escapeRegExp:e=>String(e).replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),dataURLToBlob:e=>!1,selectElement:e=>!1,isAlphaOrDigit(e){return this.isAlpha(e)||this.isDigit(e)},isString:e=>"string"==typeof e,isNumber:e=>"number"==typeof e&&window.isFinite(e),isBoolean:e=>"boolean"==typeof e,isObject:e=>"object"==typeof e&&null!==e,isArray:Array.isArray,isNonEmptyArray(e){return this.isArray(e)&&e.length>0},isFunction:e=>"function"==typeof e,isNullOrUndefined:e=>null==e,toQueryString:(e,t)=>!1,encodeURIComponent:e=>!1,wrapCanvasText:()=>!1,copySupported:"clipboardData"in window||!1,fromQueryString:e=>!1,prepareCSVValue:e=>'"'+e.replace(/"/g,'""')+'"',normalizeUrl:e=>(C.href=e||"",C.href),isCrossOriginUrl:e=>!1,isSecureUrl:e=>!1,isYandexUrl:e=>!1,setCookie(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)},getCookie(e,t=!1){let s=m.val;const i=(new Date).getTime();(t||!m.val||i-m.tm>100)&&(m.tm=i,s=m.val=document.cookie.split("; "));const n=encodeURIComponent(e);for(let e=0;e<s.length;++e){const t=s[e],i=t.indexOf("=");if(t.substr(0,i)===n)return decodeURIComponent(t.substr(i+1))}return null},getUserIdData(){const e={};for(const t in A){if(!A.hasOwnProperty(t))continue;const s=this.getCookie(t);s&&(e[A[t]]=s)}return e},isSelectedElement(e){const t=window.getSelection();if(t.isCollapsed)return!1;const s=document.createRange();s.selectNodeContents(e);try{for(let e=0;e<t.rangeCount;e++){const i=t.getRangeAt(e);if(i.compareBoundaryPoints(i.END_TO_START,s)<0&&i.compareBoundaryPoints(i.START_TO_END,s)>0)return!0}}catch{return!1}return!1},getImageOrientation:e=>!1,extractPastedText:e=>!1,normalizeRangeBoundsForElement(e,t){t.contains(e.startContainer)||t.contains(e.startContainer.parentNode)||e.setStart(t,0),t.contains(e.endContainer)||t.contains(e.startContainer.parentNode)||e.setEnd(t,t.childNodes.length)},getClosest(e,t){let s=e;for(;s&&s.nodeType===Node.ELEMENT_NODE;){if(t(s))return s;s=s.parentElement}return null},safeParseJSON(e){try{return JSON.parse(e)||{}}catch(e){return{}}},safeStringifyJSON(e){try{return JSON.stringify(e)||""}catch(e){return""}},getEventPath:e=>!1,getSelectedText:()=>!1,getSelectedElement:()=>!1,isEqualDeep:(e,t)=>!1,convertBase64ToArrayBuffer(e){const t=window.atob(e),s=t.length,i=new Uint8Array(s);for(let e=0;e<s;e++)i[e]=t.charCodeAt(e);return i.buffer},getMutableBoundingClientRect:e=>!1,getFilesFromEvent:e=>(e.dataTransfer?e.dataTransfer.files:e.target.files)||[],getFileName:e=>!1,getDataAttr:(e,t)=>e&&e.nodeType===Node.ELEMENT_NODE?e.getAttribute("data-"+t):null,getAttribute:(e,t,s="")=>e&&e.getAttribute?e.getAttribute(t)||s:s||null,asyncFilter(e,t,s=(()=>{})){const i=[...e],n=[],r=()=>{if(!i.length)return s(n);const e=i.shift();t(e,t=>{t&&n.push(e),r()})};r()},isElement:e=>e instanceof Element||e instanceof HTMLDocument,elementToString:(e,t=50,s=null)=>!1,round:(e,t=10)=>L.isNumber(e)?Math.round(e/t)*t:null,base64ToDataUrl:(e,t)=>`data:${t};base64,${e}`,isOnline:()=>void 0===navigator.onLine||navigator.onLine,guid:(e="xxxx-xxxx-xxxx-xxxx")=>e.replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),now:()=>Date.now?Date.now():(new Date).getTime(),duration(e){return this.now()-e},bindInit:e=>(function(){const t=L.now();try{return L.queueTask(e.bind(this,...arguments)),this}catch(e){return(0,l.logError)(e),this}finally{a.DEBUG&&a.logTime.module(e.name,L.now()-t)}}),queueTask(e,t=null){if(window.config.SRV!==d.TOUCH||!window.config.ENABLE_ASYNC_QUEUE)return e.call(t);(0,c.pushTask)({fn:e,ctx:t||this})},callAsync(e,t){(0,c.pushTask)({fn:e,ctx:t||this})},calcMedian(e){if(!e.length)return null;e.sort((e,t)=>e-t);const t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2},smoothScrollTo(e,t,s=0){e.scrollTo?e.scrollTo({top:t,left:s,behavior:"smooth"}):"scrollTop"in e&&(e.scrollTop=t,e.scrollLeft=s)},normalizeExternalLang(e,t){const s=t.langMismatches||{};return this.hasProperty(s,e)?s[e]:e},get(e,t,s){const i=t.split(".");if(!i.length)return s;let n=e;for(const e of i){if("object"!=typeof n||null===n)return s;n=n[e]}return void 0===n?s:n},removeAllSelections:()=>!1,performanceApiSupported:()=>Boolean(window.performance&&window.performance.timing),isIntersectionObserverSupported:()=>"IntersectionObserver"in window,getTapPoint:e=>!1,getRandomBoolean:()=>Math.random()>=.5,memoize:e=>!1,isElvishLanguage:(e="")=>"sjn"===e};var y;window.util=L;var R=L;t.default=R},function(e,t,s){for(var i=s(75),n=s(53),r=s(41),o=s(12),a=s(13),l=s(39),c=s(18),d=c("iterator"),u=c("toStringTag"),h=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},g=n(p),E=0;E<g.length;E++){var _,T=g[E],m=p[T],f=o[T],S=f&&f.prototype;if(S&&(S[d]||a(S,d,h),S[u]||a(S,u,T),l[T]=h,m))for(_ in i)S[_]||r(S,_,i[_],!0)}},function(e,t,s){"use strict";t.__esModule=!0,t.TouchView=t.TOUCH_VIEW_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(10),o=s(16);const a={TAP:"tap",TOUCH_START:"touchstart",SELECT:"select"};t.TOUCH_VIEW_EVENTS=a;class l extends o.View{static getPoint(e){return{x:e.pageX,y:e.pageY}}static getPoints(e){return e.touches&&!n.default.isEmpty(e.touches)?Array.prototype.map.call(e.touches,this.getPoint):[this.getPoint(e)]}static getMidpoint(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}static getDistance(e,t){const s=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return Math.sqrt(s*s+i*i)}constructor(e={}){let t,s;if(super(e),this.resetCount(),this._tapThreshold=Number(e.tapThreshold)||10,this._ignoreSelection=Boolean(e.ignoreSelection),e.stopDefaultAction&&this.on(l.eventTypes.START,n.default.preventEvent).on(l.eventTypes.END,n.default.preventEvent),e.hideAfterTransition&&this.on("stateSet:hidden",function(e){return!1}).on(l.eventTypes.TRANSITION_END,function(e){return!1}).bindDOMEvents(l.eventTypes.TRANSITION_END),this.hasState("animatable")&&!e.skipWillChange&&this.onVisibilityChanged(function(){return!1}).on(l.eventTypes.TRANSITION_END,function(e){return!1}).bindDOMEvents(l.eventTypes.TRANSITION_END),this.on(l.eventTypes.START,function(e){const t=e.touches;"button"in e&&0!==e.button||(this._pointCount=Math.min(t?t.length:this._pointCount+1,l.maxPointCount[t?"touch":e.pointType||"mouse"]),this._tapPoint=1!==this._pointCount?null:l.getPoints(e)[0])}).on(l.eventTypes.END,function(e){const t=e.touches,s=this._tapPoint,i=e.changedTouches;if("button"in e&&0!==e.button)return;if(this._pointCount=t?t.length:Math.max(0,this._pointCount-1),!s)return;const r=i?i[0].pageX:e.pageX,o=i?i[0].pageY:e.pageY;this.isEnabled()&&Math.abs(r-s.x)<=this._tapThreshold&&Math.abs(o-s.y)<=this._tapThreshold&&(this._ignoreSelection||!n.default.isSelectedElement(this.getElement()))&&this.emit(a.TAP,e),this._tapPoint=null}).on(l.eventTypes.CANCEL,this.resetCount).bindDOMEvents([l.eventTypes.END,l.eventTypes.START,l.eventTypes.CANCEL]),e.activateFocus){let t=!1;this.on(l.eventTypes.START,function(s){t=!e.ignorePreventFocus&&n.default.getClosest(s.target,e=>e.hasAttribute("data-prevent-focus"))}).on("focus",function(e){t?e.preventDefault():this.setFocus(!0).setState("focused",!0)}).on("blur",function(){const e=this,t=this.getElement();setTimeout(function(){(document.hasFocus&&!document.hasFocus()||!t.contains(document.activeElement))&&e.setState("focused",!1)},0),this.setFocus(!1)}).bindDOMEvents("focus blur",!0)}e.delegateActiveState&&(s=function(){t&&(t.setAttribute("data-pressed",!1),t=null)},this.on(l.eventTypes.START,function(e){let i=e.target;s(),i=this.getClosest(i,function(e){return e.hasAttribute("data-active-target")}),i&&(t=i,t.setAttribute("data-pressed",!0))}).on(l.eventTypes.END,s).on(l.eventTypes.CANCEL,s))}setFocus(e){return(0,r.getGlobalEmitter)().emit("viewFocusChanged",this,e),this.getContentElement()[e?"focus":"blur"](),this}setTooltipText(e){return this.getElement().setAttribute("data-tooltip",e),this}setTooltipPosition(e){return this.getElement().setAttribute("data-tooltip-position",e),this}scrollTo(e,t){const s=this.getContentElement(),i="rtl"===n.default.getStyle(s,"direction")?s.scrollWidth:0;return this.userScroll=!1,s.scrollTop=n.default.isNumber(e)?e:0,s.scrollLeft=n.default.isNumber(t)?t:i,this}resetCount(){return this._tapPoint=null,this._pointCount=0,this}getClosest(e,t,s){const i=s?this.getContentElement():this.getElement();return i.contains(e)&&e!==i?n.default.getClosest(e,t):null}setLanguage(e){return this.setState("right",n.default.isRTLLang(e)),this.getElement().setAttribute("lang",e),this}getScrollInfo(){const e=this.getContentElement();return{top:e.scrollTop,left:e.scrollLeft,maxTop:e.scrollHeight-e.clientHeight,maxLeft:e.scrollWidth-e.clientWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}onTap(e){return this.on(a.TAP,e)}onTouchStart(e){return this.on(a.TOUCH_START,e)}}t.TouchView=l,l.eventTypes={END:"mouseup",OUT:"mouseout",OVER:"mouseover",MOVE:"mousemove",START:"mousedown",WHEEL:"wheel",CANCEL:"mouseleave",TRANSITION_END:"WebkitTransition"in document.documentElement.style?"webkitTransitionEnd":"transitionend"},l.maxPointCount={pen:1,mouse:1,touch:10},"ontouchstart"in window&&(n.default.mob||n.default.iOS||n.default.android)?l.eventTypes={END:"touchend",MOVE:"touchmove",START:"touchstart",CANCEL:"touchcancel"}:!window.PointerEvent||"pointerEnabled"in navigator&&!navigator.pointerEnabled||(l.eventTypes={END:"pointerup",OUT:"pointerout",OVER:"pointerover",MOVE:"pointermove",START:"pointerdown",CANCEL:"pointercancel"})},function(e,t,s){"use strict";t.__esModule=!0,t.$tracker=void 0,t.getTrackerByNamespace=function(e=null){return!1},s(1),s(8);var i=s(10);s(9),(0,i.getGlobalEmitter)();const n={};t.$tracker=n,new Map},function(e,t,s){"use strict";t.__esModule=!0,t.Model=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(9);const o="change",a="set",l="beforeSet",c="invalid";class d extends r.Emitter{static getCachedInstance(e,...t){return this._cachedInstances=this._cachedInstances||new Map,this._cachedInstances.has(e)||this._cachedInstances.set(e,new this(...t)),this._cachedInstances.get(e)}constructor(e,t={}){super(),this._id=t.id||n.default.generateId("mid"),this._props={},this._invalid=[],this._filters={},this._validators={},t.filters&&this.setFilter(t.filters),t.validators&&this.setValidator(t.validators),this.setProperty(n.default.extend(this.getDefaults(),e),t)}getId(){return this._id}clone(e){return new this.constructor(this._props,e)}clear(e){return this.setProperty(null,e)}reset(e){return this.setProperty(this.getDefaults(),e)}onChange(e,t,s){return this._addPrefixedHandler(o,e,t,s)}onSet(e,t,s){return this._addPrefixedHandler(a,e,t,s)}onBeforeSet(e,t,s){return this._addPrefixedHandler(l,e,t,s)}onInvalid(e,t,s){return this._addPrefixedHandler(c,e,t,s)}offChange(e,t,s){return this._removePrefixedHandler(o,e,t,s)}toJSON(){return n.default.clone(this._props)}cloneProps(){return n.default.clone(this._props)}getProps(){return this._props}isValid(e,t){return!1}getInvalid(){return n.default.clone(this._invalid)}getParams(){return{sid:this._fetchedSid}}getDefaults(){return this.constructor.defaults?n.default.clone(this.constructor.defaults):{}}hasProperty(e){return n.default.hasProperty(this._props,e)}getProperty(e){return this._props[e]}toggleProperty(e){return this.setProperty(e,!this.getProperty(e))}setProperty(e,t,s){const i=this.cloneProps(),r=s||{};let d,u=t;if(null===e||n.default.isObject(e)){const t=u||{};return e?(Object.keys(e).forEach(function(s){this.setProperty(s,e[s],t)},this),this):(Object.keys(i).forEach(function(e){this.setProperty(e,null,t)},this),this)}if(this.emit(l,e,u,r).emit(`${l}:${e}`,u,r),n.default.isNullOrUndefined(u)){if(!this.hasProperty(e))return this;u=void 0,d=delete this._props[e]}else{const t=this._filters[e];t&&(u=t.call(this,u)),n.default.isEqual(i[e],u)||(d=!0,this._props[e]=u)}return r.ignoreSetEvent||this.emit(a,e,u,r).emit(`${a}:${e}`,u,r),d&&!r.silent&&(r.invalid=!this.isValid(e,u),r.oldValue=i[e],r.invalid&&this.emit(c,e,u,r).emit(`${c}:${e}`,u,r),this.emit(o,e,u,r).emit(`${o}:${e}`,u,r)),this}setFilter(e,t){return n.default.isObject(e)?(Object.keys(e).forEach(function(t){this.setFilter(t,e[t])},this),this):null===e?(this._filters={},this):null===t?(delete this._filters[e],this):(e&&n.default.isFunction(t)&&(this._filters[e]=t),this)}setValidator(e,t){return n.default.isObject(e)?(Object.keys(e).forEach(function(t){this.setValidator(t,e[t])},this),this):null===e?(this._validators={},this):null===t?(delete this._validators[e],this):(e&&n.default.isFunction(t)&&(this._validators[e]=t),this)}}t.Model=d,d.defaults={}},function(e,t,s){"use strict";t.__esModule=!0,t.AppModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(9);class o extends r.Emitter{constructor(e,t){super(),this.app=e,this.appModel=e.getModel(),this.appSettings=e.getSettings(),this.appView=e.getView(),this.appConfig=t,this.moduleId=n.default.generateId("mid")}}t.AppModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.Component=void 0;var i=s(16),n=s(25),r=s(2);class o extends n.PureComponent{constructor(e,t={}){super(e,t),this._DOMEvents={},t.hideAfterTransition&&this.onStateSet("hidden",e=>{e?t.skipFadeoutTransition&&this.setState("hidden2",!0):(this.setState("hidden2",!1),this.getElement().offsetWidth)}).on(r.TouchView.eventTypes.TRANSITION_END,e=>{"visibility"!==e.propertyName||e.target!==e.currentTarget||this.isVisible()||this.setState("hidden2",!0)}).bindDOMEvents(r.TouchView.eventTypes.TRANSITION_END)}getRect(){return i.View.prototype.getRect.apply(this)}hasState(e){return i.View.prototype.hasState.apply(this,arguments)}setState(e,t){return i.View.prototype.setState.apply(this,arguments)}setStyle(e,t){return i.View.prototype.setStyle.apply(this,arguments)}isVisible(){return i.View.prototype.isVisible.apply(this)}isEnabled(){return i.View.prototype.isEnabled.apply(this)}getElement(){return this.getContainer()}getContentElement(e,t){return i.View.prototype.getContentElement.apply(this,arguments)}setPosition(e,t,s){return i.View.prototype.setPosition.apply(this,arguments)}setVisible(e){return i.View.prototype.setVisible.apply(this,arguments)}setEnabled(e){return i.View.prototype.setEnabled.apply(this,arguments)}onShow(e,t){return i.View.prototype.onShow.apply(this,arguments)}onHide(e,t){return i.View.prototype.onHide.apply(this,arguments)}onVisibilityChanged(e,t){return i.View.prototype.onVisibilityChanged.apply(this,arguments)}onEnableChanged(e,t){return i.View.prototype.onEnableChanged.apply(this,arguments)}onStateSet(e,t,s){return i.View.prototype.onStateSet.apply(this,arguments)}onStateChanged(e,t,s){return i.View.prototype.onStateChanged.apply(this,arguments)}handleEvent(e){return i.View.prototype.handleEvent.apply(this,arguments)}bindDOMEvents(e,t){return i.View.prototype.bindDOMEvents.apply(this,arguments)}}t.Component=o},function(e,t,s){"use strict";t.__esModule=!0,t.LANG_PROPS=t.LANG_METRIKAS=t.LANG_EVENTS=t.COMPONENT_EVENTS=void 0,t.LANG_EVENTS={EVENT_OPEN_SRC_LANGUAGES:"openSrcLanguages",EVENT_OPEN_DST_LANGUAGES:"openDstLanguages",EVENT_BACK_PRESSED:"langsBackPressed",EVENT_INPUT:"langsInput",EVENT_SWAP:"swapLang",EVENT_CANCEL_SEARCH:"cancelSearch",EVENT_SEARCH_TAP:"langsSearchTap",EVENT_SELECT_LANG:"selectLang",EVENT_SELECT_LANG_FROM_SEARCH:"langsSearchSelectLang"},t.LANG_METRIKAS={OPEN_SRC_SELECT:"langselect_open_src",OPEN_DST_SELECT:"langselect_open_dst",SELECT_SRC_LANG:"langselect_select_src",SELECT_DST_LANG:"langselect_select_dst",PIN_LANG:"langselect_pin",UNPIN_LANG:"langselect_unpin",SEARCH_TEXT_TYPE:"langselect_search_type",SEARCH_BUTTON_TAP:"langselect_search_button_click",TOGGLE_AUTODETECT:"settings_auto_click"},t.LANG_PROPS={ALL_LANGUAGES:"languages",CURRENT_LANG:"currentLanguage",AUTODETECT:"autodetect",RECENT_LANGUAGES:"recent_languages",SRC_LANG:"srcLang",DST_LANG:"dstLang",SENDER_LANG_SELECT:"langSelect",SENDER_LANG_HISTORY:"langHistory"},t.COMPONENT_EVENTS={EVENT_INPUT:"event_input",EVENT_LANG_CHOOSE:"event_lang_choose"}},function(e,t,s){"use strict";function i(){return window._rumLatestTapEvent}function n(){return window._rumLatestTapPosition}t.__esModule=!0,t.LATEST_TAP_POSITION_WINDOW_KEY=t.LATEST_TAP_EVENT_WINDOW_KEY=void 0,t.getLatestTapEvent=i,t.getLatestTapPosition=n,t.isPrevTapMiss=function(){const e=i(),t=n();return e&&t&&e.prevTarget&&e.target!==e.prevTarget&&e.delayBetweenTaps<700&&t.distanceBetweenTaps<60},t.logError=function(e,t={}){const s=window.Ya&&window.Ya.Rum;if(a.DEBUG&&console.error(e),s&&s.logError)try{let i=e;return e instanceof Error&&(i=e.message),s.logError(t,i)}catch(e){}e&&setTimeout(()=>{throw e},0)},t.setLatestTapEvent=function(e,t,s){const r=Date.now(),a=i(),l=n(),c=a&&a.ts?r-a.ts:null,d={pageX:e.pageX,pageY:e.pageY,distanceBetweenTaps:null},u={eventType:e.type,pageX:null,pageY:null,ts:r,delay:null,target:o.default.elementToString(t,15,["id","class","data-action"]),action:o.default.getDataAttr(s,"action"),prevTarget:a&&a.target,prevAction:a&&a.action,delayBetweenTaps:o.default.round(c,c>100?100:10)};var h,p;!d.pageX&&!d.pageY&&e.changedTouches&&e.changedTouches.length&&(d.pageX=e.changedTouches[0].pageX,d.pageY=e.changedTouches[0].pageY),u.pageX=o.default.round(d.pageX),u.pageY=o.default.round(d.pageY),l&&(d.distanceBetweenTaps=(h=d,p=l,Math.abs(h.pageX-p.pageX)+Math.abs(h.pageY-p.pageY))),window._rumLatestTapEvent=u,window._rumLatestTapPosition=d};var r,o=(r=s(0))&&r.__esModule?r:{default:r},a=s(14);t.LATEST_TAP_EVENT_WINDOW_KEY="_rumLatestTapEvent",t.LATEST_TAP_POSITION_WINDOW_KEY="_rumLatestTapPosition"},function(e,t,s){"use strict";t.__esModule=!0,t.Emitter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i};const r="action";t.Emitter=class{constructor(){this._handlers={}}on(e,t,s){const i=this._handlers;return n.default.isFunction(e)?this.on("*",e):n.default.isArray(e)?(e.forEach(e=>{const i=t.bind(s||this,e);i.sourceHandler=t,this.on(e,i,s)}),this):n.default.isObject(e)?(Object.keys(e).forEach(s=>{this.on(s,e[s],t)}),this):e&&n.default.isFunction(t)?((i[e]=i[e]||[]).push({handler:t,context:s}),this):this}off(e,t,s){const i=arguments.length,r=this._handlers[e];if(!i)return this._handlers={},this;if(n.default.isFunction(e))return this.off("*",e);if(n.default.isArray(e))return e.forEach(e=>{this.off(e,t,s)}),this;if(n.default.isObject(e))return Object.keys(e).forEach(s=>{this.off(s,e[s],t)}),this;if(!r)return this;if(1===i)return delete this._handlers[e],this;for(let e=0;e<r.length;e++){const i=r[e];if(i.context===s&&(i.handler===t||i.handler.sourceHandler===t)){r.splice(e,1);break}}return this}once(e,t,s){const i=this;if(n.default.isFunction(e))return this.once("*",e);if(n.default.isObject(e))return Object.keys(e).forEach(function(s){this.once(s,e[s],t)},this),this;if(!e||!n.default.isFunction(t))return this;const r=function(){i.off(e,r,s),t.apply(this,arguments)};return r.sourceHandler=t,this.on(e,r,s)}emit(e){const t=n.default.slice(arguments,1);let s=this._handlers[e],i=this._handlers["*"];if(n.default.isObject(e))return Object.keys(e).forEach(function(t){this.emit(t,e[t])},this),this;if("*"!==e&&s){s=n.default.slice(s);for(let e=0;e<s.length;e++){const i=s[e];i.handler.apply(i.context||this,t)}}if(i){i=n.default.slice(i);for(let e=0;e<i.length;e++){const t=i[e];t.handler.apply(t.context||this,arguments)}}return this}prefixedEmit(e,t,...s){return this.emit(e,t,...s),this.emit(`${e}:${t}`,...s)}onAction(e,t,s){return this._addPrefixedHandler(r,e,t,s)}debounceMethod(e,t=0){return n.default.debounce(e.bind(this),t)}_addPrefixedHandler(e,t,s,i){return n.default.isArray(t)?(t.forEach(t=>{const n=s.bind(i||this,t);n.sourceHandler=s,this.on(`${e}:${t}`,n,i)}),this):n.default.isObject(t)?(Object.keys(t).forEach(i=>{this.on(`${e}:${i}`,t[i],s)}),this):n.default.isFunction(t)?this.on(e,t,s):this.on(`${e}:${t}`,s,i)}_removePrefixedHandler(e,t,s,i){return n.default.isFunction(t)?this.off(e,t,s):this.off(`${e}:${t}`,s,i)}}},function(e,t,s){"use strict";t.__esModule=!0,t.getGlobalEmitter=function(){return null===n&&(n=new i.Emitter),n};var i=s(9);let n=null},function(e,t,s){"use strict";t.__esModule=!0,t.KEYBOARD_KEYS=t.InputView=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2);const o={A:65,D:68,E:69,UP:38,DOWN:40,LEFT:37,RIGHT:39,ENTER:13,ESCAPE:27,SPACE:32,TAB:9,BACKSPACE:8};t.KEYBOARD_KEYS=o;const a=!1;class l extends r.TouchView{static makeFakeArea(e){return!1}static hasKeyCombination(e,t,s){return!1}constructor(e){super(e);const t=this,s=this.getContentElement();let i;s.disabled=this.hasState("disabled"),this.on("stateChanged:disabled",function(e){s.disabled=e}),this.bindDOMEvents("input keydown"),this.on("keydown",this._bindSelectionCases),9===document.documentMode&&(i=function(){t.emit("input",{target:s})},this.on("stateChanged:focused",function(e){document[(e?"add":"remove")+"EventListener"]("selectionchange",i,!1)}))}getName(){return this.getContentElement().name}getValue(){return this.getContentElement().value}setValue(e,t={}){const s=this.getContentElement(),i=this.getValue();if(e===i)return this;let r=t.end;const o=t.start;return n.default.isNumber(o)?(r=n.default.isNumber(r)?r:i.length,s.value=i.slice(0,o)+e+i.slice(r)):s.value=e,this.emit("input",{target:s,detail:t})}getSelection(){const e=this.getContentElement();return{end:e.selectionEnd,start:e.selectionStart}}setSelection(e={}){const t=this.getContentElement();return setTimeout(function(){t.focus(),t.setSelectionRange(e.start,e.end||e.start)},0),this}setPlaceholder(e){return this.getContentElement().placeholder=e,this}onSelect(e){return this.on(r.TOUCH_VIEW_EVENTS.SELECT,e)}getScrollTop(){return this.getContentElement().scrollTop}_bindSelectionCases(e){(l.hasKeyCombination(e,o.UP,{shiftKey:!0})||l.hasKeyCombination(e,o.DOWN,{shiftKey:!0}))&&this.emit(r.TOUCH_VIEW_EVENTS.SELECT,e)}}t.InputView=l,l.keys=o,l.fakeAreaSupported=a},function(e,t){var s=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=s)},function(e,t,s){var i=s(36),n=s(51);e.exports=s(27)?function(e,t,s){return i.f(e,t,n(1,s))}:function(e,t,s){return e[t]=s,e}},function(e,t,s){"use strict";function i(){const{debugEnabled:e,visualLogEnabled:t}=g,s=e?"color: #5c9b28":"color: #a43535",i="padding: 0 5px; font-family: monospace; background: rgba(100,100,100,.1);";let n=`Debug is %c${e?"enabled":"disabled"}%c. Type %c${e?"disableDebug()":"enableDebug()"}%c to ${e?"disable":"enable"} it`;p?(n=`${n}. Or use %c${t?"?log=0":"?log=1"}%c to ${t?"disable":"enable"} visual log`,console.info(n,s,"",i,"",i,"")):console.info(n,s,"",i,"")}function n(){localStorage.setItem("debug_config",JSON.stringify(g))}function r(e,t={}){console.info(e,t),p&&g.visualLogEnabled&&function(e,t={}){const s=(e,t=null)=>{const s=document.createElement("div");return s.classList.add(e),"string"==typeof t?s.appendChild(document.createTextNode(t)):Array.isArray(t)?t.forEach(e=>e&&s.appendChild(e)):t&&s.appendChild(t),s},i=(()=>{let e=document.getElementsByClassName("visual-log")[0];return e||(e=s("visual-log"),document.body.appendChild(e)),e})(),n=s("visual-log-item",[s("visual-log-item-message",e),s("visual-log-item-params",JSON.stringify(t))]);i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),setTimeout(()=>n.classList.add("visual-log-item_showed"),0),setTimeout(()=>{n.classList.add("visual-log-item_hidden"),setTimeout(()=>i.removeChild(n),400)},5e3)}(e,t)}function o(e){g.debugEnabled=e,window.debugEnabled=e,n(),i()}function a(){window.debugEnabled=g.debugEnabled,window.visualLogEnabled=g.visualLogEnabled,window.disableDebug=(()=>o(!1)),window.enableDebug=(()=>o(!0)),window.printDebug=r,p&&function(){let e=g.visualLogEnabled;const t=location.search.match(/[&?]log=(\d)/);t&&(e=Boolean(parseInt(t[1]))),g.visualLogEnabled!==e&&(g.visualLogEnabled=e,window.visualLogEnabled=e,n()),e&&!g.debugEnabled&&window.enableDebug()}(),i()}function l(e,t,s){_&&(T[e]||(T[e]={}),T[e][t]=T[e][t]?T[e][t]+s:s,clearTimeout(m[e]),m[e]=setTimeout(()=>{const t=Object.entries(T[e]).sort(([,e],[,t])=>t-e);r(`Total ${e} time ${t.reduce((e,[,t])=>e+t,0)}ms`,Object.fromEntries(t)),T[e]={}},1e3))}t.__esModule=!0,t.DEBUG=void 0,t.initDebugHelper=a,t.logTime=void 0,s(1);var c,d=(c=s(0))&&c.__esModule?c:{default:c},u=s(19);const h={debugEnabled:!1,visualLogEnabled:!1},p=window.config&&window.config.SRV===u.TOUCH,g=function(){try{const e=localStorage.getItem("debug_config"),t=e?JSON.parse(e):{};for(const e in h)t.hasOwnProperty(e)||(t[e]=h[e]);return t}catch(e){return console.error(e),h}}(),E=window.config&&window.config.DEBUG_SUPPORTED,_=E&&g.debugEnabled;t.DEBUG=_;const T={},m={},f={module(e,t){l("modules",e,t)},render(e,t){l("rendering",e,t)},metrics(e,t){l("metrics",e,t)}};t.logTime=f,(_||E)&&(a(),setTimeout(()=>(()=>{const e=document.querySelector(".YndxBug");if(!e)return;let t=!1;const s=getComputedStyle(e).bottom;document.addEventListener("touchstart",s=>{e.contains(s.target)&&(t=!0)}),document.addEventListener("touchend",()=>{t=!1}),
document.addEventListener("touchmove",s=>{if(t){const{y:t}=d.default.getTapPoint(s),i=Math.min(t,document.body.clientHeight-41);e.style.top=i+"px",e.style.bottom="auto"}}),e.addEventListener("click",()=>{e.style.top="",e.style.bottom=s})})(),2e3))},function(e,t,s){"use strict";function i(e,t=24){return`\n        <svg class="icn icn_${e}" width="${t}px" height="${t}px">\n            <use xlink:href="#icn-${e}"/>\n        </svg>\n    `}t.__esModule=!0,t.getIcnHtml=i,t.icn=function(e,t=24){return(0,n.unsafeHTML)(i(e,t))};var n=s(68)},function(e,t,s){"use strict";t.__esModule=!0,t.View=t.VIEW_STATES=t.VIEW_EVENTS=t.STATE_PREFIX=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(10),o=s(9);const a={CONTENT_CHANGED:"contentChanged",DESTROY:"destroy",STATE_SET:"stateSet",STATE_CHANGED:"stateChanged"};t.VIEW_EVENTS=a;const l={HIDDEN:"hidden",DISABLED:"disabled",EXTENDED:"extended",INVALID:"invalid",FOCUSED:"focused"};t.VIEW_STATES=l,t.STATE_PREFIX="state-";class c extends o.Emitter{constructor(e={}){super(e),this.on(a.CONTENT_CHANGED,function(e){(0,r.getGlobalEmitter)().emit("viewContentChanged",this,e)}),this._DOMEvents={},this.setElement(e.element,e)}setPosition(e,t=!1,s=!1){let i=e.left,n=e.bottom,r=c.positions.BOTTOM;const o=this.getElement(),a=this.getRect(),l=document.documentElement.clientWidth;switch(o.getAttribute("data-align")){case"right":i=e.right-a.width;break;case"center":i=e.left+e.width/2-a.width/2;break;case"predictorRight":e.right+c.TR_PREDICTOR_GAP>l?r=c.positions.LEFT:i=e.right;break;case"top-left":i=e.left-a.width,n=e.bottom-a.height}if(t){const t=document.documentElement.clientHeight;a.width>l&&"left"===o.getAttribute("data-align")?i=o.getAttribute("data-offset")||0:i+a.width>l&&a.width<l&&(i-=i+a.width-l),t-e.bottom<a.height&&e.top>=a.height&&(r=c.positions.TOP,n=e.top-a.height)}return s&&(i+=document.documentElement.scrollLeft,n+=document.documentElement.scrollTop),o.style.top=n+"px",o.style.left=i+"px",o.setAttribute(c.POSITION_ATTR,r),this}getId(){return this._id}destroy(){const e=this._element;return e.parentNode&&e.parentNode.removeChild(e),this.setElement(null),this.emit(a.DESTROY).off()}getRect(){return this._element.getBoundingClientRect()}hasState(e){if(void 0!==e)return n.default.hasClass(this._element,"state-"+e)}setState(e,t){if(n.default.isObject(e))return Object.keys(e).forEach(function(t){this.setState(t,e[t])},this),this;if(!e)return this;const s=this.hasState(e),i=arguments.length<2?!s:Boolean(t);return i===s||(this.emit(a.STATE_SET,e,i).emit(`${a.STATE_SET}:${e}`,i),n.default.toggleClass(this._element,"state-"+e),this.emit(a.STATE_CHANGED,e,i).emit(`${a.STATE_CHANGED}:${e}`,i)),this}setStyle(e,t){if(n.default.isObject(e))for(const t in e)this._element.style[t]=e[t];else this._element.style[e]=t;return this}setLeftOffset(e){return this.setStyle("left",e+"px")}getOffset(){return this.getRect().left}isVisible(){return!this.hasState(l.HIDDEN)}isEnabled(){return!this.hasState(l.DISABLED)}isValid(){return!this.hasState(l.INVALID)}isFocused(){return this.hasState(l.FOCUSED)}getElement(){return this._element}setElement(e,t={}){let s=n.default.clone(this._DOMEvents);const i=e||document.createElement("div");return this.unbindDOMEvents(s),this._id=i.id||this._id||n.default.generateId("vid"),this._element=i,this._contentElement=t.contentElement||i,(t.rebind||(s=t.DOMEvents))&&this.bindDOMEvents(s),this}setHTMLContent(e,t={}){const s=this.getContentElement();return s?(t.append||(s.innerHTML=""),s.insertAdjacentHTML("beforeend",e),this.emit(a.CONTENT_CHANGED,e,t)):this}setTextContent(e,t={}){const s=this.getContentElement();return s?(t.append||(s.innerHTML=""),s.appendChild(document.createTextNode(e)),this.emit(a.CONTENT_CHANGED,e,t)):this}setContentElementAttribute(e,t){const s=this.getContentElement();return s&&s.setAttribute(e,t),this}setVisible(e){const t=[l.HIDDEN];return arguments.length&&t.push(!e),this.setState.apply(this,t)}setEnabled(e){const t=[l.DISABLED];return arguments.length&&t.push(!e),this.setState.apply(this,t)}onShow(e,t){return this.onVisibilityChanged(s=>{s&&e.call(t||this)},t)}onHide(e,t){return this.onVisibilityChanged(s=>{s||e.call(t||this)},t)}onVisibilityChanged(e,t){return this.onStateChanged(l.HIDDEN,s=>{e.call(t||this,!s)},t)}onEnableChanged(e,t){return this.onStateChanged(l.DISABLED,s=>{e.call(t||this,!s)},t)}onStateSet(e,t,s){return this._addPrefixedHandler(a.STATE_SET,e,t,s)}onStateChanged(e,t,s){return this._addPrefixedHandler(a.STATE_CHANGED,e,t,s)}onContentChanged(e){return this.on(a.CONTENT_CHANGED,e)}handleEvent(e){this.emit(e.type,e)}bindDOMEvents(e,t){let s=e;const i=this._DOMEvents;if(!e)return this;if(n.default.isObject(s)&&!n.default.isArray(s))return Object.keys(s).forEach(function(e){this.bindDOMEvents(e,s[e])},this),this;n.default.isString(s)&&(s=n.default.getValueTokens(s));for(let e=0;e<s.length;e++){const r=s[e];r&&!n.default.hasProperty(i,r)&&(i[r]=Boolean(t),n.default.bind(this._element,r,this,t))}return this}unbindDOMEvents(e){const t=this._DOMEvents;let s=e||t;n.default.isString(s)?s=n.default.getValueTokens(s):n.default.isObject(s)&&!n.default.isArray(s)&&(s=Object.keys(s));for(let e=0;e<s.length;e++){const i=s[e];n.default.hasProperty(t,i)&&(n.default.unbind(this._element,i,this,t[i]),delete t[i])}return this}getContentElement(e,t){let s=this._contentElement;return e&&(s=t?n.default.slice(s.querySelectorAll(e)):s.querySelector(e)),s}}t.View=c,c.POSITION_ATTR="data-position",c.TR_PREDICTOR_GAP=150,c.positions={TOP:"top",LEFT:"left",BOTTOM:"bottom"}},function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.HTTPRequest=void 0;var n=i(s(0)),r=s(9),o=s(66),a=s(29),l=i(s(57));s(101);class c extends r.Emitter{static get(e,t,s){const i=new this(e),r=n.default.isFunction(t)?null:t,o=n.default.isFunction(t)?t:s;return i.setParams(r),i.send(o)}static post(e,t,s){const i=new this(e),r=n.default.isFunction(t)?null:t,o=n.default.isFunction(t)?t:s;return i.setType(this.types.FORM).setData(r).setMethod(this.methods.POST),i.send(o)}static serializeData(e,t){switch(t){case c.types.JSON:return JSON.stringify(e);case c.types.FORM:return n.default.toQueryString(e);default:return e}}static createNativeRequest(e){return!window.XDomainRequest||!n.default.isCrossOriginUrl(e)||"withCredentials"in window.XMLHttpRequest.prototype?new window.XMLHttpRequest:new window.XDomainRequest}constructor(e){super();const t=this,s=c.createNativeRequest(e);s.onreadystatechange=function(){let e;if(t.isDone())if(clearTimeout(t._timer),t._aborted){const e=n.default.duration(t._timestamp),s=t._timedout&&e>=c.TIMEOUT;t.emit("error",new a.HTTPError(s?a.HTTPError.TIMEOUT:a.HTTPError.ABORT))}else{if(e=new o.HTTPResponse(this),e.requestTimestamp=t._timestamp,this.status>=c.codes.OK&&this.status<300)return t.emit("response",e);t.emit("error",e)}},this._xhr=s,this._url=e,this._data=null,this._params=this._getUserIdData(),this._method=c.methods.GET,this._headers={},this._timeout=c.TIMEOUT,this._timestamp=0,this._responseType=null}send(e){const t=this._xhr;let s=this._url;const i=this,r=c.serializeData(this._data,this.getType()),o=n.default.toQueryString(this._params),a=this._headers;return n.default.isFunction(e)&&this.on("error",function(t){e(t)}).on("response",function(t){e(null,t)}),o&&(s+=(s.indexOf("?")<0?"?":"&")+o),t.open(this._method,s),Object.keys(a).forEach(function(e){t.setRequestHeader(e,a[e])}),this._responseType&&(t.responseType=this._responseType),this._timeout&&(this._timer=setTimeout(function(){i._timedout=!0,i.abort()},this._timeout)),this._timestamp=Date.now(),t.send(r),this}abort(){return this._aborted||this.isDone()?this:(this._aborted=!0,this._xhr.abort(),this.emit("abort"))}isDone(){return 4===this._xhr.readyState}getType(){return this.getHeader("Content-Type")}setType(e){return this.setHeader("Content-Type",e)}setCsrfToken(e){return this.setHeader("X-CSRF-Token",e)}setData(e){return this._data=e,this}setMethod(e){return this._method=e,this}setParams(e,t=!1){return this._params=n.default.extend({},e,t?null:this._getUserIdData()),this}getHeader(e){return this._headers[e]}setHeader(e,t){return this._headers[e]=t,this}setTimeout(e){return this._timeout=e,this}setResponseType(e){return this._responseType=e,this}_getUserIdData(){const e=this._url;return n.default.isYandexUrl(e)&&n.default.isSecureUrl(e)?n.default.getUserIdData():{}}static isSuccessCode(e){return e>=200&&e<300}static isAbortedCode(e){return e===a.HTTPError.ABORT}static isTimeoutCode(e){return e===a.HTTPError.TIMEOUT}}t.HTTPRequest=c,c.types=l.default,c.codes={OK:200,CREATED:201,ACCEPTED:202},c.errors={NOT_FOUND:404},c.methods={GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE"},c.TIMEOUT=1e4},function(e,t,s){var i=s(33)("wks"),n=s(35),r=s(12).Symbol,o="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=o&&r[e]||(o?r:n)("Symbol."+e))}).store=i},function(){},function(e,t,s){"use strict";t.__esModule=!0,t.Presenter=void 0;var i=s(9),n=s(4),r=s(16);class o extends i.Emitter{constructor(e={}){super(),this._view=e.view||new r.View,this._model=e.model||new n.Model}toJSON(){return this._model.toJSON()}cloneProps(){return this._model.cloneProps()}getProps(){return this._model.getProps()}getView(){return this._view}getModel(){return this._model}prepareData(e){return e}}t.Presenter=o},function(){},function(){},function(e,t,s){"use strict";t.__esModule=!0,t.TranslateApplication=t.TRANSLATE_APP_EVENTS=t.LANDING_TYPES=t.A11Y_EVENTS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(102),o=s(71),a=s(10),l=s(45),c=s(105);const d={ACTIVATION:"focusedElementActivation",SELECT_ACTIVATION:"focusedSelectActivation"};t.A11Y_EVENTS=d;const u={INIT_DONE:"initDone"};t.TRANSLATE_APP_EVENTS=u,t.LANDING_TYPES={DICTIONARY:"dictionary",TRANSLATOR:"translator"};const h="data-lang",p="data-source-lang",g="data-target-lang",E=window.config||{};class _ extends c.BaseApplication{static getAllSrcLangs(){if(!this.ALL_SRC_LANGS){const e=E.DIALECTS||[],t={...E.TRANSLATOR_LANGS||{}};for(const s of e)delete t[s];this.ALL_SRC_LANGS=t}return this.ALL_SRC_LANGS}static getAllDstLangs(){return E.TRANSLATOR_LANGS||{}}static isHistoryAvailable(){return Boolean(window.history)&&"state"in window.history}static getInitialLangs(e){const t=E.DIALECT_SRC_LANGS||{},s=(e.getAttribute(h)||"").split("-");let i=e.getAttribute(p)||s[0]||"",n=e.getAttribute(g)||s[1]||"";i in t&&(i=t[i]);const r=i===n||t[n]===i;return(""===i||""===n||r)&&(i="",n=""),{initialSourceLang:i,initialTargetLang:n}}constructor(e={}){super(e),this.listenLangsChange(),(0,a.getGlobalEmitter)().on(l.SID_FETCHING_EVENT,({oldSid:e,newSid:t})=>{this.getStatisticsModel().send(l.SID_FETCHING_EVENT,{oldSid:e,newSid:t})}),n.default.firefoxVersion&&this.getView().setState("firefox",!0)}listenLangsChange(){const e=this.getModel();e.onChange(["srcLang","dstLang"],(t,s,{oldValue:i})=>{this.getStatisticsModel().setProperty("dir",this.getLangsPair()),this.getSettings().setProperty(t,s);const n="srcLang"===t,r="dstLang"===t,{srcLang:o,dstLang:a}=e.getProps();n&&o===a?this.setDstLanguage(i):r&&a===o?this.setSrcLanguage(i):this.maybeFixDialectPair({isSrc:n,isDst:r,srcLang:o,dstLang:a,oldValue:i})})}maybeFixDialectPair({isSrc:e,isDst:t,srcLang:s,dstLang:i,oldValue:n}){const r=E.DIALECT_SRC_LANGS||{};i in r&&r[i]===s&&(e?this.setDstLanguage(n||this.DEFAULT_DST_LANG):t&&this.setSrcLanguage(n||this.DEFAULT_SRC_LANG))}getLangsPair(){const{srcLang:e,dstLang:t}=this.getModel().getProps();return`${e}-${t}`}getDefaultSrcLanguage(){const e=this.getConfig();return e.DEFAULT_SRC_LANG?e.DEFAULT_SRC_LANG:!e.DEFAULT_TEXT&&this.getSettings().getProperty("srcLang")||_.DEFAULT_SRC_LANG}getDefaultDstLanguage(){const e=this.getConfig();return e.DEFAULT_DST_LANG?e.DEFAULT_DST_LANG:!e.DEFAULT_TEXT&&this.getSettings().getProperty("dstLang")||(e.UI_LANG!==_.DEFAULT_SRC_LANG?e.UI_LANG:_.DEFAULT_DST_LANG)}getLink(e={}){const t=this.toJSON();let s,i={},r="/";return e.includePathname&&(r=e.pathname||window.location.pathname),s=e.absolute?window.location.protocol+"//"+window.location.hostname+r:r,e.excludeParams?s:(e.includeSearch&&(i=n.default.fromQueryString(window.location.search.slice(1))),i.lang=t.srcLang+"-"+t.dstLang,t.trText?i.text=t.trText:delete i.text,s+"?"+n.default.toQueryString(i))}setText(e,t={}){const s=this.getModel(),i=n.default.trim(e),r="speller"===t.sender;t.caret=t.caret||0,t.oldValue=t.oldValue||"";const o=e.length-t.oldValue.length,a=Math.abs(o)>1,l=e.charAt(t.caret-1);return t.reason=r?"speller":a?o<0?"cut":"paste":"input",s.setProperty("text",e,t),s.setProperty("leadSpacingsCount",e.search(/\S/)),(!i||a||t.sender||o>0&&!n.default.isAlphaOrDigit(l))&&(a||r||(t.reason="\n"===l?"enter":"auto"),s.setProperty("trText",i,t)),this}updateTrText(e){const t=this.getModel();return t.setProperty("trText",n.default.trim(t.getProperty("text")),{reason:e||"auto"}),this}swapDirection(){return this.setSrcLanguage(this.getModel().getProperty("dstLang")),this}setSrcLanguage(e,t){const s=E.DIALECT_SRC_LANGS||{};return e=e in s?s[e]:e,this._model.isValid("srcLang",e)&&this._model.setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this._model.isValid("dstLang",e)&&this._model.setProperty("dstLang",e,t),this}trackPerformance(){const e=this.getModel(),t=Boolean(E.DEFAULT_TEXT);e.onChange("text",function s(i,n){"url"!==n.sender&&((0,o.rumSendTimeMark)(t?o.RUM_COUNTERS.FILLED_FIRST_TYPING:o.RUM_COUNTERS.BLANK_FIRST_TYPING),e.offChange("text",s))}).onChange("translation",function s(){(0,o.rumSendTimeMark)(t?o.RUM_COUNTERS.FILLED_FIRST_TRANSLATION:o.RUM_COUNTERS.BLANK_FIRST_TRANSLATION),e.offChange("translation",s)})}onInitDone(e){return this.on(u.INIT_DONE,e)}onFocusedElementActivation(e){return this.on(d.ACTIVATION,e)}onFocusedSelectActivation(e){return this.on(d.SELECT_ACTIVATION,e)}bindFocusActivation(e){return this.onFocusedElementActivation(t=>{t===e.getElement()&&e.emit("tap")})}makeStatisticsModel(){const e=this.getConfig();return new r.StatisticsModel({srv:e.SRV,ver:e.VER,uid:e.UID,url:e.CLCK_URL,path:e.CLCK_PATH,loadTs:e.LOAD_TS,dir:this.getLangsPair()})}getStatisticsModel(){return this._statisticsModel||(this._statisticsModel=this.makeStatisticsModel()),this._statisticsModel}setComplaintTarget(e){return this.getModel().setProperty({complaintTarget:e})}getComplaintTarget(){return this.getModel().getProperty("complaintTarget")}onComplaintSend(e){return this.onAction("sendComplaint",e)}isComplaintModeEnabled(){return this.getView().hasState("complaint")}openSiteTranslateUrl(e){const t={view:"compact",url:n.default.trim(e),lang:this.getLangsPair()},s="/translate?"+n.default.toQueryString(t);window.open(s,"_blank")}}t.TranslateApplication=_,_.DEFAULT_SRC_LANG="en",_.DEFAULT_DST_LANG="ru",_.ALL_SRC_LANGS=void 0},function(e,t,s){"use strict";t.__esModule=!0,t.TemplateView=void 0,(i=s(0))&&i.__esModule,s(14);var i,n=s(2);s(67);class r extends n.TouchView{constructor(e={}){super(e)}deferredRenderData(e,t={}){return!1}renderData(e,t={}){return!1}trackRenderTime(e){return!1}getComponentName(){return!1}}t.TemplateView=r},function(e,t,s){"use strict";function i(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return s}function n(e,t){return this._directive||(this._directive=i(this,I,d).call(this)),this._directive(e,t)}function r(e={}){return this.template(this.getRenderHelpers(),e)}function o(e,t={}){return this.trackRenderTime(()=>(0,g.render)(i(this,A,r).call(this,t),e)),this.emit(f.RENDERED,t)}function a(e){return this._cachedDirectiveProps={...e},this}function l(e){return!p.default.isEqualDeep(this._cachedDirectiveProps,e)}function c(e){return this._directiveCacheIsValid=e,this}function d(){let e;return this.on(S,t=>{e&&e({...this._cachedDirectiveProps,...t},{forceCommit:!0})}).onChange(()=>i(this,O,c).call(this,!1)),(0,g.directive)((t,s)=>n=>{e=((e,{forceCommit:t}={})=>{const o=!s||!this._directiveCacheIsValid||i(this,R,l).call(this,e);i(this,O,c).call(this,!0),o&&(i(this,y,a).call(this,e),n.setValue(i(this,A,r).call(this,e)),t&&this.trackRenderTime(()=>n.commit()),p.default.callAsync(()=>{this.emit(f.DIRECTIVE_UPDATED,[n.startNode,n.endNode],e)}))}),e(t)})}function u(e={}){return this.emit(S,e)}t.__esModule=!0,t.PureComponent=t.COMPONENT_EVENTS=void 0,s(1);var h,p=(h=s(0))&&h.__esModule?h:{default:h},g=s(47),E=s(115),_=s(4),T=s(24),m=s(2);const f={RENDERED:"rendered",DIRECTIVE_UPDATED:"directiveUpdated"};t.COMPONENT_EVENTS=f;const S="updateDirective";var C=new WeakSet,A=new WeakSet,L=new WeakSet,y=new WeakSet,R=new WeakSet,O=new WeakSet,I=new WeakSet,P=new WeakSet;class N extends _.Model{trackRenderTime(e){return T.TemplateView.prototype.trackRenderTime.apply(this,arguments)}getComponentName(){return T.TemplateView.prototype.getComponentName.apply(this)}constructor(e,t={}){super(e,t),P.add(this),I.add(this),O.add(this),R.add(this),y.add(this),L.add(this),A.add(this),C.add(this),this._cachedDirectiveProps={},i(this,O,c).call(this,!0),t.container&&this.setContainer(t.container),this.updateAsync=p.default.debounce(N.prototype.update,0),this.updateNow=this.updateAsync.callNow.bind(this)}genId(e){return p.default.generateId(e||this.getComponentName())}template(e,t){}getDirective(e={}){return i(this,C,n).call(this,e,!1)}getMemoizedDirective(e={}){return i(this,C,n).call(this,e,!0)}getRenderHelpers(){return{html:g.html,nothing:g.nothing,cn:E.cn}}update(e={}){const t=this.getContainer();return t?i(this,L,o).call(this,t,e):this._directive&&i(this,P,u).call(this,e),this}onRendered(e){return this.on(f.RENDERED,e)}onceRendered(e){return this.once(f.RENDERED,e)}onDirectiveUpdated(e){return this.on(f.DIRECTIVE_UPDATED,e)}setContainer(e){this._element=e}getContainer(){return this._element}getRef(e,t=null){const s=this.getContainer(),i=`[data-ref-id="${e}"]`;if(s)return s.querySelector(i);if(t){let e=t[0];for(;e;){if(e.nodeType===Node.ELEMENT_NODE){const t=e.querySelector(i);if(t)return t}if(e===t[1])break;e=e.nextSibling}}return null}getContainerView(){return this._containerView||(this._containerView=new m.TouchView({element:this._element})),this._containerView}}t.PureComponent=N},function(e,t,s){"use strict";t.__esModule=!0,t.desktopLocales=void 0;const i=window.locales||{},n=Object.assign({...i},window.desktopLocales||{});t.desktopLocales=n},function(e,t,s){e.exports=!s(49)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var s={}.hasOwnProperty;e.exports=function(e,t){return s.call(e,t)}},function(e,t,s){"use strict";t.__esModule=!0,t.HTTPError=void 0;class i{constructor(e,t){this.code=e||0,this.message=t||""}}t.HTTPError=i,i.ABORT=-1,i.TIMEOUT=-2},function(e,t,s){"use strict";t.__esModule=!0,t.locales=void 0;const i=window.locales||{};t.locales=i},function(){},function(e,t,s){"use strict";t.__esModule=!0,t.VALUE_ATTR=t.ListboxView=void 0,(i=s(0))&&i.__esModule,s(2);var i,n=s(24);t.VALUE_ATTR="data-value";class r extends n.TemplateView{getValues(){return!1}hasChild(e){return!1}}t.ListboxView=r,r.VALUE_ATTR="data-value"},function(e,t,s){var i=s(34),n=s(12),r=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:s(48)?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var s=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=s)},function(e,t){var s=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++s+i).toString(36))}},function(e,t,s){var i=s(37),n=s(77),r=s(78),o=Object.defineProperty;t.f=s(27)?Object.defineProperty:function(e,t,s){if(i(e),t=r(t,!0),i(s),n)try{return o(e,t,s)}catch(e){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(e[t]=s.value),e}},function(e,t,s){var i=s(38);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){e.exports={}},function(e,t,s){var i=s(80),n=s(52);e.exports=function(e){return i(n(e))}},function(e,t,s){var i=s(12),n=s(13),r=s(28),o=s(35)("src"),a=s(84),l=(""+a).split("toString");s(34).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,s,a){var c="function"==typeof s;c&&(r(s,"name")||n(s,"name",t)),e[t]!==s&&(c&&(r(s,o)||n(s,o,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=s:a?e[t]?e[t]=s:n(e,t,s):(delete e[t],n(e,t,s)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||a.call(this)})},function(e,t,s){var i=s(33)("keys"),n=s(35);e.exports=function(e){return i[e]||(i[e]=n(e))}},function(e,t,s){"use strict";t.__esModule=!0,t.SessionModel=void 0;var i=s(45),n=s(4);class r extends n.Model{getSid(){return i.sessionManager.getSid().then(e=>(this.setProperty({sid:e}),e))}}t.SessionModel=r},function(e,t,s){"use strict";t.__esModule=!0,t.AutoLangSwitcherComponent=void 0;var i=s(119);class n extends i.AbstractAutoLangSwitcherComponent{setModel(e){super.setModel(e),this.updateAsync()}onClick(){const e=this.model.isAutodetectEnabled();this.model.setAutodetectEnabled(!e),this.updateAsync(),this.trackAutodetectToggle(!e)}template({cn:e,html:t,nothing:s}){return this.model?t`
            <div
                class="${e("switch")({active:this.model.isAutodetectEnabled(),size:"s"})}"
            ></div>
        `:s}}t.AutoLangSwitcherComponent=n},function(e,t,s){"use strict";t.__esModule=!0,t.sessionManager=t.SID_FETCHING_EVENT=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(103),o=s(17),a=s(8),l=s(10);const c=window.config||{};t.SID_FETCHING_EVENT="sid_fetched";class d extends Error{constructor(...e){super(...e),this.message="Sid Error: failed to fetch sid"}}const u=new class{constructor(){this.maxAttempts=3,this.sidPromise=null,this.sidReceivingTimestamp=n.default.now(),this.sid=null,this.sidRequestsAttempts=0}isSessionExpired(){return!!c.ENABLE_SID_REQUESTING&&(n.default.now()-this.sidReceivingTimestamp)/1e3>c.SESSION_MAX_AGE}fetchNewSid(){this.sidPromise=new Promise(e=>{new o.HTTPRequest(c.SESSIONS_PATH).setMethod(o.HTTPRequest.methods.POST).setParams({srv:c.SRV}).send((t,s)=>{t&&(this.sidRequestsAttempts++,this.sidRequestsAttempts===this.maxAttempts?((0,a.logError)(new d),e(c.SID)):this.fetchNewSid());const i=this.sid;this.sidReceivingTimestamp=n.default.now(),this.sid=n.default.get(s,"body.session.id"),this.sidPromise=null,(0,l.getGlobalEmitter)().emit("sid_fetched",{oldSid:i,newSid:this.sid}),e(this.sid)})})}getSid(){return this.sid||(this.sid=c.SID),this.isSessionExpired()?(this.sidPromise||this.fetchNewSid(),this.sidPromise):new r.SyncPromise(e=>{e(this.sid)})}};t.sessionManager=u},function(e,t,s){"use strict";function i(e){this.hotKeysConfig||(this.hotKeysConfig={});const t=this.getHotKeyCombination(e);this.hotKeysConfig[t]=d.desktopLocales.hotKeys[e]}t.__esModule=!0,t.HOT_KEYS_MAP=t.DesktopTranslateApplication=void 0,s(1);var n,r=(n=s(0))&&n.__esModule?n:{default:n},o=s(19),a=s(64),l=s(3),c=s(11),d=s(26),u=s(23);const h={COPY:"COPY_HOTKEY",FAV:"FAV_HOTKEY",ASR:"ASR_HOTKEY",FOCUS_INPUT:"FOCUS_INPUT_HOTKEY",CLEAR_INPUT:"CLEAR_INPUT_HOTKEY",SWAP_LANGS:"SWAP_LANGS_HOTKEY",SRC_TTS:"SRC_TTS_HOTKEY",DST_TTS:"DST_TTS_HOTKEY"};t.HOT_KEYS_MAP=h;const p={c:67,l:76,m:77,d:68,s:83,v:86,"/":191};var g=new WeakSet;class E extends u.TranslateApplication{static getHotkeysMap(){return{[h.COPY]:{osx:"Option+C",other:"Alt+C"},[h.FAV]:{osx:"Option+L",other:"Alt+L"},[h.ASR]:{osx:"Option+M",other:"Alt+M"},[h.FOCUS_INPUT]:{osx:"/",other:"/"},[h.CLEAR_INPUT]:{osx:"Option+D",other:"Alt+D"},[h.SWAP_LANGS]:{osx:"Option+S",other:"Alt+S"},[h.SRC_TTS]:{osx:"Option+V",other:"Alt+V"},[h.DST_TTS]:{osx:"Option+Shift+V",other:"Alt+Ctrl+V"}}}constructor(e){super(e),g.add(this),this.hotKeysConfig=null}getDesktopSettings(){return this._desktopSettings||(this._desktopSettings=window.config.SRV===o.TEXT&&this._settings?this._settings:new a.AppStorage({},{name:"yTrSettings"})),this._desktopSettings}getHotKeyCombination(e){const t=r.default.macOS?"osx":"other";return E.getHotkeysMap()[e][t]}getHotKeysConfig(){return this.hotKeysConfig}addHotKey(e,{view:t,callback:s,condition:n,getActionName:r}){const o=this.getHotKeyCombination(e),a=o.toLowerCase().split("+"),d=a.find(e=>1===e.length);(function(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return s})(this,g,i).call(this,e);const u=()=>{l.$tracker.sendMetric("hotkey_used",{combination:o,action_name:r(),src:this.getModel().getProperty("text"),dir:this.getLangsPair()})};return t&&t.getElement().setAttribute("data-hotkey",o),this.getView().on("keydown",e=>{if(!this.areHotkeysEnabled())return;const i=!n||n();if(c.InputView.hasKeyCombination(e,p[d],{altKey:a.includes("alt")||a.includes("option"),shiftKey:a.includes("shift"),ctrlKey:a.includes("ctrl")})&&i){if(e.preventDefault(),t&&t.isVisible()&&t.isEnabled()&&t.isValid()){u();const e=t.getElement().getAttribute("data-action");e?this.emit("action:"+e):t.emit("tap")}s&&(u(),s())}}),this}areHotkeysEnabled(){return this.getDesktopSettings().isOptionEnabled("hotkeys")}}t.DesktopTranslateApplication=E},function(){},function(e,t){e.exports=!1},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,s){var i=s(38),n=s(12).document,r=i(n)&&i(n.createElement);e.exports=function(e){return r?n.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,s){var i=s(90),n=s(55);e.exports=Object.keys||function(e){return i(e,n)}},function(e,t){var s=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:s)(e)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,s){var i=s(36).f,n=s(28),r=s(18)("toStringTag");e.exports=function(e,t,s){e&&!n(e=s?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default={XML:"text/xml",XML2:"application/xml",HTML:"text/html",TEXT:"text/plain",JSON:"application/json",FORM:"application/x-www-form-urlencoded"}},function(){},function(e,t,s){"use strict";t.__esModule=!0,t.nothing=t.noChange=void 0,t.noChange={},t.nothing={}},function(){},function(){},function(){},function(e,t,s){"use strict";function i(e,t,s){return function(e,t,s){if(t.set)t.set.call(e,s);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=s}}(e,r(e,t,"set"),s),s}function n(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,r(e,t,"get"))}function r(e,t,s){if(!t.has(e))throw new TypeError("attempted to "+s+" private field on non-instance");return t.get(e)}t.__esModule=!0,t.Storage=void 0,s(1);var o,a=(o=s(0))&&o.__esModule?o:{default:o},l=s(3),c=s(8),d=s(4),u=new WeakMap,h=new WeakMap;class p extends d.Model{constructor(e,t={}){super(e,t),u.set(this,{writable:!0,value:window.localStorage||window.sessionStorage||{}}),h.set(this,{writable:!0,value:"mTr"});const s=t.name||n(this,h);i(this,h,s);try{this.setProperty(JSON.parse(n(this,u)[s]))}catch{}this.on("change",()=>{try{n(this,u)[s]=JSON.stringify(this.getProps())}catch(e){l.$tracker.sendMetric("storage_error",{error_code:e.code}),(0,c.logError)(e)}})}getName(){return n(this,h)}getSpace(){return p.MAX_SIZE-a.default.safeStringifyJSON(n(this,u)).length}}t.Storage=p,p.MAX_SIZE=5e6},function(e,t,s){"use strict";t.__esModule=!0,t.AppStorage=void 0;var i=s(63);class n extends i.Storage{setAutodetectEnabled(e){return this.setProperty("auto",e)}isAutodetectEnabled(){return this.getProperty("auto")}getSrcLangHistory(){return!1}getDstLangHistory(){return!1}setSrcLangHistory(e){return!1}setDstLangHistory(e){return!1}getDisabledOptions(){return(this.getProperty("disabledOptions")||"").split(";")}isOptionEnabled(e){return-1===this.getDisabledOptions().indexOf(e)}disableOption(e){const t=this.getDisabledOptions();-1===t.indexOf(e)&&(this.setProperty("disabledOptions",[...t,e].join(";")),this.prefixedEmit("storageOptionChanged",e,!1))}enableOption(e){if(-1===this.getDisabledOptions().indexOf(e))return;const t=this.getDisabledOptions();this.setProperty("disabledOptions",t.filter(t=>t!==e).join(";")),this.prefixedEmit("storageOptionChanged",e,!0)}onToggleOption(e,t){return this.on("storageOptionChanged:"+e,t)}}t.AppStorage=n,n.defaults={auto:!0}},function(e,t,s){"use strict";t.__esModule=!0,t.SyncModel=void 0;var i=s(43);class n extends i.SessionModel{constructor(e,t){super(e,t),this.on("invalid",this.abort)}abort(){return this._activeRequest&&(this._activeRequest.abort(),this._activeRequest=null),this}setRequest(e){return this.abort(),this._activeRequest=e,this}}t.SyncModel=n},function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.HTTPResponse=t.HEADER_NAMES=void 0,t.parseContentDisposition=function(e){const t=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(e);if(null!=t&&t[1]){const e=t[1].toUpperCase().startsWith("UTF-8''"),s=t[1].slice(e?"UTF-8''".length:0).replace(/['"]/g,"");return e?decodeURIComponent(s):s}return null};var n=i(s(0)),r=i(s(57));t.HEADER_NAMES={CONTENT_DISPOSITION:"content-disposition",CONTENT_TYPE:"content-type"};class o{static parseResponse(e,t){switch(t){case r.default.XML:case r.default.XML2:return e.responseXML;case r.default.TEXT:return e.responseText;case r.default.JSON:return JSON.parse(e.responseText);case r.default.FORM:return n.default.fromQueryString(e.responseText);default:return null}}static parseResponseHeaders(e){const t={};return e?(n.default.trim(e).split("\n").forEach(function(e){const s=e.split(":");t[n.default.trim(s[0]).toLowerCase()]=n.default.trim(s[1])}),t):t}constructor(e){const t=e.getResponseHeader("Content-Type");this.code=e.status,this.type=t?t.split(";")[0]:"",this.text=e.responseType&&e.responseType!==o.types.TEXT?"":e.responseText,this.body=this.text?o.parseResponse(e,this.type):e.response||null,this.message=e.statusText,this.headers=o.parseResponseHeaders(e.getAllResponseHeaders())}}t.HTTPResponse=o,o.types={BLOB:"blob",JSON:"json",TEXT:"text",DOCUMENT:"document",ARRAYBUFFER:"arraybuffer"}},function(e,t,s){"use strict";t.__esModule=!0,t.Template=void 0,t.tpl=function(e,...t){return e.reduce((e,s,i)=>`${e}${s}${t[i]||""}`,"").trim()};var i,n=(i=s(0))&&i.__esModule?i:{default:i};class r{static prepareTags(e){let t=e;return n.default.isString(t)&&(t=n.default.getValueTokens(t,2)),n.default.isArray(t)?t:null}static parseTemplate(e,t){const s=[];let i=[];const r=t||this.defaultTags,o=e.replace(new RegExp("\\}?"+n.default.escapeRegExp(r[1]),"g"),r[0]);return n.default.forEach(o.split(r[0]),function(e,t){if(!e)return;if(t%2==0)return void i.push({type:"text",value:e});const r=e.charAt(0),o=n.default.trim(e.slice(1));switch(r){case"!":break;case"#":case"@":case"?":case"^":case"*":const t=[];i.push({type:r,name:o,value:t}),s.push({name:o,root:i}),i=t;break;case">":i.push({type:r,name:o});break;case"&":case"{":i.push({type:"&",name:o});break;case"/":const a=s.pop();if(!a)throw new Error('Unopened template section "'+o+'"!');if(o!==a.name)throw new Error('Unclosed template section "'+a.name+'"!');i=a.root;break;default:i.push({type:"name",name:n.default.trim(e)})}}),i}static getContextValue(e,t){let s,i,r,o;if(e.indexOf(".")>0)for(s=0,i=t,r=e.split("."),o=r.length;i&&s<o;)i=i[r[s++]];else i=t[e];return n.default.isFunction(i)&&(i=i.call(t)),i}static renderTokens(e,t={},s={}){const i=this,r=[];return n.default.forEach(e,function(e){let o;switch(e.type){case"^":o=i.getContextValue(e.name,t),n.default.isEmpty(o)&&r.push(i.renderTokens(e.value,t,s));break;case"#":case"?":case"@":case"*":if(o=i.getContextValue(e.name,t),n.default.isEmpty(o))return;n.default.isArray(o)?n.default.forEach(o,function(t){const o=n.default.isObject(t)?t:{".":t};r.push(i.renderTokens(e.value,o,s))}):r.push(i.renderTokens(e.value,n.default.isObject(o)?o:t,s));break;case">":if(!n.default.isObject(s.partials))return;if(o=i.getContextValue(e.name,s.partials),!o||!n.default.isString(o))return;r.push(i.renderTokens(i.parseTemplate(o,s.tags),t,s));break;case"&":case"name":if(o=i.getContextValue(e.name,t),n.default.isNullOrUndefined(o))return;o=String(o),r.push("&"===e.type?o:n.default.escapeHTML(o));break;case"text":r.push(e.value)}}),r.join("")}constructor(e,t={}){return!1}compileTemplate(e,t){return!1}}t.Template=r,r.cache={},r.defaultTags=["{{","}}"]},function(){},function(){},function(e,t,s){"use strict";t.__esModule=!0,t.POS_ORDER=t.POS_CODES=t.POS=t.DictionaryPresenter=t.DICT_TYPES=t.DICT_FLAGS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(20);const o={NONE:0,FAMILY:1,SHORT_POS:2,MORPHO:4,RELIABLE:16,TOOLTIPS:32,LONG_EXAMPLES:64,DEFINITIONS:128,DECLENSIONS:256,IDIOMS:1024,ABBR:2048,DICT_AND_DEF:4096,NEW_DECLENSIONS:8192};t.DICT_FLAGS=o;const a={SYN:"syn",ANT:"ant",DEF:"def",DERIV:"deriv",REGULAR:"regular"};t.DICT_TYPES=a;const l={NOUN:"noun",VERB:"verb",ADJECTIVE:"adjective",PRONOUN:"pronoun"};t.POS=l;const c={nn:l.NOUN,vrb:l.VERB,adj:l.ADJECTIVE,prn:l.PRONOUN};t.POS_CODES=c;const d={[l.VERB]:1,[l.NOUN]:2,[l.ADJECTIVE]:3,[l.PRONOUN]:4};t.POS_ORDER=d;class u extends r.Presenter{constructor(e){super(e);const{isDisabled:t}=e,s=this,i=this.getView(),r=this.getModel();this.requestData=n.default.debounce(u.prototype.requestData),i.on("itemSelected",function(e){e&&s.emit("valueSelected",e)}),r.on("change",function(e,t,i={}){if("selection"!==i.reason)switch(e){case"ui":case"text":case"type":case"flags":s.requestData();break;case"srcLang":case"dstLang":s._handleChangeLang()}}).on("error",function(e){s.emit("error",e)}).on("invalid",function(){this.setProperty("data","",{invalid:!0})}).on("set:data",function(e,i){t&&t()||s._renderData(e,i)})}setText(e,t){return this.getModel().setProperty("text",e,t),this}hasFlag(e){return(this.getModel().getProperty("flags")&e)===e}setFlag(e,t){const s=this.getModel();let i=s.getProperty("flags");return Boolean(t)===this.hasFlag(e)||(i+=e*(t?1:-1),s.setProperty("flags",i)),this}setType(e,t){const s=this.getModel();let i=s.getProperty("type");i=i?i.split(","):[];const n=i.indexOf(e);return Boolean(t)===n>=0||(t?i.push(e):i.splice(n,1),s.setProperty("type",i.join(","))),this}hasType(e){let t=this.getModel().getProperty("type");return t=t?t.split(","):[],-1!==t.indexOf(e)}requestData(e){return this.getModel().requestData(e),this}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}_renderData(e,t){let s=e;const i=this.getView();e&&(s=this.prepareData(e),s&&i.renderData(s)),this._handleSetData(s,t)}_handleSetData(e){this.getView().setVisible(e)}_handleChangeLang(){this.requestData()}}t.DictionaryPresenter=u,u.flags=o,u.types=a},function(e,t,s){"use strict";t.__esModule=!0,t.RUM_COUNTERS=void 0,t.rumSendTimeMark=function(e){try{window.Ya.Rum.sendTimeMark(e)}catch(e){}},t.rumTimeEnd=function(e){try{i.DEBUG&&console.timeEnd(e),window.Ya.Rum.timeEnd(e)}catch(e){}},t.rumTimeStart=function(e){try{i.DEBUG&&console.time(e),window.Ya.Rum.time(e)}catch(e){}};var i=s(14);t.RUM_COUNTERS={APP_INIT_START:"app-init-start",APP_INIT_DURATION:"app-init-duration",BLANK_FIRST_TYPING:"blank-first-typing",BLANK_FIRST_TRANSLATION:"blank-first-translation",FILLED_FIRST_TYPING:"filled-first-typing",FILLED_FIRST_TRANSLATION:"filled-first-translation"}},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(4);class o extends r.Model{constructor(e,t={}){super(e,t),this._toggleable=Boolean(t.toggleable),this._defaultValue=t.defaultValue||""}isEmpty(e){return n.default.isEmpty(e||this.getItems())}getItems(){let e=this.getProperty("items");try{e=JSON.parse(e)}catch(e){}return e}setProperty(e,t,s){const i=r.Model.prototype.setProperty.bind(this);return this._toggleable&&"value"===e&&t&&this.getProperty(e)===t?(i(e,this._defaultValue,s),this):(i(e,t,s),this)}setItems(e,t){return this.setProperty("items",e&&JSON.stringify(e),t)}getDefaults(){return{value:"",items:""}}}t.ListboxModel=o},function(e,t,s){"use strict";s(74)},function(e,t){!function(e,t){function s(){O=e.getVarsList(),e.getSetting("sendClientUa")&&O.push("1042="+encodeURIComponent(navigator.userAgent))}function i(){I=O.concat(["143.2129="+W])}function n(e){function t(){removeEventListener("DOMContentLoaded",t),removeEventListener("load",t),e()}"loading"===document.readyState?(addEventListener("DOMContentLoaded",t),addEventListener("load",t)):e()}function r(){var t;e.getSetting("disableOnLoadTasks")||(removeEventListener("load",r),t=e.getSetting("periodicStatsIntervalMs"),t||null===t||(t=15e3),t&&(K=setInterval(h,t)),addEventListener("beforeunload",h),function(){if(D){p(w.getEntriesByType("navigation")),p(w.getEntriesByType("resource"));try{new D(function(e){p(e.getEntries())}).observe({entryTypes:["resource","navigation"]})}catch(e){}e._periodicTasks.push(E)}}(),function(){if(D)try{new D(function(e,t){var s=e.getEntries()[0];if(s){var i=s.processingStart,n={duration:s.duration,js:s.processingEnd-i,name:s.name},r=s.target;if(r){var o=(r.tagName||"").toLowerCase(),a=r.className?(" "+r.className).replace(/\s+/g,"."):"";n.target=o+a}d("first-input",i-s.startTime,n),t.disconnect()}}).observe({type:"first-input",buffered:!0})}catch(e){}}(),function(){if($){var e=w.getEntriesByType("navigation")[0];if(e){var t=[];L(t,e),f(t),R("690.2096.2892",O.concat(t))}}}(),function(){if(D){var e=new D(function(e){var t=e.getEntries();null==j&&(j=0);for(var s=0;s<t.length;s++){var i=t[s];i.hadRecentInput||(j+=i.value)}});addEventListener("visibilitychange",function t(){if("hidden"===document.visibilityState){removeEventListener("visibilitychange",t);try{"function"==typeof e.takeRecords&&e.takeRecords(),e.disconnect()}catch(e){}_()}}),addEventListener("beforeunload",_)}}(),function(){if(D&&(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())){var t=new D(function(e){for(var t=e.getEntries(),s=0;s<t.length;s++){var i=t[s];J=i.renderTime||i.loadTime,Q=i}Z||(a("largest-loading-elem-paint",J),Z=!0)});try{t.observe({type:"largest-contentful-paint",buffered:!0})}catch(e){}addEventListener("visibilitychange",function e(){if("hidden"===document.visibilityState){removeEventListener("visibilitychange",e);try{"function"==typeof t.takeRecords&&t.takeRecords(),t.disconnect()}catch(e){}T()}}),addEventListener("beforeunload",T)}}())}function o(){var t=V.domContentLoadedEventStart,s=V.domContentLoadedEventEnd;if(0!==t||0!==s){var i=0===V.responseStart?W:V.responseStart,n=0===V.domainLookupStart?W:V.domainLookupStart,r=O.concat(["2129="+W,"1036="+(n-W),"1037="+(V.domainLookupEnd-V.domainLookupStart),"1038="+(V.connectEnd-V.connectStart),V.secureConnectionStart&&"1383="+(V.connectEnd-V.secureConnectionStart),"1039="+(V.responseStart-V.connectEnd),"1040="+(V.responseEnd-i),"1040.906="+(V.responseEnd-n),"1310.2084="+(V.domLoading-i),"1310.2085="+(V.domInteractive-i),"1310.1309="+(s-t),"1310.1007="+(t-i),navigator.deviceMemory&&"3140="+navigator.deviceMemory,navigator.hardwareConcurrency&&"3141="+navigator.hardwareConcurrency]);Object.keys(P).forEach(function(e){e in V&&V[e]&&r.push(P[e]+"="+y(V[e],W))}),e.vsStart?(r.push("1484="+(N[e.vsStart]||2771)),e.vsChanged&&r.push("1484.719=1")):r.push("1484="+N.visible),k&&(k.redirectCount&&r.push("1384.1385="+k.redirectCount),1!==k.type&&2!==k.type||r.push("770.76="+k.type)),f(r),R("690.1033",r)}else setTimeout(o,50)}function a(t,s,i,n){void 0===s&&(s=x()),void 0!==i&&!0!==i||e.mark(t,s);var r=A(t);if(r.push("207="+y(s)),l(r,n)){R("690.2096.207",r),H[t]=H[t]||[],H[t].push(s);var o=e._markListeners[t];o&&o.length&&o.forEach(function(e){e(s)})}}function l(e,t){if(t){if(t.isCanceled&&t.isCanceled())return!1;var s=e.reduce(function(e,t,s){return"string"==typeof t&&(e[t.split("=")[0]]=s),e},{});Object.keys(t).forEach(function(i){if("function"!=typeof t[i]){var n=s[i],r=i+"="+t[i];void 0===n?e.push(r):e[n]=r}})}return!0}function c(e,t){var s=B[e];s&&0!==s.length&&(s.push(x(),t),d(e))}function d(t,s,i){var n,r,o,a=B[t];if(void 0!==s?n=(r=e.getTime())-s:a&&(n=a[0],r=a[1],o=a[2]),void 0!==n&&void 0!==r){var c=A(t);c.push("207.2154="+y(n),"207.1428="+y(r),"2877="+y(r-n)),l(c,i)&&l(c,o)&&(R("690.2096.2877",c),delete B[t])}}function u(t,s){S(s,function(i){if(i){var n=A(t);e.getSetting("sendUrlInResTiming")&&n.push("13="+encodeURIComponent(s)),L(n,i[i.length-1]),R("690.2096.2044",n)}})}function h(){var t=!1;e._periodicTasks.forEach(function(e){e()&&(t=!0)}),t||clearInterval(K)}function p(e){if(e&&e.length)for(var t=G,s=0;s<e.length;s++){var i=g(e[s]);if(i){var n=i.domain+"-"+i.extension,r=t[n]=t[n]||{count:0,size:0};r.count++,r.size+=i.size}}}function g(e){var t=e.transferSize;if(null!=t){Y.href=e.name;var s=Y.pathname;if(0!==s.indexOf("/clck")){var i=s.lastIndexOf("."),n="";return-1!==i&&s.lastIndexOf("/")<i&&s.length-i<=5&&(n=s.slice(i+1)),{size:t,domain:Y.hostname,extension:n}}}}function E(){var t=e.getSetting("maxTrafficCounters")||250;if(z>=t)return!1;for(var s=Object.keys(G),i="",n=0;n<s.length;n++){var r=s[n],o=G[r];i+=encodeURIComponent(r)+"!"+o.count+"!"+o.size+";"}return i.length&&(z++,R("690.2096.361",O.concat(["d="+i,"t="+y(x())]))),G={},z<t}function _(){if(null!=j){var e=Math.round(1e6*j)/1e6;R("690.2096.4004",O.concat("s="+e)),j=null}}function T(){if(null!=J){var t=e.getLCPAdditionalParams(Q);a("largest-contentful-paint",J,!1,t),J=null,Q=null}}function m(t,s,i){if(e._tti){var n=x(),r=function(t,r,o){var l={2796.2797:C(o,s),689.2322:y(n)};i&&Object.keys(i).forEach(function(e){l[e]=i[e]}),a(t||"2795",r,!0,l),e._tti.fired=!0};!function i(){var o,a=s||n,l=x(),c=e._tti.events||[],d=c.length;0!==d&&(o=c[d-1],a=Math.max(a,Math.floor(o.startTime+o.duration))),l-a>=3e3?r(t,a,c):l-a>=2e4?r(t,(s||n)+2e4,c):setTimeout(i,1e3)}()}}function f(e){U&&e.push("2437="+(v[U.type]||2771),void 0!==U.downlinkMax&&"2439="+U.downlinkMax,U.effectiveType&&"2870="+U.effectiveType,void 0!==U.rtt&&"rtt="+U.rtt,void 0!==U.downlink&&"dwl="+U.downlink)}function S(e,t){if(!$)return t(null);F.href=e;var s=F.href,i=0,n=100;setTimeout(function e(){var r=w.getEntriesByName(s);if(r.length)return t(r);i++<10?(setTimeout(e,n),n+=n):t(null)},0)}function C(e,t){return t=t||0,(e=e||[]).filter(function(e){return e.startTime-t>=-50}).map(function(e){var t=e.name?e.name.split("-").map(function(e){return e[0]}).join(""):"u",s=Math.floor(e.startTime);return t+"-"+s+"-"+Math.floor(s+e.duration)}).join(".")}function A(t){return I.concat(["1701="+t,e.ajaxStart&&"1201.2154="+y(e.ajaxStart),e.ajaxComplete&&"1201.2052="+y(e.ajaxComplete)])}function L(e,t){Object.keys(P).forEach(function(s){if(s in t){var i=t[s];(i||0===i)&&e.push(P[s]+"="+y(i))}})}function y(e,t){return"string"==typeof e?encodeURIComponent(e):Math.round(1e3*(e-(t||0)))/1e3}function R(e,t){var s=encodeURIComponent(window.YaStaticRegion||"unknown");t.push("-cdn="+s),t.filter(Boolean).join(",")}if(!e)throw new Error("Rum: interface is not included");if(!e.enabled)return e.getSetting=function(){return""},e.getVarsList=function(){return[]},void(e.getResourceTimings=e.pushConnectionTypeTo=e.pushTimingTo=e.normalize=e.sendCounter=e.sendDelta=e.sendTimeMark=e.sendResTiming=e.sendTTI=e.makeSubPage=e.sendHeroElement=e.onReady=function(){});e.getVarsList=function(){var t=e._vars;return Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e]).replace(/\*/g,"%2A")})},e.setVars=function(t){Object.keys(t).forEach(function(s){e._vars[s]=t[s]}),s(),i()};var O,I,P={connectEnd:2116,connectStart:2114,decodedBodySize:2886,domComplete:2124,domContentLoadedEventEnd:2131,domContentLoadedEventStart:2123,domInteractive:2770,domLoading:2769,domainLookupEnd:2113,domainLookupStart:2112,duration:2136,encodedBodySize:2887,entryType:2888,fetchStart:2111,initiatorType:2889,loadEventEnd:2126,loadEventStart:2125,nextHopProtocol:2890,redirectCount:1385,redirectEnd:2110,redirectStart:2109,requestStart:2117,responseEnd:2120,responseStart:2119,secureConnectionStart:2115,startTime:2322,transferSize:2323,type:76,unloadEventEnd:2128,unloadEventStart:2127,workerStart:2137},N={visible:1,hidden:2,prerender:3},v={bluetooth:2064,cellular:2065,ethernet:2066,none:1229,wifi:2067,wimax:2068,other:861,unknown:836,0:836,1:2066,2:2067,3:2070,4:2071,5:2768},b={"first-paint":2793,"first-contentful-paint":2794},M=Object.keys(b).length,x=e.getTime,D=window.PerformanceObserver,w=window.performance||{},V=w.timing||{},k=w.navigation||{},U=navigator.connection,H={},G={},B=e._deltaMarks,F=document.createElement("link"),Y=document.createElement("a"),$="function"==typeof w.getEntriesByType,W=V.navigationStart;s(),i(),e.ajaxStart=0,e.ajaxComplete=0,n(function(){W&&setTimeout(function(){e.sendTimeMark=a,e.sendResTiming=u,e.timeEnd=c;for(var t=e._defRes;t.length;){var s=t.shift();u(s[0],s[1])}for(var i=e._defTimes;i.length;){var n=i.shift();a(n[0],n[1],!1,n[2])}Object.keys(B).forEach(function(e){d(e)}),o(),function t(){if($&&(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())){for(var s=w.getEntriesByType("paint"),i=0;i<s.length;i++){var n=s[i],r=b[n.name];r&&!X[n.name]&&(X[n.name]=!0,q++,a("1926."+r,n.startTime))}if(q<M)try{new D(function(e,s){t(),s&&s.disconnect()}).observe({entryTypes:["paint"]})}catch(e){}}}(),e.getSetting("sendAutoElementTiming")&&ee(),m(),"complete"===document.readyState?r():addEventListener("load",r)},0)}),e._getCommonVars=function(){return O};var K,X={},q=0;e.getTimeMarks=function(){return H},e._periodicTasks=[];var j,z=0,J=null,Q=null,Z=!1,ee=D?function(){if(e.getSetting("forcePaintTimeSending")||!e.isVisibilityChanged())try{new D(function(e){for(var t=e.getEntries(),s=0;s<t.length;s++){var i=t[s];a("element-timing."+i.identifier,i.startTime)}}).observe({type:"element",buffered:!0})}catch(e){}}:function(){};e.sendTTI=m,e.sendHeroElement=function(e){a("2876",e)},e._subpages={},e.makeSubPage=function(t,s){var i=e._subpages[t];e._subpages[t]=void 0===i?i=0:++i;var n=!1;return{689.2322:y(void 0!==s?s:x()),2924:t,2925:i,isCanceled:function(){return n},cancel:function(){n=!0}}},e._getLongtasksStringValue=C,e.getResourceTimings=S,e.pushConnectionTypeTo=f,e.pushTimingTo=L,e.normalize=y,e.sendCounter=R,e.sendDelta=d,e.sendTrafficData=E,e.finalizeLayoutShiftScore=_,e.finalizeLargestContentfulPaint=T,e.onReady=n}(Ya.Rum)},function(e,t,s){"use strict";var i=s(76),n=s(79),r=s(39),o=s(40);e.exports=s(82)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,s=this._i++;return!e||s>=e.length?(this._t=void 0,n(1)):n(0,"keys"==t?s:"values"==t?e[s]:[s,e[s]])},"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t,s){var i=s(18)("unscopables"),n=Array.prototype;null==n[i]&&s(13)(n,i,{}),e.exports=function(e){n[i][e]=!0}},function(e,t,s){e.exports=!s(27)&&!s(49)(function(){return 7!=Object.defineProperty(s(50)("div"),"a",{get:function(){return 7}}).a})},function(e,t,s){var i=s(38);e.exports=function(e,t){if(!i(e))return e;var s,n;if(t&&"function"==typeof(s=e.toString)&&!i(n=s.call(e)))return n;if("function"==typeof(s=e.valueOf)&&!i(n=s.call(e)))return n;if(!t&&"function"==typeof(s=e.toString)&&!i(n=s.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,s){var i=s(81);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t){var s={}.toString;e.exports=function(e){return s.call(e).slice(8,-1)}},function(e,t,s){"use strict";var i=s(48),n=s(83),r=s(41),o=s(13),a=s(39),l=s(87),c=s(56),d=s(95),u=s(18)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,s,g,E,_,T){l(s,t,g);var m,f,S,C=function(e){if(!h&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new s(this,e)}}return function(){return new s(this,e)}},A=t+" Iterator",L="values"==E,y=!1,R=e.prototype,O=R[u]||R["@@iterator"]||E&&R[E],I=O||C(E),P=E?L?C("entries"):I:void 0,N="Array"==t&&R.entries||O;if(N&&(S=d(N.call(new e)))!==Object.prototype&&S.next&&(c(S,A,!0),i||"function"==typeof S[u]||o(S,u,p)),L&&O&&"values"!==O.name&&(y=!0,I=function(){return O.call(this)}),i&&!T||!h&&!y&&R[u]||o(R,u,I),a[t]=I,a[A]=p,E)if(m={values:L?I:C("values"),keys:_?I:C("keys"),entries:P},T)for(f in m)f in R||r(R,f,m[f]);else n(n.P+n.F*(h||y),t,m);return m}},function(e,t,s){var i=s(12),n=s(34),r=s(13),o=s(41),a=s(85),l=function(e,t,s){var c,d,u,h,p=e&l.F,g=e&l.G,E=e&l.S,_=e&l.P,T=e&l.B,m=g?i:E?i[t]||(i[t]={}):(i[t]||{}).prototype,f=g?n:n[t]||(n[t]={}),S=f.prototype||(f.prototype={});for(c in g&&(s=t),s)u=((d=!p&&m&&void 0!==m[c])?m:s)[c],h=T&&d?a(u,i):_&&"function"==typeof u?a(Function.call,u):u,m&&o(m,c,u,e&l.U),f[c]!=u&&r(f,c,h),_&&S[c]!=u&&(S[c]=u)};i.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,s){e.exports=s(33)("native-function-to-string",Function.toString)},function(e,t,s){var i=s(86);e.exports=function(e,t,s){if(i(e),void 0===t)return e;switch(s){case 1:return function(s){return e.call(t,s)};case 2:return function(s,i){return e.call(t,s,i)};case 3:return function(s,i,n){return e.call(t,s,i,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,s){"use strict";var i=s(88),n=s(51),r=s(56),o={};s(13)(o,s(18)("iterator"),function(){return this}),e.exports=function(e,t,s){e.prototype=i(o,{next:n(1,s)}),r(e,t+" Iterator")}},function(e,t,s){var i=s(37),n=s(89),r=s(55),o=s(42)("IE_PROTO"),a=function(){},l=function(){var e,t=s(50)("iframe"),i=r.length;for(t.style.display="none",s(94).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object</script>"),e.close(),l=e.F;i--;)delete l.prototype[r[i]];return l()};e.exports=Object.create||function(e,t){var s;return null!==e?(a.prototype=i(e),s=new a,a.prototype=null,s[o]=e):s=l(),void 0===t?s:n(s,t)}},function(e,t,s){var i=s(36),n=s(37),r=s(53);e.exports=s(27)?Object.defineProperties:function(e,t){n(e);for(var s,o=r(t),a=o.length,l=0;a>l;)i.f(e,s=o[l++],t[s]);return e}},function(e,t,s){var i=s(28),n=s(40),r=s(91)(!1),o=s(42)("IE_PROTO");e.exports=function(e,t){var s,a=n(e),l=0,c=[];for(s in a)s!=o&&i(a,s)&&c.push(s);for(;t.length>l;)i(a,s=t[l++])&&(~r(c,s)||c.push(s));return c}},function(e,t,s){var i=s(40),n=s(92),r=s(93);e.exports=function(e){return function(t,s,o){var a,l=i(t),c=n(l.length),d=r(o,c);if(e&&s!=s){for(;c>d;)if((a=l[d++])!=a)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===s)return e||d||0;return!e&&-1}}},function(e,t,s){var i=s(54),n=Math.min;e.exports=function(e){return e>0?n(i(e),9007199254740991):0}},function(e,t,s){var i=s(54),n=Math.max,r=Math.min;e.exports=function(e,t){return(e=i(e))<0?n(e+t,0):r(e,t)}},function(e,t,s){var i=s(12).document;e.exports=i&&i.documentElement},function(e,t,s){var i=s(28),n=s(96),r=s(42)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,s){var i=s(52);e.exports=function(e){return Object(i(e))}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,
t.default=/\ud83d[\udc68-\udc69](?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92])|(?:\ud83c[\udfcb\udfcc]|\ud83d\udd75|\u26f9)(?:\ufe0f|\ud83c[\udffb-\udfff])\u200d[\u2640\u2642]\ufe0f|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd37-\udd39\udd3d\udd3e\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|(?:[\u0023\u002a\u0030-\u0039])\ufe0f?\u20e3|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddd1-\udddd]|[\u270a\u270b])(?:\ud83c[\udffb-\udfff]|)|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud800\udc00|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a-\udc6d\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\udeeb\udeec\udef4-\udef8]|\ud83e[\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd40-\udd45\udd47-\udd4c\udd50-\udd6b\udd80-\udd97\uddc0\uddd0\uddde-\udde6]|[\u23e9-\u23ec\u23f0\u23f3\u2640\u2642\u2695\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a]|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u00a9\u00ae\u203c\u2049\u2122\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2694\u2696\u2697\u2699\u269b\u269c\u26a0\u26a1\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))/g},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=/^(https?:\/\/)?(([\w\-\u0430-\u045f]+\.)+(com|net|org|info|top|xyz|icu|loan|biz|club|site|online|vip|shop|work|app|mobi|pro|asia|trade|dev|review|party|name|accountant|space|tech|store|gov|education|Ñ€Ñ„|Ñ€ÑƒÑ|ÑÐ°Ð¹Ñ‚|moscow|yandex|google|[a-z]{2}))(:\d+)?(\/\S*)?$/i},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=/^[a-zA-Z0-9\+\.\_\%\-]{1,256}\@[a-zA-Z0-9][a-zA-Z0-9\-]{0,64}(\.[a-zA-Z0-9][a-zA-Z0-9\-]{0,25})+$/},function(e,t,s){"use strict";function i(e){a.push(e),window.postMessage("zero-timeout-message","*")}function n(){if(0===o.length)return;if(l>0)return;l++;let e=Date.now(),t=e;for(;o.length>0&&t-e<35;){const s=o.shift();try{s.fn.call(s.ctx||null)}catch(e){(0,r.logError)(e)}if(t=Date.now(),o.length>0&&o[0].isLongTask)break}o.length>0&&i(n),l--}t.__esModule=!0,t.pushTask=function(e){e.isHighPriority?o.unshift(e):o.push(e),1===o.length&&i(n)};var r=s(8);const o=[],a=[];window.addEventListener("message",function(e){e.source===window&&"zero-timeout-message"===e.data&&(e.stopPropagation(),a.length>0&&a.shift()())},!0);let l=0},function(e,t,s){"use strict";var i,n,r=(i=s(0))&&i.__esModule?i:{default:i};window.XDomainRequest&&((n=window.XDomainRequest.prototype).nativeOpen=n.open,n.nativeSend=n.send,n.nativeAbort=n.abort,n.setRequestHeader=r.default.noop,n.getResponseHeader=function(e){return this.responseText&&"Content-Type"===e?"application/json":null},n.onreadystatechange=r.default.noop,n.getAllResponseHeaders=function(){return""},n.open=function(e,t){this.url=t},n.send=function(e){const t=this;let s=this.url;e&&(s+=(s.indexOf("?")<0?"?":"&")+e);const i=e=>{"load"===e.type&&(this.status=200),this.readyState=4,this.onreadystatechange()};t.onload=i,t.onerror=i,t.ontimeout=r.default.noop,t.onprogress=r.default.noop,t.nativeOpen("GET",s),setTimeout(function(){t.nativeSend()},0)},n.abort=function(){this.nativeAbort(),this.readyState=4,this.onreadystatechange()},n.status=0,n.readyState=0,n.statusText="")},function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.StatisticsModel=void 0;var n=i(s(0)),r=(s(14),s(43)),o=i(s(104));class a extends r.SessionModel{static updateDomTrackingData(e,t){const s=n.default.extend(n.default.safeParseJSON(e.getAttribute("data-tracking-data")),t);e.setAttribute("data-tracking-data",JSON.stringify(s))}constructor(e,t){super(e,t);const s=this.constructor;this._sendMetrikaGoal=window.sendMetrikaGoal,this.setProperty("url",e.url+n.default.toQueryString({dtype:s.DTYPE,pid:s.PID},"/")+"/"),window.sendStatisticsEvent=this.send.bind(this)}getDefaults(){return{url:"/",srv:"",ver:"",uid:"",dir:"",path:"",loadTs:"",isSearchApp:!1}}getUiType(){const{isSearchApp:e,srv:t}=this.getProps();return e?"turboapp":"tr-touch"===t?"touch":"desktop"}getLink(e){return!1}sendMetrika(e){return!1}logEvent(e,t,s={}){return!1}send(e,t){return!1}isTrackingDom(e){return!1}getTrackingDomLeafData(e){return!1}getTrackingDomFullData(e){return!1}sendSingleTrackingDom(e,t,s){return!1}sendNestedTrackingDom(e,t,s){return!1}}t.StatisticsModel=a,a.PID="453",a.DTYPE="stred",a.KEY_PREFIX="ytr",a.MAX_DATA_LENGTH=200,a.targets=o.default},function(e,t,s){"use strict";t.__esModule=!0,t.SyncPromise=void 0;class i{constructor(e){this.result=null,e&&e(e=>this.resolveSync(e))}resolveSync(e){this.result=e}then(e){const t=e&&e(this.result);return new i(e=>e(t))}}t.SyncPromise=i},function(e){e.exports=JSON.parse('{"render":{"cid":"73636"},"tap":{"cid":"73602"},"hover":{"cid":"73603"},"select_text_fragment":{"cid":"73604"},"copy_text_selection":{"cid":"73605"},"lang_swap":{"cid":"73192","mid":"LANGSELECT_FLIP"},"touch_fav_toggle":{"cid":"73264","mid":"TOUCH_FAVOURITES_TOGGLE"},"fav_menu_open":{"cid":"73259","mid":"FAVOURITES_MENU_OPEN"},"fav_sort":{"cid":"73257","mid":"FAVOURITES_SORT"},"fav_sync":{"cid":"73258","mid":"FAVOURITES_SYNC"},"cols_sync":{"cid":"73333","mid":"COLLECTIONS_SYNC"},"cols_record_add":{"cid":"73282","mid":"COLLECTIONS_RECORD_ADD"},"cols_record_delete":{"cid":"73283","mid":"COLLECTIONS_RECORD_DELETE"},"cols_record_insert":{"cid":"73287","mid":"COLLECTIONS_RECORD_INSERT"},"cols_records_delete":{"cid":"73284","mid":"COLLECTIONS_RECORDS_DELETE"},"cols_records_move":{"cid":"73285","mid":"COLLECTIONS_RECORDS_MOVE"},"cols_records_copy":{"cid":"73286","mid":"COLLECTIONS_RECORDS_COPY"},"cols_open":{"cid":"73288","mid":"COLLECTIONS_OPEN"},"cols_create":{"cid":"73289","mid":"COLLECTIONS_CREATE"},"cols_create_tap":{"cid":"74056","mid":"COLLECTIONS_CREATE_TAP"},"cols_rename":{"cid":"73290","mid":"COLLECTIONS_RENAME"},"cols_delete":{"cid":"73291","mid":"COLLECTIONS_DELETE"},"cols_clear":{"cid":"73810","mid":"COLLECTIONS_CLEAR"},"cols_public_change":{"cid":"73292","mid":"COLLECTIONS_PUBLIC_CHANGE"},"cols_subscribe":{"cid":"73293","mid":"COLLECTIONS_SUBSCRIBE"},"cols_subscribe_limit":{"cid":"73293"},"cols_unsubscribe":{"cid":"73294","mid":"COLLECTIONS_UNSUBSCRIBE"},"cols_save":{"cid":"73295","mid":"COLLECTIONS_SAVE"},"cols_search_activate":{"cid":"73296","mid":"COLLECTIONS_SEARCH_ACTIVATE"},"cols_menu_open":{"cid":"73297","mid":"COLLECTIONS_MENU_OPEN"},"cols_link_copy":{"cid":"73298","mid":"COLLECTIONS_LINK_COPY"},"cols_link_share":{"cid":"73299","mid":"COLLECTIONS_LINK_SHARE"},"cols_sharing_subscribe":{"cid":"73300","mid":"COLLECTIONS_SHARING_SUBSCRIBE"},"cols_db_error":{"cid":"73301","mid":"COLLECTIONS_DB_ERROR"},"cols_db_error_excp":{"cid":"73306","mid":"COLLECTIONS_DB_ERROR_EXCP"},"cols_db_inactive_tap":{"cid":"74057","mid":"COLLECTIONS_DB_INACTIVE_TAP"},"cols_no_col_for_active_id":{"cid":"73578"},"cols_reseted_ids":{"cid":"73361","mid":"COLLECTIONS_RESETED_IDS"},"cols_db_index_not_found":{"cid":"73954"},"training_open":{"cid":"73302","mid":"TRAINING_OPEN"},"training_settings_open":{"cid":"73303","mid":"TRAINING_SETTINGS_OPEN"},"training_progress_reset":{"cid":"73304","mid":"TRAINING_PROGRESS_RESET"},"training_swipe":{"cid":"73305"},"training_exit":{"cid":"73844","mid":"TRAINING_EXIT"},"training_end":{"cid":"73845","mid":"TRAINING_END"},"training_check_good":{"cid":"73847"},"training_check_bad":{"cid":"73848"},"training_level_changed":{"cid":"73883","mid":"TRAINING_LEVEL_CHANGED"},"training_skip":{"cid":"73882"},"training_started":{"cid":"74082","mid":"TRAINING_STARTED"},"training_revert":{"cid":"74070","mid":"TRAINING_REVERT"},"training_revert_banner_shown":{"cid":"74079","mid":"TRAINING_REVERT_BANNER_SHOWN"},"training_onboarding_shown":{"cid":"74078","mid":"TRAINING_ONBOARDING_SHOWN"},"training_revert_click_onboarding":{"cid":"74080","mid":"TRAINING_REVERT_CLICK_ONBOARDING"},"training_revert_click_banner":{"cid":"74081","mid":"TRAINING_REVERT_CLICK_BANNER"},"yata_init":{"cid":"73462","mid":"YATA_INIT"},"langselect_open_src":{"cid":"73465","mid":"LANGSELECT_OPEN_SRC"},"langselect_open_dst":{"cid":"73465","mid":"LANGSELECT_OPEN_DST"},"touch_langselect_open":{"cid":"73465","mid":"TOUCH_LANGSELECT_OPEN"},"langselect_select_src":{"cid":"73466","mid":"LANGSELECT_SELECT_SRC"},"langselect_select_dst":{"cid":"73466","mid":"LANGSELECT_SELECT_DST"},"langselect_recent_select_src":{"cid":"73466","mid":"LANGSELECT_RECENT_SELECT_SRC"},"langselect_recent_select_dst":{"cid":"73466","mid":"LANGSELECT_RECENT_SELECT_DST"},"touch_langselect_select":{"cid":"73466","mid":"TOUCH_LANGSELECT_SELECT"},"langselect_pin":{"cid":"73467","mid":"LANGSELECT_PIN"},"langselect_unpin":{"cid":"73467","mid":"LANGSELECT_UNPIN"},"text_translate":{"cid":"74058","mid":"TEXT_TRANSLATE"},"text_delete":{"cid":"73468","mid":"TEXT_DELETE"},"text_search":{"cid":"73471","mid":"TEXT_SEARCH"},"text_copy":{"cid":"73469","mid":"TEXT_COPY"},"text_select":{"cid":"73470","mid":"TEXT_SELECT"},"text_paste":{"cid":"73472","mid":"TEXT_PASTE"},"text_paste_button":{"cid":"74186","mid":"TEXT_PASTE_BUTTON"},"text_download":{"cid":"73473","mid":"TEXT_DOWNLOAD"},"url_translate":{"cid":"73535","mid":"URL_TRANSLATE"},"url_translate_enter":{"cid":"73535","mid":"URL_TRANSLATE_ENTER"},"url_translation_error":{"cid":"73536","mid":"URL_ERROR"},"url_loading_error":{"cid":"74022","mid":"URL_LOADING_ERROR"},"url_delete":{"cid":"73537","mid":"URL_DELETE"},"url_open_orig_in_new_tab":{"cid":"73881","mid":"URL_OPEN_ORIG_IN_NEW_TAB"},"url_loading_time":{"cid":"74095"},"url_translation_time":{"cid":"74096"},"url_dom_not_loaded":{"cid":"74098","mid":"URL_DOM_NOT_LOADED"},"url_error":{"cid":"74099","mid":"URL_FRAME_ERROR"},"touch_url_translate_error":{"cid":"74146","mid":"TOUCH_URL_TRANSLATE_ERROR"},"touch_url_frame_error":{"cid":"74145","mid":"TOUCH_URL_FRAME_ERROR"},"syns_insert":{"cid":"73474","mid":"SYNONYMS_INSERT"},"syns_show":{"cid":"73475","mid":"SYNONYMS_SHOW"},"suggestions_show":{"cid":"73798"},"suggestions_apply":{"cid":"73803"},"suggestions_item_navigate":{"cid":"73805"},"suggestions_item_hover":{"cid":"73800"},"predictor_show":{"cid":"73481"},"predictor_apply":{"cid":"73482","mid":"PREDICTOR_APPLY"},"dst_predictor_show":{"cid":"73585"},"dst_predictor_apply":{"cid":"73586"},"speller_autocorrect":{"cid":"74060","mid":"SPELLER_AUTOCORRECT"},"speller_click":{"cid":"73476","mid":"SPELLER_CLICK"},"speller_apply":{"cid":"73477","mid":"SPELLER_APPLY"},"speller_accept":{"cid":"73478","mid":"SPELLER_ACCEPT"},"speller_decline":{"cid":"73479","mid":"SPELLER_DECLINE"},"speller_switch_on":{"cid":"73480","mid":"SPELLER_SWITCH_ON"},"speller_switch_off":{"cid":"73480","mid":"SPELLER_SWITCH_OFF"},"tts_play":{"cid":"73483","mid":"TTS_PLAY"},"tts_native_play":{"cid":"73483","mid":"TTS_NATIVE_PLAY"},"tts_error":{"cid":"73484","mid":"TTS_ERROR"},"tts_native_error":{"cid":"73484","mid":"TTS_NATIVE_ERROR"},"touch_tts_animated_tap":{"cid":"73580","mid":"TOUCH_TTS_ANIMATED_TAP"},"translation_error":{"cid":"73486"},"translation_complain":{"cid":"73487","mid":"TRANSLATION_COMPLAIN"},"translation_edit":{"cid":"73488","mid":"TRANSLATION_EDIT"},"translation_edit_open":{"cid":"73489","mid":"TRANSLATION_EDIT_OPEN"},"translation_edit_close":{"cid":"73490","mid":"TRANSLATION_EDIT_CLOSE"},"asr_start":{"cid":"73491","mid":"ASR_START"},"asr_stop":{"cid":"73492","mid":"ASR_STOP"},"asr_error":{"cid":"73493","mid":"ASR_ERROR"},"asr_recognize":{"cid":"73494"},"touch_asr_disabled_tap":{"cid":"73495","mid":"TOUCH_ASR_DISABLED_TAP"},"rubber_scrolled":{"cid":"73599"},"dict_complain":{"cid":"73496","mid":"DICT_COMPLAIN"},"dict_complain_open":{"cid":"73497","mid":"DICT_COMPLAIN_OPEN"},"dict_complain_close":{"cid":"73497","mid":"DICT_COMPLAIN_CLOSE"},"dict_complain_error":{"cid":"73498"},"dict_show":{"cid":"73499","mid":"DICT_SHOW"},"dict_popup_show":{"cid":"73499","mid":"DICT_POPUP_SHOW"},"examples_rendered":{"cid":"73568","mid":"EXAMPLES_RENDERED"},"examples_popup_rendered":{"cid":"73568","mid":"EXAMPLES_POPUP_RENDERED"},"examples_complaint":{"cid":"73955","mid":"EXAMPLES_COMPLAINT"},"examples_complaint_start":{"cid":"73956","mid":"EXAMPLES_COMPLAINT_START"},"dict_examples_show":{"cid":"73500","mid":"DICT_EXAMPLES_SHOW"},"dict_examples_hide":{"cid":"73500","mid":"DICT_EXAMPLES_HIDE"},"dict_link_click":{"cid":"73501","mid":"DICT_LINK_CLICK"},"dict_toggle":{"cid":"73502","mid":"DICT_TOGGLE"},"definition_rendered":{"cid":"74186","mid":"DEFINITION_RENDERED"},"abbr_switched":{"cid":"74186","mid":"ABBR_SWITCHED"},"definition_source_click":{"cid":"74186","mid":"DEFINITION_SOURCE_CLICK"},"settings_open":{"cid":"73503","mid":"OPTIONS_OPEN"},"settings_onload":{"cid":"73504"},"settings_auto_click":{"cid":"73505","mid":"OPTIONS_CLICK_AUTO"},"settings_shift_click":{"cid":"73505","mid":"OPTIONS_CLICK_SHIFT"},"settings_enter_click":{"cid":"73505","mid":"OPTIONS_CLICK_SHIFT"},"settings_hotkeys_click":{"cid":"73505","mid":"OPTIONS_CLICK_SHIFT"},"settings_autocorrect_click":{"cid":"73505","mid":"OPTIONS_CLICK_SPELLER"},"settings_theme_change":{"cid":"73505","mid":"THEME_CHANGE"},"keyboard_open":{"cid":"73506","mid":"KEYBOARD_OPEN"},"keyboard_close":{"cid":"73506","mid":"KEYBOARD_CLOSE"},"sharing_open":{"cid":"73507","mid":"SHARING_OPEN"},"sharing_share_vkontakte":{"cid":"73508","mid":"SHARING_SHARE_VKONTAKTE"},"sharing_share_odnoklassniki":{"cid":"73508","mid":"SHARING_SHARE_ODNOKLASSNIKI"},"sharing_share_mail":{"cid":"73508","mid":"SHARING_SHARE_MAIL"},"stat_searchapp":{"cid":"73672"},"sharing_input_click":{"cid":"73509","mid":"SHARING_INPUT_CLICK"},"sharing_copy_click":{"cid":"73509","mid":"SHARING_COPY_CLICK"},"touch_ocr_open":{"cid":"73459","mid":"TOUCH_OCR_OPEN"},"touch_ocr_autoinit":{"cid":"73263","mid":"TOUCH_OCR_AUTOINIT"},"touch_ocr_tap":{"cid":"73687","mid":"TOUCH_OCR_TAP"},"touch_ocr_disabled_tap":{"cid":"73460","mid":"TOUCH_OCR_DISABLED_TAP"},"ocr_load_image":{"cid":"73513","mid":"OCR_LOAD_IMAGE"},"ocr_recognize":{"cid":"73514","mid":"OCR_RECOGNIZE"},"ocr_select_area":{"cid":"73516","mid":"OCR_SELECT_AREA"},"ocr_box_tap":{"cid":"73517","mid":"OCR_BOX_TAP"},"ocr_translation_navigate":{"cid":"73518","mid":"OCR_TRANSLATION_NAVIGATE"},"touch_ocr_image_select":{"cid":"73519","mid":"TOUCH_OCR_IMAGE_SELECT"},"touch_ocr_rotation_apply":{"cid":"73521","mid":"TOUCH_OCR_ROTATION_APPLY"},"touch_ocr_download_image":{"cid":"73696","mid":"TOUCH_OCR_DOWNLOAD_IMAGE"},"touch_ocr_card_show":{"cid":"73522","mid":"TOUCH_OCR_CARD_SHOW"},"touch_ocr_card_tts_play":{"cid":"73523","mid":"TOUCH_OCR_CARD_TTS_PLAY"},"touch_ocr_card_tts_error":{"cid":"73524","mid":"TOUCH_OCR_CARD_TTS_ERROR"},"touch_ocr_card_tts_native_play":{"cid":"73523","mid":"TOUCH_OCR_CARD_TTS_NATIVE_PLAY"},"touch_ocr_card_tts_native_error":{"cid":"73524","mid":"TOUCH_OCR_CARD_TTS_NATIVE_ERROR"},"touch_ocr_card_tts_disabled_tap":{"cid":"73525","mid":"TOUCH_OCR_CARD_TTS_DISABLED_TAP"},"ocr_refresh_alert_show":{"cid":"73526","mid":"OCR_REFRESH_ALERT_SHOW"},"ocr_refresh_alert_click":{"cid":"73527","mid":"OCR_REFRESH_ALERT_CLICK"},"ocr_image_zoom_in":{"cid":"73528","mid":"OCR_IMAGE_ZOOM_IN"},"ocr_image_zoom_out":{"cid":"73528","mid":"OCR_IMAGE_ZOOM_OUT"},"ocr_move":{"cid":"73529","mid":"OCR_MOVE"},"ocr_delete":{"cid":"73530","mid":"OCR_DELETE"},"ocr_contrast_enable":{"cid":"74071","mid":"OCR_CONTRAST_ENABLE"},"ocr_contrast_disable":{"cid":"74071","mid":"OCR_CONTRAST_DISABLE"},"ocr_align_change":{"cid":"74072","mid":"OCR_ALIGN_CHANGE"},"ocr_orig_show":{"cid":"74073","mid":"OCR_ORIG_SHOW"},"ocr_orig_hide":{"cid":"74073","mid":"OCR_ORIG_HIDE"},"ocr_rotate":{"cid":"74074","mid":"OCR_ROTATE"},"ocr_download":{"cid":"74075","mid":"OCR_DOWNLOAD"},"resizer_onload":{"cid":"73531"},"resizer_resize":{"cid":"73532","mid":"RESIZER_RESIZE"},"url_page_interaction":{"cid":"73533","mid":"URL_PAGE_INTERACTION"},"sms_error":{"cid":"73534","mid":"SMS_ERROR"},"footer_promo_show":{"cid":"73538","mid":"FOOTER_PROMO_SHOW"},"footer_promo_close":{"cid":"73539","mid":"FOOTER_PROMO_CLOSE"},"url_mode_changed_s":{"cid":"73540","mid":"WINDOW_MODE_ORIGINAL"},"url_mode_changed_t":{"cid":"73540","mid":"WINDOW_MODE_TRANSLATION"},"url_layout_changed_s":{"cid":"73541","mid":"LAYOUT_MODE_OVERLAPPED"},"url_layout_changed_v":{"cid":"73541","mid":"LAYOUT_MODE_VERTICAL"},"url_layout_changed_h":{"cid":"73541","mid":"LAYOUT_MODE_HORIZONTAL"},"url_popup_expand":{"cid":"73542","mid":"TR_POPUP_EXPAND"},"url_popup_send":{"cid":"73543","mid":"TR_POPUP_SEND"},"url_popup_close":{"cid":"73544","mid":"TR_POPUP_CLOSE"},"url_popup_dislike":{"cid":"74151","mid":"TR_POPUP_DISLIKE"},"document_upload_tap":{"cid":"73674","mid":"DOCUMENT_UPLOAD_TAP"},"document_download_tap":{"mid":"DOCUMENT_DOWNLOAD_TAP","cid":"73694"},"document_translate":{"cid":"73675","mid":"DOCUMENT_TRANSLATE"},"size_error":{"cid":"73676","mid":"DOCUMENT_SIZE_ERROR"},"convert_error":{"cid":"73677","mid":"DOCUMENT_CONVERT_ERROR"},"document_error":{"cid":"73677","mid":"DOCUMENT_ERROR"},"document_download_error":{"cid":"73695","mid":"DOCUMENT_DOWNLOAD_ERROR"},"doc_mode_changed_s":{"cid":"73678","mid":"DOCUMENT_MODE_ORIGINAL"},"doc_mode_changed_t":{"cid":"73678","mid":"DOCUMENT_MODE_TRANSLATION"},"doc_layout_changed_s":{"cid":"73682","mid":"DOCUMENT_LAYOUT_OVERLAPPED"},"doc_layout_changed_v":{"cid":"73682","mid":"DOCUMENT_LAYOUT_VERTICAL"},"doc_layout_changed_h":{"cid":"73682","mid":"DOCUMENT_LAYOUT_HORIZONTAL"},"doc_popup_expand":{"cid":"73679","mid":"DOCUMENT_POPUP_EXPAND"},"doc_popup_send":{"cid":"73680","mid":"DOCUMENT_POPUP_SEND"},"doc_popup_close":{"cid":"73681","mid":"DOCUMENT_POPUP_CLOSE"},"refresh_alert_show":{"cid":"73545","mid":"REFRESH_ALERT_SHOW"},"refresh_alert_click":{"cid":"73546","mid":"REFRESH_ALERT_CLICK"},"session_resume":{"cid":"73547"},"visibility_change":{"cid":"73600"},"history_move":{"cid":"73635"},"storage_error":{"cid":"73548","mid":"STORAGE_ERROR"},"alt_translate_google":{"cid":"73549","mid":"ALTERNATIVE_TRANSLATE_GOOGLE"},"alt_translate_bing":{"cid":"73549","mid":"ALTERNATIVE_TRANSLATE_BING"},"translit_button_show":{"cid":"73550","mid":"TRANSLIT_BUTTON_SHOW"},"translit_show":{"cid":"73551","mid":"TRANSLIT_SHOW"},"translit_hide":{"cid":"73551","mid":"TRANSLIT_HIDE"},"translit_error":{"cid":"73552","mid":"TRANSLIT_ERROR"},"translation_vote_good":{"cid":"73553","mid":"TRANSLATION_VOTE_GOOD"},"translation_vote_bad":{"cid":"73553","mid":"TRANSLATION_VOTE_BAD"},"touch_webapp_prompt_show":{"cid":"73554","mid":"TOUCH_WEBAPP_PROMPT_SHOW"},"touch_webapp_prompt_install":{"cid":"73555","mid":"TOUCH_WEBAPP_PROMPT_INSTALL"},"touch_webapp_prompt_dismiss":{"cid":"73556","mid":"TOUCH_WEBAPP_PROMPT_DISMISS"},"corpus_request":{"cid":"73557","mid":"CORPUS_REQUEST"},"page_load":{"cid":"73558"},"landing_lyrics_load":{"cid":"73584"},"landing_lyrics_translate_button_click":{"cid":"73583"},"popup_show":{"cid":"73560","mid":"POPUP_SHOW"},"popup_empty_show":{"cid":"73560","mid":"POPUP_EMPTY_SHOW"},"popup_close":{"cid":"73560","mid":"POPUP_CLOSE"},"more_examples_click":{"cid":"73561","mid":"MORE_EXAMPLES_CLICK"},"examples_show":{"cid":"73562","mid":"EXAMPLES_SHOW"},"examples_hide":{"cid":"73562","mid":"EXAMPLES_HIDE"},"example_tab_click":{"cid":"73563","mid":"EXAMPLE_TAB_CLICK"},"example_sound":{"cid":"73566","mid":"EXAMPLE_SOUND_CLICK"},"example_origin_show":{"cid":"73564","mid":"EXAMPLE_ORIGIN_SHOW"},"custom_examples_close":{"cid":"73693","mid":"CUSTOM_EXAMPLES_CLOSE"},"touch_tab_click":{"cid":"73639","mid":"TOUCH_TAB_CLICK"},"select_tooltip_show":{"cid":"73565","mid":"SELECT_TOOLTIP_SHOW"},"auto_play_text":{"cid":"73593","mid":"AUTO_PLAY_TEXT"},"example_vote_good":{"cid":"73588","mid":"EXAMPLE_VOTE_GOOD"},"example_vote_bad":{"cid":"73588","mid":"EXAMPLE_VOTE_BAD"},"touch_landing_show":{"cid":"73697","mid":"TOUCH_LANDING_SHOW"},"touch_landing_download":{"cid":"73698","mid":"TOUCH_LANDING_DOWNLOAD"},"touch_landing_close":{"cid":"73699","mid":"TOUCH_LANDING_CLOSE"},"touch_landing_close_cross":{"cid":"73708","mid":"TOUCH_LANDING_CLOSE_CROSS"},"touch_dialog_tap":{"cid":"73686","mid":"TOUCH_DIALOG_TAP"},"touch_dialog_disabled_tap":{"cid":"73686","mid":"TOUCH_DIALOG_DISABLED_TAP"},"dist_banner_render":{"cid":"73692","mid":"SHOW_DIST_BANNER"},"dist_banner_hide":{"cid":"73743","mid":"AUTO_HIDE_DIST_BANNER"},"hide_banners_setting_enabled":{"cid":"74061","mid":"HIDE_BANNERS_SETTING_ENABLED"},"hide_banners_setting_disabled":{"cid":"74062","mid":"HIDE_BANNERS_SETTING_DISABLED"},"history_setting_enabled":{"cid":"74063","mid":"HISTORY_SETTING_ENABLED"},"history_setting_disabled":{"cid":"74064","mid":"HISTORY_SETTING_DISABLED"},"tap_miss":{"cid":"73700","mid":"TAP_MISS"},"uniproxy_asr_error":{"cid":"73710","mid":"UNIPROXY_ASR_ERROR"},"uniproxy_tts_error":{"cid":"73711","mid":"UNIPROXY_TTS_ERROR"},"typing_speed_report":{"cid":"73797"},"history_open":{"cid":"73811","mid":"HISTORY_OPEN"},"history_select":{"cid":"73812","mid":"HISTORY_SELECT"},"focused_element_activation":{"cid":"73880","mid":"FOCUSED_ELEMENT_ACTIVATION"},"example_link_click":{"cid":"74065","mid":"EXAMPLE_LINK_CLICK"},"example_tab_word_click":{"cid":"74067","mid":"EXAMPLE_TAB_WORD_CLICK"},"dict_show_more":{"cid":"74068","mid":"DICT_SHOW_MORE"},"idioms_info_click":{"cid":"74083","mid":"IDIOMS_INFO_CLICK"},"idioms_complaint_click":{"cid":"74084","mid":"IDIOMS_COMPLAINT_CLICK"},"idioms_complaint_send":{"cid":"74085","mid":"IDIOMS_COMPLAINT_SEND"},"idioms_rendered":{"cid":"74086","mid":"IDIOMS_RENDERED"},"idioms_text_click":{"cid":"74087","mid":"IDIOMS_TEXT_CLICK"},"idiom_example_popup_open":{"cid":"74088","mid":"IDIOM_EXAMPLE_POPUP_OPEN"},"touch_idiom_text_expand":{"cid":"74089","mid":"TOUCH_IDIOM_TEXT_EXPAND"},"related_words_render":{"cid":"74090","mid":"RELATED_WORDS_RENDER"},"related_words_click":{"cid":"74091","mid":"RELATED_WORDS_CLICK"},"related_words_expand":{"cid":"74092","mid":"RELATED_WORDS_EXPAND"},"related_words_complaint_send":{"cid":"74093","mid":"RELATED_WORDS_COMPLAINT_SEND"},"mini_nav_item_click":{"cid":"74186","mid":"MINI_NAV_ITEM_CLICK"},"mini_nav_control_click":{"cid":"74186","mid":"MINI_NAV_CONTROL_CLICK"},"declensions_render":{"cid":"74101","mid":"DECLENSIONS_RENDER"},"declensions_click":{"cid":"74102","mid":"DECLENSIONS_CLICK"},"declensions_complaint_send":{"cid":"74103","mid":"DECLENSIONS_COMPLAINT_SEND"},"declensions_expand":{"cid":"74104","mid":"DECLENSIONS_EXPAND"},"declensions_tab_click":{"cid":"74186","mid":"DECLENSIONS_TAB_CLICK"},"declensions_list_scroll":{"cid":"74186","mid":"DECLENSIONS_LIST_SCROLL"},"langs_search_tap":{"cid":"74138","mid":"TOUCH_LANGSELECT_OPEN_SEARCH"},"langs_search_select_lang":{"cid":"74139","mid":"TOUCH_LANGSELECT_SEARCH_SELECT"},"touch_night_theme_user_activation":{"cid":"74140","mid":"TOUCH_DARK_THEME_USER_ACTIVATION"},"touch_night_theme_auto_activation":{"cid":"74141","mid":"TOUCH_DARK_THEME_AUTO_ACTIVATION"},"touch_night_theme_promo_show":{"cid":"74147","mid":"TOUCH_DARK_THEME_PROMO_SHOW"},"touch_night_theme_promo_close":{"cid":"74148","mid":"TOUCH_DARK_THEME_PROMO_CLOSE"},"touch_nav_tab_activation":{"mid":"TOUCH_NAV_TAB_ACTIVATION","cid":"74184"},"touch_history_collection_open":{"cid":"74186","mid":"TOUCH_HISTORY_COLLECTION_OPEN"},"touch_favorites_collection_open":{"cid":"74186","mid":"TOUCH_FAVORITES_COLLECTION_OPEN"},"example_scroll_control_click":{"mid":"EXAMPLE_SCROLL_CONTROL_CLICK"},"example_ref_click":{"cid":"74186","mid":"EXAMPLE_REF_CLICK"},"popup_night_theme_activation":{"mid":"POPUP_NIGHT_THEME_ACTIVATION"},"themes_popup_close":{"mid":"THEMES_POPUP_CLOSE"},"themes_popup_show":{"mid":"THEMES_POPUP_SHOW"},"theme_page_open":{"mid":"THEME_PAGE_OPEN"},"desktop_redesign_enable_redesign":{"cid":"74186"},"speller_popup_shown":{"cid":"74186"},"speller_popup_close_click":{"cid":"74186"},"tts_play_src":{"mid":"TTS_PLAY_SRC","cid":"74186"},"tts_play_dst":{"mid":"TTS_PLAY_DST","cid":"74186"},"examples_show_more":{"mid":"EXAMPLES_SHOW_MORE","cid":"74186"},"langselect_search_button_click":{"mid":"LANGSELECT_SEARCH_BUTTON_CLICK","cid":"74186"},"langselect_search_type":{"mid":"LANGSELECT_SEARCH_TYPE","cid":"74186"},"document_reset_doc":{"mid":"DOCUMENT_RESET_DOC","cid":"74186"},"sid_fetched":{"cid":"74186"},"tts_stop_src":{"mid":"TTS_STOP_SRC","cid":"74186"},"tts_stop_dst":{"mid":"TTS_STOP_DST","cid":"74186"},"document_translated":{"mid":"DOCUMENT_TRANSLATED","cid":"74186"},"selection_promo_show":{"mid":"SELECTION_POPUP_SHOW","cid":"74186"},"redirect_to_source":{"cid":"74186"},"first_translation_request":{"cid":"74186"},"first_translation_response":{"cid":"74186"},"selection_sheet_expand":{"cid":"74186"},"selection_sheet_syn_click":{"cid":"74186"},"daily_phrase_activate":{"cid":"74186"},"stories_open":{"cid":"74186"},"stories_activate":{"cid":"74186"},"stories_move":{"cid":"74186"},"stories_close":{"cid":"74186"},"stories_feedback":{"cid":"74186"},"stories_rendered":{"cid":"74186"},"stories_desktop_preview_move":{"cid":"74186"},"stories_touch_preview_visible":{"cid":"74186"},"feedback_show":{"cid":"74186"},"feedback_vote":{"cid":"74186"},"feedback_send":{"cid":"74186"},"feedback_cancel":{"cid":"74186"},"feedback_close":{"cid":"74186"},"feedback_promo":{"cid":"74186"},"scroll_to_top":{"cid":"74186","mid":"SCROLL_TO_TOP"},"sticky_header_open_menu":{"cid":"74186"},"backspace_pressed":{"cid":"74186"},"keyboard_closed":{"cid":"74186"},"definition_complaint_send":{"cid":"74186"},"hotkeys_cheat_sheet_open":{"cid":"74186"},"hotkey_used":{"cid":"74186"},"block_visible":{"cid":"74186"},"ocr_complaint_send":{"cid":"74186"},"ocr_complaint_open":{"cid":"74186"},"ocr_complaint_image_send":{"cid":"74186"},"antirobot_ajax_captcha":{"cid":"74186"},"seo_dump_used":{"cid":"74186"},"text_copy_src":{"cid":"74186","mid":"TEXT_COPY_SRC"},"text_select_src":{"cid":"74186","mid":"TEXT_SELECT_SRC"},"text_download_src":{"cid":"74186","mid":"TEXT_DOWNLOAD_SRC"},"touch_dialog_open":{"cid":"74186","mid":"TOUCH_DIALOG_OPEN"}}')},function(e,t,s){"use strict";t.__esModule=!0,t.BaseApplication=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(8),a=s(14),l=s(20);class c extends l.Presenter{constructor(e={}){super(e),this._activeModules=[],this._config=e.config,this.tracker=r.$tracker;const t=this,s=this.getView(),i=function(e){if("hidden"in document)return"hidden";for(let t=0;t<e.length;t++){const s=e[t]+"Hidden";if(s in document)return s}return""}(["webkit","moz","ms","o"]),a=n.default.debounce(function(){t.emit("resize")}),l=()=>{s.setState("unresolved",!1),t.emit("pageReady")};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l,!1):setTimeout(l,0),window.addEventListener("load",function e(){window.addEventListener("online",t.updateOnlineStatus.bind(t,!1)),window.addEventListener("offline",t.updateOnlineStatus.bind(t,!1)),t.emit("pageLoaded"),this.removeEventListener("load",e,!1)},!1),window.addEventListener("resize",a,!1),window.addEventListener("orientationchange",a,!1),window.addEventListener("scroll",n.default.throttle(function(){t.emit("bodyScroll")})),i&&document.addEventListener(i.replace(/hidden/i,"")+"visibilitychange",function(){return!1},!1),
s.on("tap",function(e){const s=this.getClosest(e.target,function(e){return e.hasAttribute("data-action")}),i=this.getClosest(e.target,function(e){return e.hasAttribute("data-tracker-goal")});try{(0,o.setLatestTapEvent)(e,e.target,s)}catch(e){}if(s){const i=s.getAttribute("data-action");s.hasAttribute("data-no-prevent")||n.default.preventEvent(e),t.emit("action",i,s,{originalEvent:e}).emit("action:"+i,s,{originalEvent:e})}i&&t.emit("track",i.getAttribute("data-tracker-goal")),(0,o.isPrevTapMiss)()&&t.emit("prevTapMiss")}),this.updateOnlineStatus(!0)}getConfig(){return this._config}getExpFlags(){return Object.entries(this._config.EXP_FLAGS||{}).filter(([e,t])=>t).map(([e])=>e)}registerModule(e){return n.default.queueTask(()=>{const t=Date.now(),s=new e(this,this.getConfig());a.logTime.module(s.moduleName||s.moduleId,Date.now()-t),this._activeModules.push(s)}),this}reload(){if(this.getSettings()){const e=this.getModel().getProperty("trText");this.getSettings().setProperty("savedText",e)}window.location.href=window.location.href}reloadIfSessionExpired(){Date.now()-c.SESSION_START>c.SESSION_EXPIRATION_TIME&&this.reload()}updateOnlineStatus(e=!1){this.getModel().setProperty("appOnline",n.default.isOnline(),{silent:e})}getSettings(){return this._settings}}t.BaseApplication=c,c.SESSION_START=Date.now(),c.SESSION_EXPIRATION_TIME=2592e5},function(e,t,s){"use strict";t.__esModule=!0,t.LANG_SELECT_EVENTS=t.HIGHLIGHT_ATTR=t.DesktopLanguagesModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2),o=s(107),a=s(7),l=s(30),c=s(110);t.LANG_SELECT_EVENTS={LANG_SELECTED:"langSelected",OPEN_LANG_SELECT:"openLangSelect",LANG_SELECT_EXPANDED:"langSelectExpanded"},t.HIGHLIGHT_ATTR="data-highlighted";class d extends o.AbstractLanguagesModule{constructor(e,t){super(e,t),this.srcLangButton=this.makeSrcLangButton(),this.dstLangButton=this.makeDstLangButton(),this.resetText(),this.resetText=n.default.debounce(this.resetText,100),this.debouncedSetInputFocus=this.debounceMethod(()=>this.view.setInputFocus(),100),this.visibilityTimeout=null,this.savedViewportWidth=document.documentElement.clientWidth,this.setupLangButtons(),this.setupAppView(),this.listenApp(),this.listenAppModel(),this.listenAppView()}setupAppView(){this.appView.setState("auto",this.appSettings.isAutodetectEnabled())}setupLangButtons(){const e=(e,t)=>{this.appSettings.setProperty(e,t),this.appModel.setProperty(e,t),(e===a.LANG_PROPS.SRC_LANG?this.srcLangButton:this.dstLangButton).setTextContent(this.appConfig.TRANSLATOR_LANGS[t])};e(a.LANG_PROPS.SRC_LANG,this.app.getDefaultSrcLanguage()),e(a.LANG_PROPS.DST_LANG,this.app.getDefaultDstLanguage())}closeView(){this.view&&(this.view.reset(),this.view.setVisible(!1))}openLanguagesView(e){const t=this.view&&e!==this.view.getType(),s=this.view&&this.view.isVisible();clearTimeout(this.visibilityTimeout),this.resetText(),super.openLanguagesView(e),s&&this.closeView(),t&&s?this.visibilityTimeout=setTimeout(()=>{this.activateLanguagesView()},250):s||this.activateLanguagesView()}activateLanguagesView(){this.view.updateAsync.callNow.call(this.view),this.view.setVisible(!0),this.debouncedSetInputFocus()}initInternal(){this.view=this.makeLanguageSelectComponent(),super.initInternal(),this.view.onStateChanged("hidden",e=>{const t=this.view.isSrc();this.appView.setState("langs_opened",!e),this.appView.setState("langs_opened_src",t);const s=t?this.srcLangButton:this.dstLangButton,i=t?this.dstLangButton:this.srcLangButton;s.setState({expanded:!e}),i.setState({expanded:!1})}),this.srcLanguagesModel.onChange("autodetect",e=>{this.appView.setState("auto",e),this.app.emit("action:toggleAuto")})}handleResize(){const e=document.documentElement.clientWidth;e!==this.savedViewportWidth&&(this.savedViewportWidth=e,this.closeView())}listenApp(){this.app.on("resize",()=>this.handleResize()).onAction("swapDirection",()=>this.app.swapDirection())}listenAppModel(){this.appModel.onChange(a.LANG_PROPS.SRC_LANG,e=>{const t=this.appConfig.TRANSLATOR_LANGS[e];this.srcLangButton.setTextContent(t).setContentElementAttribute("aria-label",`${l.locales.languageSelect.selectSrcTooltip} ${t}`)}).onChange(a.LANG_PROPS.DST_LANG,e=>{const t=this.appConfig.TRANSLATOR_LANGS[e];this.dstLangButton.setTextContent(t).setContentElementAttribute("aria-label",`${l.locales.languageSelect.selectDstTooltip} ${t}`)})}listenAppView(){this.appView.onTap(e=>{this.isLangSelectNode(e)||this.closeView()})}isLangButton(e){return e===this.appConfig.ELEMENTS.srcLangButton||e===this.appConfig.ELEMENTS.dstLangButton}isLangSelectNode(e){return!!this.view&&(this.view.getElement().contains(e.target)||this.isLangButton(e.target))}resetText(){return this.view&&this.view.reset()}getTranslatorElement(){return this.appConfig.ELEMENTS.translator}makeLanguageSelectComponent(){return new c.LanguagesComponent({tags:this.appConfig.TRANSLATOR_LANGS_TAGS,langs:this.appConfig.TRANSLATOR_LANGS,srcLang:this.appModel.getProperty(a.LANG_PROPS.SRC_LANG),dstLang:this.appModel.getProperty(a.LANG_PROPS.DST_LANG),translatorElement:this.getTranslatorElement(),appView:this.appView},{container:this.appConfig.ELEMENTS.langSelect,hideAfterTransition:!0})}makeSrcLangButton(){return new r.TouchView({element:this.appConfig.ELEMENTS.srcLangButton,DOMEvents:"keydown keypress",activateFocus:!0})}makeDstLangButton(){return new r.TouchView({element:this.appConfig.ELEMENTS.dstLangButton,DOMEvents:"keydown keypress",activateFocus:!0})}}t.DesktopLanguagesModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractLanguagesModule=void 0;var i=s(3),n=s(5),r=s(7),o=s(108),a=s(109),l=s(23);class c extends n.AppModule{constructor(e,t){super(e,t),this.moduleName="langs",this.app.onAction(r.LANG_EVENTS.EVENT_OPEN_SRC_LANGUAGES,()=>this.openLanguagesView("src")).onAction(r.LANG_EVENTS.EVENT_OPEN_DST_LANGUAGES,()=>this.openLanguagesView("dst")).onAction(["swapLang","swapDirection"],()=>{const e=this.appModel.getProps();i.$tracker.sendMetric("lang_swap",{dir:e.srcLang+"-"+e.dstLang})}),this.setupLangsHistory()}setupLangsHistory(){const e=this.appSettings.getSrcLangHistory(),t=this.appSettings.getDstLangHistory();Object.keys(e).length||this.appSettings.setSrcLangHistory({[this.appConfig.UI_LANG]:!0}),Object.keys(t).length||this.appSettings.setDstLangHistory({[this.app.getDefaultDstLanguage()]:!0})}openLanguagesView(e){if(this.view||this.initInternal(),!this.view.isVisible()||e!==this.view.getType()){const t="src"===e,s=Date.now();t?(this.srcLanguagesModel.setProperty({languagesOpenAt:s}),this.srcRecentLanguagesModel.setProperty({languagesOpenAt:s})):(this.dstLanguagesModel.setProperty({languagesOpenAt:s}),this.dstRecentLanguagesModel.setProperty({languagesOpenAt:s}));const n=t?r.LANG_METRIKAS.OPEN_SRC_SELECT:r.LANG_METRIKAS.OPEN_DST_SELECT;i.$tracker.sendMetric(n)}this.view.setType(e),"src"===e?this.view.setModel(this.srcLanguagesModel).setRecentLanguagesModel(this.srcRecentLanguagesModel):this.view.setModel(this.dstLanguagesModel).setRecentLanguagesModel(this.dstRecentLanguagesModel)}initInternal(){this.srcLanguagesModel=new o.LanguagesModel({languages:l.TranslateApplication.getAllSrcLangs(),currentLanguage:this.appModel.getProperty(r.LANG_PROPS.SRC_LANG),autodetectAllowed:!0,autodetect:this.appSettings.isAutodetectEnabled()},{filters:this.getSrcLangsModelFilters()}),this.srcLanguagesModel.onChange(r.LANG_PROPS.AUTODETECT,e=>this.appSettings.setAutodetectEnabled(e)).onSet(r.LANG_PROPS.CURRENT_LANG,e=>{this.app.setSrcLanguage(e,{sender:r.LANG_PROPS.SENDER_LANG_SELECT}),this.srcRecentLanguagesModel.setLanguage(e,{silent:!0}),this.closeView()}),this.srcRecentLanguagesModel=new a.RecentLanguagesModel({limit:this.appConfig.MAX_RECENT_LANGUAGES,languages:l.TranslateApplication.getAllSrcLangs(),currentLanguage:this.appModel.getProperty(r.LANG_PROPS.SRC_LANG)},{filters:this.getSrcLangsModelFilters()}),this.srcRecentLanguagesModel.setRecentLanguages(this.appSettings.getSrcLangHistory()),this.srcRecentLanguagesModel.onChange(r.LANG_PROPS.RECENT_LANGUAGES,()=>this.appSettings.setSrcLangHistory(this.srcRecentLanguagesModel.getRecentLanguages())).onChange(r.LANG_PROPS.CURRENT_LANG,e=>{this.app.setSrcLanguage(e,{sender:r.LANG_PROPS.SENDER_LANG_HISTORY}),this.closeView()}),this.dstLanguagesModel=new o.LanguagesModel({languages:l.TranslateApplication.getAllDstLangs(),currentLanguage:this.appModel.getProperty(r.LANG_PROPS.DST_LANG)}),this.dstLanguagesModel.onSet(r.LANG_PROPS.CURRENT_LANG,e=>{this.app.setDstLanguage(e,{sender:r.LANG_PROPS.SENDER_LANG_SELECT}),this.dstRecentLanguagesModel.setLanguage(e,{silent:!0}),this.closeView()}),this.dstRecentLanguagesModel=new a.RecentLanguagesModel({limit:this.appConfig.MAX_RECENT_LANGUAGES,languages:l.TranslateApplication.getAllDstLangs(),currentLanguage:this.appModel.getProperty(r.LANG_PROPS.DST_LANG)}),this.dstRecentLanguagesModel.setRecentLanguages(this.appSettings.getDstLangHistory()),this.dstRecentLanguagesModel.onChange(r.LANG_PROPS.RECENT_LANGUAGES,()=>this.appSettings.setDstLangHistory(this.dstRecentLanguagesModel.getRecentLanguages())).onChange(r.LANG_PROPS.CURRENT_LANG,e=>{this.app.setDstLanguage(e,{sender:r.LANG_PROPS.SENDER_LANG_HISTORY}),this.closeView()}),this.view.setModel(this.srcLanguagesModel).setRecentLanguagesModel(this.srcRecentLanguagesModel),this.appModel.onChange(r.LANG_PROPS.SRC_LANG,e=>{this.srcLanguagesModel.setLanguage(e),this.srcRecentLanguagesModel.setLanguage(e)}).onChange(r.LANG_PROPS.DST_LANG,e=>{this.dstLanguagesModel.setLanguage(e),this.dstRecentLanguagesModel.setLanguage(e)}).onSet("translation",e=>{e&&(this.srcRecentLanguagesModel.update(),this.dstRecentLanguagesModel.update())})}getSrcLangsModelFilters(){return{}}}t.AbstractLanguagesModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.LanguagesModel=void 0,s(1);var i=s(4),n=s(7);class r extends i.Model{getLanguages(e){const t=this.getProperty(n.LANG_PROPS.ALL_LANGUAGES);return e?this.findLanguages(t,e):t}getLanguageMatches(e){const t=Object.entries(this.getProperty(n.LANG_PROPS.ALL_LANGUAGES));if(!e)return t;const s=e.length,i=e.trim().toLowerCase(),r=t.reduce((e,[t,n])=>{const r=n.toLowerCase().indexOf(i),o=t.indexOf(i);if(r>=0){const i=[t,{name:n,start:r,size:s}];(0===r?e.goodMatches:e.otherMatches).push(i)}else if(o>=0){const s=[t,{name:n,start:0,size:0}];e.otherMatches.push(s)}return e},{goodMatches:[],otherMatches:[]});return[...r.goodMatches,...r.otherMatches]}getLanguageName(e){return this.getProperty(n.LANG_PROPS.ALL_LANGUAGES)[e]}findLanguages(e,t){const s=t.length,i=t.trim().toLowerCase();return Object.keys(e).reduce((t,n)=>{const r=e[n].toLowerCase().indexOf(i),o=n.indexOf(i);return r>=0?t[n]={code:n,name:e[n],start:r,size:s}:o>=0&&(t[n]={code:n,name:e[n],start:0,size:0}),t},{})}setLanguage(e){return this.setProperty(n.LANG_PROPS.CURRENT_LANG,e)}getCurrentLanguage(){return this.getProperty(n.LANG_PROPS.CURRENT_LANG)}setAutodetectEnabled(e){return this.setProperty(n.LANG_PROPS.AUTODETECT,e)}isAutodetectEnabled(){return this.getProperty(n.LANG_PROPS.AUTODETECT)}isAutodetectAllowed(){return this.getProperty("autodetectAllowed")}}t.LanguagesModel=r,r.defaults={currentLanguage:"",languages:{},autodetectAllowed:!1,autodetect:!1,languagesOpenAt:0}},function(e,t,s){"use strict";t.__esModule=!0,t.RecentLanguagesModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(4),o=s(7);class a extends r.Model{setRecentLanguages(e){return this.setProperty(o.LANG_PROPS.RECENT_LANGUAGES,n.default.safeStringifyJSON(e))}setLanguage(e,t){return this.setProperty(o.LANG_PROPS.CURRENT_LANG,e,t)}getLanguage(){return this.getProperty(o.LANG_PROPS.CURRENT_LANG)}getRecentLanguages(){return n.default.safeParseJSON(this.getProperty(o.LANG_PROPS.RECENT_LANGUAGES))}togglePin(e){const t=this.getRecentLanguages();return t.hasOwnProperty(e)&&(t[e]=!t[e],this.setRecentLanguages(t)),this}getLanguageName(e){return this.getProperty("languages")[e]}update(){let e=this.getProperty("limit");const t=this.getRecentLanguages(),s=this.getLanguage(),i={},n=[],r=[];if(t[s])return;if(Object.keys(t).forEach(function(e){t[e]?n.push(e):r.push(e)}),e-=n.length,e<=0)return;const o=r.indexOf(s);o>=0&&r.splice(o,1),r.unshift(s)>e&&(r.length=e),n.forEach(function(e){i[e]=!0}),r.forEach(function(e){i[e]=!1}),this.setRecentLanguages(i)}}t.RecentLanguagesModel=a,a.defaults={limit:20,language:"",languages:{},currentLanguage:"",languagesOpenAt:0}},function(e,t,s){"use strict";function i(e,t,s){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(s):r.value}})(e,t,s||e)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.__esModule=!0,t.LanguagesComponent=t.HIGHLIGHT_ATTR=void 0,s(1);var r,o=(r=s(0))&&r.__esModule?r:{default:r},a=s(11),l=s(111),c=s(112),d=s(117),u=s(44),h=s(121),p=s(123);t.HIGHLIGHT_ATTR="data-highlighted";class g extends c.AbstractLanguagesComponent{constructor(e,t){super(e,t),this.refs={container:"container"},this.onRendered(()=>{this.setProperty("elements",o.default.slice(this.getElement().querySelectorAll('[data-lang-element="true"]')))}).onStateChanged("hidden",e=>{e||this.resetHighlight()}),this.listenAppView()}listenAppView(){const{appView:e}=this.getProps();e.on("keydown",e=>{if(e.keyCode===a.InputView.keys.ESCAPE&&(this.reset(),this.setVisible(!1)),this.isVisible())switch(e.keyCode){case a.InputView.keys.UP:o.default.preventEvent(e),this.highlightPrev();break;case a.InputView.keys.DOWN:o.default.preventEvent(e),this.highlightNext();break;case a.InputView.keys.ENTER:let t=this.getHighlightedElement();t&&(o.default.preventEvent(e),this.onLanguageTapped(o.default.getAttribute(t,"data-value"),this.isSrc()))}}).on("keypress",e=>{e.which&&this.isVisible()&&!this.isInputFocused()&&(o.default.preventEvent(e),this.highlightByText(String.fromCharCode(e.which)))})}reset(){super.reset(),this.resetSearchQuery()}initChildComponents(){const{translatorElement:e,tags:t}=this.getProps();this.headerComponent=new d.LanguagesHeader({container:this._element}),this.autoSwitcherComponent=new u.AutoLangSwitcherComponent,this.recentLangsComponent=new h.RecentLanguagesComponent,this.allLangsComponent=new p.AllLanguagesComponent({translatorElement:e,tags:t,parentElement:this.getContainer(),renderRecentLangsColumn:()=>this.recentLangsComponent.getDirective()})}setModel(e){return super.setModel(e),this.headerComponent.setAutoDetectModel(e),this.recentLangsComponent.setAutoDetectModel(e),this}getElements(){return this.getProperty("elements")}getHighlightedElement(){return this.getElement().querySelector('[data-highlighted="true"]')}resetHighlight(){const e=this.getHighlightedElement();e&&e.setAttribute("data-highlighted","false")}isInputFocused(){return this.headerComponent.isInputFocused()}setInputFocus(){this.headerComponent.setInputFocus()}resetSearchQuery(){this.headerComponent.resetSearchQuery()}onLanguageTapped(e){this.allLangsComponent.onLanguageTapped(e)}highlightElement(){return l.ListboxViewKB.prototype.highlightElement.apply(this,arguments)}highlightPrev(){return l.ListboxViewKB.prototype.highlightPrev.apply(this)}highlightNext(){return l.ListboxViewKB.prototype.highlightNext.apply(this)}highlightByText(e){let t,s;const i=this.getElements();for(this._text+=e.toLowerCase(),t=0,s=i.length;t<s;t++)if(0===o.default.trim(i[t].textContent.toLowerCase()).indexOf(this._text)){this.highlightElement(i[t]);break}}onMouseOver(e){const t=o.default.getClosest(e.target,e=>e.hasAttribute("data-value"));this.highlightElement(t)}template({html:e,nothing:t,cn:s}){if(!this.model)return t;const i=s("langs");return e`
            ${this.headerComponent.getDirective()}
            <div
                data-ref-id="${this.refs.container}"
                class="${i("content",{improved:!0})}"
                @mouseover=${e=>this.onMouseOver(e)}
                @mouseleave=${e=>this.resetHighlight(e)}
            >
                ${this.allLangsComponent.getDirective()}
            </div>
        `}}t.LanguagesComponent=g,g.defaults={...i(n(g),"defaults",g),elements:[]}},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxViewKB=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(32),o=s(2);class a extends r.ListboxView{constructor(e={}){super(e),this._elements=[],this.resetText(),this.resetText=n.default.debounce(this.resetText,e.textResetDelay||1e3),this.on("contentChanged",function(){this._elements=this.getContentElement("["+r.ListboxView.VALUE_ATTR+"]",!0)}).on(o.TouchView.eventTypes.OVER,function(e){const t=this.getClosest(e.target,function(e){return e.hasAttribute(r.ListboxView.VALUE_ATTR)},!0);this.highlightElement(t)}).bindDOMEvents(o.TouchView.eventTypes.OVER)}resetText(){return this._text="",this}getElements(){return n.default.slice(this._elements)}highlightPrev(){const e=this.getElements();let t=e.indexOf(this.getHighlightedElement())-1;return t<0&&(t=e.length-1),this.highlightElement(e[t])}highlightNext(){const e=this.getElements(),t=(e.indexOf(this.getHighlightedElement())+1)%e.length;return this.highlightElement(e[t])}highlightByText(e){let t,s;const i=this.getElements();for(this._text+=e.toLowerCase(),t=0,s=i.length;t<s;t++)if(0===i[t].textContent.toLowerCase().indexOf(this._text)){this.highlightElement(i[t]);break}return this.resetText()}highlightByValue(e){let t,s;const i=this.getElements();for(t=0,s=i.length;t<s;t++)if(i[t].getAttribute(r.ListboxView.VALUE_ATTR)===e){this.highlightElement(i[t]);break}return this}highlightElement(e){const t=this.getHighlightedElement();return t&&t.removeAttribute(a.HIGHLIGHT_ATTR),e&&e.setAttribute(a.HIGHLIGHT_ATTR,!0),this}getHighlightedElement(){return this.getContentElement("["+a.HIGHLIGHT_ATTR+"]")}}t.ListboxViewKB=a,a.HIGHLIGHT_ATTR="data-highlighted"},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractLanguagesComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(16),o=s(6),a=s(3),l=s(7);class c extends o.Component{initChildComponents(){}sendTypingMetric(e){a.$tracker.sendMetric(l.LANG_METRIKAS.SEARCH_TEXT_TYPE,{text:e,type:this.getType()})}constructor(e,t){super(e,t);const s=n.default.debounce(e=>this.sendTypingMetric(e),500);this.initChildComponents(),this.id="LanguagesComponent",this.headerComponent.on(l.COMPONENT_EVENTS.EVENT_INPUT,({value:e})=>{this.allLangsComponent.setProperty("searchQuery",e),this.recentLangsComponent.setProperty("searchQuery",e),this.setProperty("stateSearch",Boolean(e)).updateAsync(),e&&s(e)}),this.allLangsComponent.on(l.COMPONENT_EVENTS.EVENT_LANG_CHOOSE,({langCode:e,searchQuery:t})=>{const s=this.isSrc()?l.LANG_METRIKAS.SELECT_SRC_LANG:l.LANG_METRIKAS.SELECT_DST_LANG;a.$tracker.sendMetric(s,{recent:0,fromSearch:t?1:0,duration:Date.now()-this.model.getProperty("languagesOpenAt"),lang:e}),this.reset()})}isSrc(){return"src"===this.getProperty("type")}getId(){return this.id}reset(){this.setProperty("stateSearch",!1).setProperty("searchQuery",""),this.headerComponent.reset(),this.allLangsComponent.reset(),this.recentLangsComponent.reset()}setModel(e){return this.model=e,this.autoSwitcherComponent.setModel(e),this.allLangsComponent.setModel(e),this}setType(e){return this.recentLangsComponent.setType(e),this.setProperty({type:e})}getType(){return this.getProperty("type")}setRecentLanguagesModel(e){return this.recentModel=e,this.recentLangsComponent.setModel(e),this}getComponentName(){return"LanguagesComponent"}shouldToggleVisibility(e){return e===n.default.hasClass(this._element,r.STATE_PREFIX+r.VIEW_STATES.HIDDEN)}template(){}}t.AbstractLanguagesComponent=c,c.defaults={stateSearch:!1,type:""}},function(){},function(){},function(e,t,s){"use strict";e.exports=s(116)},function(e,t,s){"use strict";function i(e){function t(t,n,r,o){var a=n?s+t+e.e+n:s+t,l=a;if(r){var c=" "+l+e.m;for(var d in r)if(r.hasOwnProperty(d)){var u=r[d];!0===u?l+=c+d:u&&(l+=c+d+i+u)}}if(void 0!==o)for(var h=0,p=o.length;h<p;h++){var g=o[h];if(g&&"string"==typeof g.valueOf())for(var E=g.valueOf().split(" "),_=0;_<E.length;_++){var T=E[_];T!==a&&(l+=" "+T)}}return l}var s=e.n||"",i=e.v||e.m;return function(e,s){return function(i,n,r){return"string"==typeof i?Array.isArray(n)?t(e,i,void 0,n):t(e,i,n,r):t(e,s,i,n)}}}Object.defineProperty(t,"__esModule",{value:!0});var n=i({e:"-",m:"_"});t.cn=n,t.withNaming=i},function(e,t,s){"use strict";t.__esModule=!0,t.LanguagesHeader=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(118),o=(s(26),s(44));class a extends r.AbstractLanguagesHeader{constructor(e,t){super(e,t),this.debouncedSearchTextHandler=n.default.debounce(this.onSearchTextChanged,100),this.autoLangSwitcher=new o.AutoLangSwitcherComponent({})}setAutoDetectModel(e){this.autoLangSwitcher&&this.autoLangSwitcher.setModel(e)}setInputFocus(){const e=this.getRef(this.refs.searchInput);e&&e.focus()}isInputFocused(){const e=this.getRef(this.refs.searchInput);return e&&document.activeElement===e}resetSearchQuery(){const e=this.getRef(this.refs.searchInput);e&&(e.value="")}template(){return!1}}t.LanguagesHeader=a},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractLanguagesHeader=void 0;var i=s(6),n=s(7);class r extends i.Component{constructor(e,t){super(e,t),this.refs={searchInput:"searchInput"},this.container=e.container}reset(){}onSearchTextChanged(e){this.emit(n.COMPONENT_EVENTS.EVENT_INPUT,{value:e.value.trim()})}getRef(e){return this.container?this.container.querySelector(`[data-ref-id="${e}"]`):null}getComponentName(){return"LanguagesHeader"}template(){}}t.AbstractLanguagesHeader=r,r.defaults={searchIsActive:!1,title:""}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractAutoLangSwitcherComponent=void 0;var i=s(3),n=s(6),r=s(120),o=s(7);class a extends n.Component{constructor(e,t){super(e,t),this.switcher=new r.SwitchToggler({active:!1,toggleOnTap:!1})}setModel(e){return this.model=e,this.switcher.toggle(e.isAutodetectEnabled()),this}onClick(){}trackAutodetectToggle(e){i.$tracker.sendMetric(o.LANG_METRIKAS.TOGGLE_AUTODETECT,{enabled:e?1:0})}getComponentName(){return"AutoLangSwitcherComponent"}template(){}}t.AbstractAutoLangSwitcherComponent=a,a.defaults={active:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.SwitchToggler=void 0;var i=s(6);class n extends i.Component{constructor(e,t){super(e,t),this.onToggle(this.update),this.update()}onToggle(e){return this.onChange("active",e)}toggle(e=!this.isActive()){return this.setProperty({active:e})}isActive(){return this.getProperty("active")}template(){return!1}}t.SwitchToggler=n,n.defaults={active:!1,toggleOnTap:!0}},function(e,t,s){"use strict";t.__esModule=!0,t.RecentLanguagesComponent=void 0,s(1);var i=s(122),n=(s(15),s(44));class r extends i.AbstractRecentLanguagesComponent{constructor(e,t){super(e,t),this.autoLangSwitcher=new n.AutoLangSwitcherComponent({})}setAutoDetectModel(e){this.autoLangSwitcher.setModel(e)}template(){return!1}}t.RecentLanguagesComponent=r,r.defaults={type:"src"}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractRecentLanguagesComponent=void 0;var i=s(6),n=s(3),r=s(7);class o extends i.Component{setModel(e){return this.model=e,this}reset(){this.setProperty("searchQuery","")}onRecentLanguageClick(e){this.model.setLanguage(e);const t=this.isSrc()?r.LANG_METRIKAS.SELECT_SRC_LANG:r.LANG_METRIKAS.SELECT_DST_LANG;n.$tracker.sendMetric(t,{recent:1,fromSearch:0,duration:Date.now()-this.model.getProperty("languagesOpenAt"),lang:e})}isSrc(){return"src"===this.getProperty("type")}isDst(){return"dst"===this.getProperty("type")}setType(e){return this.setProperty({type:e})}getComponentName(){return"RecentLanguagesComponent"}template(){}}t.AbstractRecentLanguagesComponent=o,o.defaults={searchQuery:""}},function(e,t,s){"use strict";t.__esModule=!0,t.AllLanguagesComponent=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(124);s(15),s(26);class o extends r.AbstractAllLanguagesComponent{getColsAmount(){const e=this.getProperty("translatorElement").clientWidth;switch(!0){case e<400:return 1;case e<600:return 2;case e<800:return 3;case e<1e3:return 4;case e<1200:return 5;default:return 6}}wrapName(){return!1}renderLang(){return!1}onLangClick(e){const t=n.default.getClosest(e.target,e=>e.hasAttribute("data-value"));if(!t)return;const{value:s,langElement:i,isRecentLang:r}=t.dataset;"true"===i&&"true"!==r&&this.onLanguageTapped(s)}template(){return!1}}t.AllLanguagesComponent=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractAllLanguagesComponent=void 0;var i=s(6),n=s(7);class r extends i.Component{setModel(e){return this.model=e,this}reset(){this.setProperty("searchQuery",null)}onLanguageTapped(e){const{searchQuery:t}=this.getProps();this.emit(n.COMPONENT_EVENTS.EVENT_LANG_CHOOSE,{langCode:e,searchQuery:t}),this.model.setLanguage(e)}getComponentName(){return"AllLanguagesComponent"}template(){}}t.AbstractAllLanguagesComponent=r,r.defaults={searchQuery:null}},function(e,t,s){"use strict";t.__esModule=!0,t.UserMenuModule=void 0,s(1),(i=s(0))&&i.__esModule,s(19);var i,n=s(5),r=(s(11),s(2),s(3),s(69),s(15),s(126),s(30));s(127),Object.keys(r.locales.themeLabels);class o extends n.AppModule{}t.UserMenuModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.SettingOptions=void 0;var i=s(25);class n extends i.PureComponent{constructor(e,t){super(e,t),this.refs={option:"option"},this.onChange(()=>this.updateAsync()),this.update()}getOptionRef(e){return this.getRef(`${this.refs.option} ${e}`)}template(){return!1}}t.SettingOptions=n},function(e,t,s){"use strict";t.__esModule=!0,t.CheatSheet=void 0,s(1);var i=s(6);class n extends i.Component{constructor(e,t){super(e,t),this.updateAsync()}getHotKeys(){const{hotkeys:e}=this.getProps();return Object.entries(e||{}).sort(([e],[t])=>t>e?-1:1)}template(){return!1}}t.CheatSheet=n},function(e,t,s){"use strict";t.__esModule=!0,t.AccessibilityModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(10),a=s(2),l=s(11),c=s(23);class d extends r.AppModule{constructor(e,t){super(e,t),this.hoveredElement=null,this.focusedView=!1,this.listenAppView(),this.listenGlobalEmitter(),this.listenDocument()}isFocusedView(e){return this.focusedView&&this.focusedView.getContentElement()===e}isElementHovered(e){return this.hoveredElement&&n.default.getClosest(this.hoveredElement,t=>t===e)}showElementTooltip(e){const t=n.default.getDataAttr(e,"tooltip")||n.default.getDataAttr(e,"tooltip-focus");t&&this.appModel.setProperty("tooltip",t,{rect:e.getBoundingClientRect(),position:n.default.getDataAttr(e,"tooltip-position")})}hideTooltip(){this.appModel.setProperty("tooltip",null)}listenAppView(){this.appView.on("keydown",e=>{const t=document.activeElement,s=t.getAttribute("data-action"),i="true"===t.getAttribute("data-default-enter-action"),r=t.getAttribute("data-enter-action");t&&"textarea"!==t.tagName.toLowerCase()&&"pre"!==t.tagName.toLowerCase()&&!n.default.hasClass(t,"state-disabled")&&(e.keyCode===l.InputView.keys.ENTER?(s&&this.app.emit("action:"+s,{},{originalEvent:e}),this.app.emit(c.A11Y_EVENTS.ACTIVATION,e.target,e),i?t.click():r&&this.app.emit(r,t,{originalEvent:e}),e.preventDefault()):e.keyCode===l.InputView.keys.SPACE&&n.default.hasClass(t,"button_select")&&this.app.emit(c.A11Y_EVENTS.SELECT_ACTIVATION,e.target,e))})}listenGlobalEmitter(){(0,o.getGlobalEmitter)().on("viewFocusChanged",(e,t)=>{t?this.focusedView=e:e===this.focusedView&&(this.focusedView=null)})}listenDocument(){document.addEventListener(a.TouchView.eventTypes.OVER,e=>{this.hoveredElement=e.target}),document.addEventListener("focus",e=>{this.isElementHovered(e.target)||this.isFocusedView(e.target)||(n.default.toggleClass(e.target,"state-tab-focused"),this.showElementTooltip(e.target))},!0),document.addEventListener("blur",e=>{n.default.hasClass(e.target,"state-tab-focused")&&(n.default.toggleClass(e.target,"state-tab-focused"),this.hideTooltip())},!0)}}t.AccessibilityModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.LangSwitcherModule=void 0;var i=s(5),n=s(2);class r extends i.AppModule{constructor(e,t){super(e,t);const s=new n.TouchView({element:this.appConfig.ELEMENTS.langSwitcherButton,activateFocus:!0}),i=new n.TouchView({element:this.appConfig.ELEMENTS.langSwitcherListbox,stopDefaultAction:!0});s.onTap(()=>{s.setFocus(!0),i.setVisible()}).onStateChanged("focused",e=>{e||i.setVisible(!1)})}}t.LangSwitcherModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.getLogErrorCode=t.MAX_LOG_RESPONSE_TEXT_LENGTH=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i};t.MAX_LOG_RESPONSE_TEXT_LENGTH=100,t.getLogErrorCode=(({response:e,error:t})=>n.default.isEmpty(t)?n.default.isEmpty(e)?null:e.code:t.code)},function(e,t,s){"use strict";t.__esModule=!0,t.TooltipModule=void 0;var i=s(5),n=s(132);class r extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="tooltip",this.tooltipView=new n.TooltipView({element:this.appConfig.ELEMENTS.tooltip,targetView:this.appView,timeout:400,areHotkeysEnabled:()=>this.app.areHotkeysEnabled()}),this.appModel.onSet("tooltip",(e,t)=>{this.tooltipView.setTooltip(e,t)})}}t.TooltipModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.TooltipView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2);class o extends r.TouchView{constructor(e={}){super(e);const t=this;let s;this.clearTimeout=(()=>(s&&clearTimeout(s),this));const i=s=>{const i=parseInt(s.getAttribute("data-tooltip-vetrical-margin"))||0,n=s.getAttribute("data-hotkey"),r=s.getAttribute("data-tooltip"),o=-1===s.className.indexOf("state-invalid")&&-1===s.className.indexOf("state-disabled"),a=e.areHotkeysEnabled(),l=o&&n&&a?`${r} (${n})`:r;t.setTooltip(l,{rect:s.getBoundingClientRect(),position:s.getAttribute("data-tooltip-position"),verticalMargin:i})};return e.targetView instanceof r.TouchView&&e.targetView.on(r.TouchView.eventTypes.OUT,function(){t.clearTimeout(),t.setVisible(!1)}).on(r.TouchView.eventTypes.OVER,function(t){const n=this.getClosest(t.target,function(e){return e.hasAttribute("data-tooltip")});n&&(s=setTimeout(()=>{i(n)},e.timeout||400))}).on(r.TouchView.eventTypes.START,function(e){this.getClosest(e.target,function(e){return e.hasAttribute("data-tooltip-nohide")})||(t.clearTimeout(),t.setVisible(!1))}).onTap(e=>{const t=n.default.getClosest(e.target,function(e){return e.hasAttribute("data-tooltip-onclick")});t&&i(t)}).bindDOMEvents([r.TouchView.eventTypes.OUT,r.TouchView.eventTypes.OVER]),this.on("contentChanged",this.updatePosition),this}setTooltip(e,t={}){if(!e)return this.setVisible(!1);if(this.setVisible(!0).setTextContent(e),t.rect){const e={top:t.rect.top,bottom:t.rect.bottom,right:t.rect.right,left:t.rect.left,width:t.rect.width,height:t.rect.height};t.verticalMargin&&(e.top-=t.verticalMargin,e.bottom-=t.verticalMargin),this.setPosition(e,t.position)}else t.targetElement?this.clearTimeout().setPositionByElement(t.targetElement):t.view&&this.clearTimeout().setPositionByElement(t.view.getElement());return this}setPositionByElement(e){return this.setPosition(e.getBoundingClientRect(),e.getAttribute("data-tooltip-position"))}setPosition(e,t){return this._rect=e,this._position=t,this.updatePosition()}updatePosition(){let e,t;const s=this._rect,i=this._position||"bottom";if(!s)return this;const n=this.getElement(),r=this.getRect();switch(i){case"top":case"bottom":e="top"===i?s.top-r.height:s.bottom,t=s.left-(r.width-s.width)/2;break;case"left":case"right":e=s.top-(r.height-s.height)/2,t="left"===i?s.left-r.width:s.right;break;case"top-right":e=s.top-r.height,t=s.left}return n.style.top=e+"px",n.style.left=t+"px",n.setAttribute("data-position",i),this}}t.TooltipView=o},function(e,t,s){"use strict";t.__esModule=!0,t.SessionStorage=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(4);class o extends r.Model{constructor(e,t){super(e,t),this.on("change",function(e,t){try{sessionStorage.setItem(e,n.default.safeStringifyJSON(t))}catch(e){if(e.name===o.QUOTA_EXCEEDED_ERROR)return void this.emit("quotaError",e)}this.emit("fileStored")})}removeItem(e){sessionStorage.removeItem(e)}getItem(e){if(sessionStorage.getItem(e))return n.default.safeParseJSON(sessionStorage.getItem(e))}}t.SessionStorage=o,o.QUOTA_EXCEEDED_ERROR="QuotaExceededError"},function(e,t,s){"use strict";t.__esModule=!0,t.DEFINITION_TYPES=t.DEFINITION_METRIKAS=t.DEFINITION_EVENTS=void 0,t.DEFINITION_METRIKAS={},t.DEFINITION_EVENTS={DEF_FETCHED:"def_fetched"},t.DEFINITION_TYPES={}},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxPresenter=void 0;var i=s(20);class n extends i.Presenter{constructor(e={}){super(e);const t=this,s=this.getView(),i=this.getModel();s.on("itemSelected",e=>{this.setValue(e);const t=this.getValue();this.emit("itemSelected",this.getValue()),this.emit("itemChanged",e,Array.isArray(t)?t.includes(e):e)});const n=(i={})=>{let n=this.getItems();if(e.renderOnScroll){const t=e.renderBulkSize*this.currentBulksLimit;n=n.slice(0,t)}i.appendingOnScroll?(n=n.slice(-e.renderBulkSize),s.renderData(t.prepareData(n),{...i,append:!0})):s.renderData(t.prepareData(n),i)};i.on("change",function(i,r,o){switch(i){case"value":case"items":let a;const l=this.getItems();e.renderOnScroll&&(t.currentBulksLimit=1,t.totalBulks=Math.ceil(l.length/e.renderBulkSize)),"items"===i?(s.setState("empty",this.isEmpty(l)),a="itemsChanged"):"value"===i&&(a="valueChanged"),n(o),s.setEnabled(!0),t.emit(a,r,o.oldValue)}}),this.on("updateView",function(e){n(e)}),e.renderOnScroll&&this._trackScrollRender()}_trackScrollRender(){this.getView().on("scroll",()=>{const e=this.getView().getElement();e.scrollTop>e.scrollHeight-2*e.offsetHeight&&this.currentBulksLimit<this.totalBulks&&(this.currentBulksLimit+=1,this.emit("updateView",{appendingOnScroll:!0}))})}getItems(){return this.getModel().getItems()}setItems(e,t){return this.getModel().setItems(e,t),this}getValue(){return this.getModel().getProperty("value")}setValue(e,t){const s=this.getModel();return s.isValid("value",e)&&s.setProperty("value",e,t),this}getItemById(e){return this.getItems().find(function(t){return t.id===e})}}t.ListboxPresenter=n,n.currentBulksLimit=1,n.totalBulks=1},function(e,t,s){"use strict";t.__esModule=!0,t.TTSPlayer=t.PLAYER_STATES=t.PLAYER_PRIORITIES=t.PLAYER_ACTIONS=void 0;var i=s(9);t.PLAYER_ACTIONS={LOAD:"load",PLAY:"play",STOP:"stop",ERROR:"error",UPDATE:"update"},t.PLAYER_STATES={OK:"ok",TEXT_NOT_SUPPORTED:"textNotSupported",LANG_NOT_SUPPORTED:"langNotSupported",TEXT_SIZE_EXCEEDED:"textSizeExceeded"},t.PLAYER_PRIORITIES={LOW:1,NORMAL:10,HIGH:100};class n extends i.Emitter{play(){}stop(){}isActive(){}isLangSupported(){}isTextSupported(){}isTextSizeBelowLimit(){}getPriority(){}isValid(e,t,s){this.isTextSupported(e)&&this.isTextSizeBelowLimit(e)?this.isLangSupported(t,function(e){s(e)}):s(!1)}}t.TTSPlayer=n},function(e,t,s){"use strict";t.__esModule=!0,t.EXAMPLE_METRIKAS=t.EXAMPLES_EVENTS=void 0,t.EXAMPLE_METRIKAS={TAB_WORD_CLICK:"example_tab_word_click",HIGHLIGHTED_CLICK:"example_link_click",EXAMPLES_RENDERED:"examples_rendered",EXPAND_EXAMPLES:"examples_show_more",EXAMPLE_SCROLL_CONTROL_CLICK:"example_scroll_control_click",EXAMPLE_REF_CLICK:"example_ref_click"},t.EXAMPLES_EVENTS={WORD_SELECTED:"wordSelected",SHOW_TAB:"showTab",SET_MAIN_VIEW_STATE:"setMainViewState",SEND_METRIC:"metric",OPEN_IDIOM_POPUP:"openIdiomPopup",BANNED_EXAMPLES_UPDATED:"bannedExamplesUpdated",SHOW_TOOLTIP:"showExampleTooltip",SHOW_EXAMPLE_SHEET:"showExampleSheet"}},function(e,t,s){"use strict";t.__esModule=!0,t.MAX_NON_EXPANDED_DECLENSIONS_LENGTH=t.DECLENSIONS_METRIKAS=t.DECLENSIONS_EVENTS=void 0,t.DECLENSIONS_EVENTS={DECLENSIONS_FETCHED:"declensionsFetched",WORD_CLICK:"declensionClick"},t.DECLENSIONS_METRIKAS={RENDER:"declensions_render",CLICK:"declensions_click",COMPLAINT_SEND:"declensions_complaint_send",EXPAND:"declensions_expand",TAB_CLICK:"declensions_tab_click",LIST_SCROLL:"declensions_list_scroll"},t.MAX_NON_EXPANDED_DECLENSIONS_LENGTH=3},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(8),o=s(130),a=s(43),l=s(29),c=s(17),d=s(151);const u=window.config||{};let h=u.TRANSLATION?u.TRANSLATION_COUNTER:0;class p extends a.SessionModel{constructor(e,t={}){super(e,t),this.resetCache(),this._cacheEnabled=Boolean(t.cacheEnabled)}reset(){return this._activeRequest&&(this._activeRequest.abort(),this._activeRequest=null),this}getData(){return{text:this.getText(),options:this.getProperty("options")}}getText(){const e=this.getProperty("text");return e?JSON.parse(e):[]}setText(e,t){return this.setProperty("text",e&&JSON.stringify(e),t)}getTranslationId(){return[this.getProps().sid,h-1,0].join("-")}saveLastTranslationId(e){return this.setProperty({translationId:e})}getLastTranslationId(){return this.getProperty("translationId")}getParams(){const e=this.getProps();return{id:this.getTranslationId(),srv:e.srv,source_lang:e.srcLang,target_lang:e.dstLang,reason:e.reason,format:e.format}}resetCache(){return this._cache={},this}getDefaults(){return{srv:"",url:"/",text:"",format:p.formats.TEXT,reason:"",options:0,srcLang:"",dstLang:"",translation:"",shouldNotRequest:!1,sid:this.getId()}}_getCacheKey(e){return[this.getProperty("srcLang"),this.getProperty("dstLang"),e].join("-")}_getFromCache(e){return this._cache[this._getCacheKey(e)]||""}getCounter(){return h}increaseCounter(){return h+=1,h}validateResponse(e){return e&&n.default.isObject(e.body)&&n.default.isArray(e.body.text)&&e.body.text.length&&e.body.text.every(e=>e.length)}runRequest(){let e;const t=this.getData();this.increaseCounter(),this.saveLastTranslationId(this.getTranslationId());const s=this.getParams(),i=new c.HTTPRequest(this.getProperty("url"));if(this.emit("query",n.default.extend({},t,s)),this._cacheEnabled&&(e=t.text,t.text=e.filter(e=>!this._getFromCache(e)),!t.text.length))return this.setProperty("translation",e.map(this._getFromCache,this).join("\n"));this._activeRequest=i.setType(c.HTTPRequest.types.FORM).setData(t).setParams(s).setMethod(c.HTTPRequest.methods.POST).send((s,i)=>{const n=(0,o.getLogErrorCode)({response:i,error:s}),a=s&&c.HTTPRequest.isAbortedCode(s.code),u=i&&c.HTTPRequest.isSuccessCode(i.code);let h;if(this._activeRequest=null,u&&!a&&!this.validateResponse(i)){const{srcLang:e,dstLang:t,srv:s}=this.getProps(),n=i.text?i.text.slice(0,o.MAX_LOG_RESPONSE_TEXT_LENGTH):null;(0,r.logError)(new d.UnexpectedTranslationApiResponse(e,t,s),{additional:{responseText:n}})}if(u&&(h=i.body.text,this._cacheEnabled&&(t.text.forEach((e,t)=>{this._cache[this._getCacheKey(e)]=h[t]}),h=e.map(this._getFromCache,this)),this.setProperty("translation",h.join("\n"),{align:i.body.align&&i.body.align[0]})),!u&&!a){const{srcLang:e,dstLang:t,srv:o}=this.getProps();return(0,r.logError)(new d.TranslateApiError(n,e,t,o)),this.emit("error",s||new l.HTTPError(n,i.body.message))}})}requestTranslation(){return this.reset(),this.isValid()?(this.emit("request"),this.getSid().then(()=>this.runRequest()),this):this}onRequest(e){return this.on("request",e)}}t.TranslatorModel=p,p.options={ALIGN:4},p.formats={TEXT:"text",HTML:"html"},p.errorMap={INVALID_SESSION:405,EXPIRED_SESSION:406}},function(e,t,s){"use strict";t.__esModule=!0,t.InputPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(20);class o extends r.Presenter{constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();s.on("input",function(e){i.setProperty("value",this.getValue(),e.detail)}),i.on("change:value",function(e,i){s.setState("empty",!e),t.emit("input",e,i)})}getValue(e={}){let t=this.getModel().getProperty("value");return t=t.slice(e.start,e.end),e.trim?n.default.trim(t):t}setValue(e,t){return this.getView().setValue(e,t),this}getCaret(){return this.getView().getSelection().end}setCaret(e){return e===this.getCaret()&&this.getView().isFocused()?this:(this.getView().setSelection({start:e}),this.emit("navigate",e))}}t.InputPresenter=o},function(e,t,s){"use strict";t.__esModule=!0,t.AVAILABLE_OPTIONS=void 0,t.AVAILABLE_OPTIONS={AUTOCORRECT:"autocorrect",ENTER:"enter",SHIFT:"shift"}},function(e,t,s){"use strict";function i(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return s}function n(){return this.emit(u.ACTIVATING)}function r(){return this.emit(u.MIC_DISABLED)}function o(){return this.emit(u.MIC_ENABLED)}t.__esModule=!0,t.SpeechRecognizerBase=t.RECOGNITION_PRIORITIES=t.RECOGNITION_EVENTS=t.RECOGNITION_ERRORS=void 0,s(1);var a,l=(a=s(0))&&a.__esModule?a:{default:a},c=s(9);const d={LOW:1,NORMAL:10,HIGH:100};t.RECOGNITION_PRIORITIES=d,t.RECOGNITION_ERRORS={ABORTED:"aborted",NETWORK:"network",NOT_ALLOWED:"not-allowed",NO_SPEECH:"no-speech"};const u={END:"end",ACTIVATING:"activating",MIC_DISABLED:"mic-disabled",MIC_ENABLED:"mic-enabled",START:"start",RECOGNIZE:"recognize"};t.RECOGNITION_EVENTS=u;const h="prompt",p="granted",g="denied";var E=new WeakSet,_=new WeakSet,T=new WeakSet;class m extends c.Emitter{static isAvailable(){}constructor(){super(),T.add(this),_.add(this),E.add(this),this.audioPermissionStatus=h,this.permissionsSupported=!1,this.permissionsSupported="permissions"in navigator,this.permissionsSupported&&navigator.permissions.query({name:"microphone"}).then(e=>{this.audioPermissionStatus=e.state,e.state===g&&i(this,_,r).call(this),e.onchange=l.default.debounce(e=>{const t=e.target.state;this.audioPermissionStatus=t,t===p?i(this,T,o).call(this):t===g&&i(this,_,r).call(this)})}).catch(e=>{e instanceof TypeError&&(this.permissionsSupported=!1)})}convertLanguage(){}prepareData(){}getVisualizer(){}startRecognition(e){}startListening(e){return this.audioPermissionStatus===h&&this.permissionsSupported&&i(this,E,n).call(this),this.startRecognition(e),this}getPriority(){return d.NORMAL}}t.SpeechRecognizerBase=m},function(e,t,s){"use strict";t.__esModule=!0,t.STORY_MOVE_TYPES=t.STORY_FEEDBACK_TYPES=t.STORY_CLOSE_TYPES=void 0,t.STORY_MOVE_TYPES={TIME:"time",STORY_TAP:"story_tap",ARROW_TAP:"arrow_tap",KEYBOARD:"keyboard"},t.STORY_CLOSE_TYPES={END:"end",BUTTON_TAP:"button_tap",ACTIVATION:"story_activation",ESC:"esc",BG_TAP:"bg_tap",HISTORY_BACK:"history_back",SWIPE:"swipe"},t.STORY_FEEDBACK_TYPES={LIKE:"like",DISLIKE:"dislike"}},function(e,t,s){"use strict";t.__esModule=!0,t.FileDropModule=t.APP_EVENTS=void 0,s(19);var i=s(5),n=s(2),r=s(133),o=s(145);const a={DOC_DROPPED:"documentDropped",IMAGE_DROPPED:"imageDropped"};t.APP_EVENTS=a;class l extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="fileDrop",this.mainContainer=new n.TouchView({element:document.documentElement}),this.storage=new r.SessionStorage,this.dropOverlay=new o.DropAreaView({element:this.appConfig.ELEMENTS.dropOverlay,contentElement:this.appConfig.ELEMENTS.dropContent,hideAfterTransition:!0}),this.app._dropAreaView=this.dropOverlay,this.listenMainContainer(),this.listenStorage(),this.listenDropOverlay()}handleFileUpload(e){return!1}listenMainContainer(){return!1}listenStorage(){return!1}listenDropOverlay(){return!1}}t.FileDropModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.SUPPORTED_DOCS=t.DropAreaView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2);const o=/pdf|doc|docx|xls|xlsx|ppt|ppts|pptx/i;t.SUPPORTED_DOCS=o;class a extends r.TouchView{static getFileFormat(e){return!1}constructor(e){super(e);const{DROP:t,DRAG_ENTER:s,DRAG_OVER:i,DRAG_LEAVE:r}=a.EVENT_NAMES;this.on(t,e=>this._handleDropEvent(e)).on(s,e=>this._handleDragEnterEvent(e)).on(i,e=>n.default.preventEvent(e)).on(r,e=>this._handleDragLeaveEvent(e)).bindDOMEvents(`${t} ${s} ${i} ${r}`);let o=null;this.onVisibilityChanged(e=>{clearTimeout(o),e&&(o=setTimeout(()=>{this.setVisible(!1)},a.OVERLAY_CHECK_TIMEOUT))})}handleFileUpload(e,t){return!1}_handleFileUpload(e,t=null){return!1}_validateFileFormat(e){return!1}_updateContentElement(e){return!1}_handleDropEvent(e){return!1}_handleDragEnterEvent(e){return!1}_handleDragLeaveEvent(e){return!1}}t.DropAreaView=a,a.ACTION_ATTRIBUTE="action",a.MAX_FILE_SIZE=5242880,a.OVERLAY_CHECK_TIMEOUT=3e3,a.EVENT_NAMES={SIZE_ERROR:"sizeError",FORMAT_ERROR:"formatError",FILE_DROPPED:"fileDropped",DROP:"drop",DRAG_OVER:"dragover",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave"},a.FILE_FORMAT={IMAGE:"image",DOCUMENT:"doc",INVALID:"invalid"},a.ACTIONS={OCR:"/ocr",DOC:"/doc"}},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionServerModel=t.COLLECTION_TYPES=t.COLLECTION_STATUSES=t.COLLECTION_ACTIONS=void 0;var i=s(72),n=s(17);const r={FAVORITES:0,COLLECTION:1,SUBSCRIPTION:2,BROKEN_SUBSCRIPTION:3,HISTORY:4};t.COLLECTION_TYPES=r,t.COLLECTION_ACTIONS={NOP:0,ADD:1,DELETE:2,UPDATE:3,REGISTER:4,DROP:5,POSTPONE:6,MERGE:7};const o={UNCHANGED:0,ADDED:1,DELETED:2,UPDATED:3,ABSENT:4};t.COLLECTION_STATUSES=o;class a extends i.ListboxModel{static getTimestamp(){return Date.now()/1e3}static isNotDeleted(e){return e&&e.status!==o.DELETED}static isSubscription(e){return e&&(e.type===r.SUBSCRIPTION||e.type===r.BROKEN_SUBSCRIPTION)}getDefaults(){return{srv:"",uid:"",url:"/",items:"",value:"",xtoken:""}}getParams(){const{srv:e,uid:t}=this.getProps();return{srv:e,uid:t}}_getCollection(e){const{url:t}=this.getProps();return new n.HTTPRequest(t+"collections/"+e).setMethod(n.HTTPRequest.methods.GET).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("collectionData",t.body.collection)}),this}_subscribe(e){const{url:t,uid:s}=this.getProps();return new n.HTTPRequest(t+"users/"+s+"/collections").setData(e).setType(n.HTTPRequest.types.JSON).setMethod(n.HTTPRequest.methods.POST).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("subscribed",t.body.collection)}),this}_syncCollection(e,t){const{url:s,uid:i}=this.getProps();new n.HTTPRequest(s+"users/"+i+"/collections/"+e+"/sync").setData(t).setType(n.HTTPRequest.types.JSON).setMethod(n.HTTPRequest.methods.POST).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("mergeCollection",t.body.collectionAction)})}_presyncCollections(e){const{url:t,uid:s}=this.getProps();return new n.HTTPRequest(t+"users/"+s+"/collections/pre-sync").setData(e).setType(n.HTTPRequest.types.JSON).setMethod(n.HTTPRequest.methods.POST).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("processCollections",t.body.collectionsActions)}),this}_getCollections(){const{url:e}=this.getProps();return new n.HTTPRequest(e+"collections").setMethod(n.HTTPRequest.methods.GET).setHeader("X-CSRF-Token",this.getProperty("xtoken")).setParams(this.getParams()).send((e,t)=>{if(e)return this.emit("error",e);this.emit("collections",t.body.collections)}),this}}t.CollectionServerModel=a},function(e,t,s){"use strict";t.__esModule=!0,t.RELATED_WORDS_METRIKAS=t.RELATED_WORDS_EVENTS=t.DEFAULT_ITEMS_AMOUNT=void 0,t.RELATED_WORDS_EVENTS={WORDS_FETCHED:"RELATED_WORDS_FETCHED",WORD_CLICK:"RELATED_WORDS_CLICK"},t.DEFAULT_ITEMS_AMOUNT=10,t.RELATED_WORDS_METRIKAS={RENDER:"related_words_render",WORDS_CLICK:"related_words_click",WORDS_EXPAND:"related_words_expand",WORDS_COMPLAINT_SEND:"related_words_complaint_send"}},function(e,t,s){"use strict";t.__esModule=!0,t.MIN_IDIOMS_HEIGHT=t.IDIOMS_TEXT_OFFSET=t.IDIOMS_METRIKAS=t.IDIOMS_EVENTS=t.IDIOMS_ACTIONS=t.AbstractIdiomsModule=void 0,(i=s(0))&&i.__esModule;var i,n=s(3),r=s(5);s(210);const o={};t.IDIOMS_EVENTS=o;const a={};t.IDIOMS_ACTIONS=a;const l={};t.IDIOMS_METRIKAS=l;const{$track:c}=(0,n.getTrackerByNamespace)(l);t.IDIOMS_TEXT_OFFSET=20,t.MIN_IDIOMS_HEIGHT=20;class d extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="idioms",this.idiomsComponent=this._makeIdiomsComponent(),this.idiomsPopup=this._makeIdiomsPopup(),this.model=this._makeIdiomsModel(),this.listenApp(),this.listenIdiomsComponent(),this.listenDictionaryModel(),this.appModel.onChange(["text","srcLang","dstLang"],()=>{const{text:e,srcLang:t,dstLang:s}=this.appModel.getProps();this.handlePropsChange({text:e,srcLang:t,dstLang:s})}),this.appView.on("tap",e=>{this.isIdiomNode(e)||this.closePopup(!0)})}reset(){return!1}listenDictionaryModel(){return!1}
listenApp(){return!1}listenIdiomsComponent(){return!1}isIdiomNode(e){return!1}closePopup(){return!1}handlePropsChange(e){return!1}_makeIdiomsModel(){return!1}_sendMetric(e){return!1}_handlePopupVisibility(e,t){return!1}_updatePopupPosition(){return!1}}t.AbstractIdiomsModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.DICTIONARY_METRIKAS=t.DICTIONARY_EVENTS=void 0,t.DICTIONARY_METRIKAS={EXPAND_DICTIONARY:"dict_show_more",DICT_LINK_CLICK:"dict_link_click",DICT_RENDERED:"dict_show"},t.DICTIONARY_EVENTS={SEND_METRIC:"metric",APPLY_ITEM:"applyItem",DICT_FETCHED:"dictFetched"}},function(e,t,s){"use strict";t.__esModule=!0,t.PredictorPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(20);class o extends r.Presenter{static createRange(e,t){const s={};if(t.pos<0)s.end=t.index,s.start=s.end+t.pos;else{if(t.index!==e.length||" "!==e.charAt(t.index-1))return null;s.end=t.index,s.start=t.index}return s}constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();let r;const a=function(){s.setVisible(!1).setEnabled(!1)};this.detectLanguage=n.default.debounce(o.prototype.detectLanguage,200),this.requestSuggestion=n.default.debounce(o.prototype.requestSuggestion,200),s.on("tap",n.default.preventEvent).on("itemSelected",function(e){e&&t.setValue(e)}),i.on("set",function(e,i,n){let o;switch(e){case"items":return i?(o=this.toJSON(),o.items=this.getItems()||[],s.renderData(t.prepareData(o.items)).setEnabled(!0).setVisible(!0),t.emit("ready",o)):a();case"value":return o=this.toJSON(),o.items=this.getItems()||[],t.emit("predict",o,n);case"endOfWord":clearTimeout(r),i?t.emit("endOfWord"):r=setTimeout(()=>t.emit("endOfWord"),1500)}}).on("error",a).on("change",function(e,i,n){switch(e){case"auto":return t.detectLanguage(),t.emit("auto",i);case"text":case"limit":case"srcLang":return s.setEnabled(!1),n.reason&&this.setProperty("reason",n.reason),"text"===e&&t.detectLanguage(),"srcLang"===e&&n.detected&&t.emit("detect",i,n.kbd),t.requestSuggestion()}}).on("invalid",a)}isAuto(){return this.getModel().getProperty("auto")}setText(e,t){return this.getModel().setProperty("text",e,{reason:t}),this}setIndex(e){return this.getModel().setProperty("index",e),this}setValue(e,t){return this.getModel().setProperty("value",e,t),this}toggleAuto(e){return this.getModel().setProperty("auto",arguments.length?Boolean(e):!this.isAuto()),this}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}detectLanguage(){return this.isAuto()&&this.getModel().detectLanguage(),this}requestSuggestion(){return this.getModel().requestSuggestion(),this}}t.PredictorPresenter=o,o.detectOptions={KBD:1}},function(e,t,s){"use strict";t.__esModule=!0,t.UnexpectedTranslationApiResponse=t.TranslateApiError=void 0;class i extends Error{constructor(e,t,s,i){super(),this.message=`TranslateApiError [${t}-${s}] status=${e} srv=${i}`}}t.TranslateApiError=i;class n extends Error{constructor(e,t,s){super(),this.message=`UnexpectedTranslationApiResponse [${e}-${t}] srv=${s}`}}t.UnexpectedTranslationApiResponse=n},function(e,t,s){"use strict";t.__esModule=!0,t.InputModel=void 0;var i=s(4);class n extends i.Model{getDefaults(){return{caret:0,value:""}}}t.InputModel=n},function(e,t,s){"use strict";function i(e){const t=document.getElementById("sc"+e);return t?t.cloneNode(!0):null}t.__esModule=!0,t.StoryCard=t.STORY_GLOBAL_EVENTS=t.STORY_CARD_VIEWS=t.MAX_COLOR_TYPES=t.MAX_CARD_TYPES=void 0,t.getStoryBgElement=i;var n,r=(n=s(0))&&n.__esModule?n:{default:n},o=(s(30),s(10),s(25));s(3),s(143),s(15);const a={STORY:"story",PREVIEW_BIG:"preview-big",PREVIEW_SMALL:"preview-small"};t.STORY_CARD_VIEWS=a;const l={RUN_ACTION:"storyRunAction"};t.STORY_GLOBAL_EVENTS=l,r.default.memoize(r.default.hasEmojiOnly.bind(r.default)),t.MAX_CARD_TYPES=8,t.MAX_COLOR_TYPES=10;class c extends o.PureComponent{constructor(e,t){super(e,t),this.refs={bg:"bg"},this.onChange(()=>this.updateAsync()),this.update()}getBgElement(){return!1}handleStoryAction(e){return!1}handleStoryFeedback(e,t){return!1}controlsTemplate(e,t,s){return!1}previewControlsTemplate(e,t){return!1}template(){return!1}}t.StoryCard=c,c.defaults={story:null,feedbackStatus:null}},function(e,t,s){"use strict";t.__esModule=!0,t.SPELLER_EVENTS=t.CHUNK_SHOW_TIMEOUT=void 0,t.SPELLER_EVENTS={TOGGLE_AUTO_CORRECTION:"toggleSpeller",CORRECT_TEXT:"correctText",CHUNK_SELECTED:"spellerChunkSelected",CORRECTED_TEXT_READY:"correctedTextReady",DECLINE_CORRECTION:"declineSpellerCorrection",SAVE_WORD:"saveUserWordToSave"},t.CHUNK_SHOW_TIMEOUT=2e3},,function(e,t,s){"use strict";function i(e){const[t,s]=e.urlController.getPathArray();return t===l.VIEW_IDS.COLLECTIONS?s?{view:t,collectionId:s}:t:null}function n(e){return{trText:e.trText||"",srcLang:e.srcLang||"",dstLang:e.dstLang||""}}t.__esModule=!0,t.Router=t.ROUTER_EVENTS=t.MAX_SHARE_TEXT_LENGTH=t.HISTORY_MOVES=void 0,s(1);var r,o=(r=s(0))&&r.__esModule?r:{default:r},a=s(4),l=s(203),c=s(169);const d={NAVIGATED_FROM_URL:"navigatedFromURL",HISTORY_MOVE:"historyMove",HISTORY_UPDATED:"historyUpdated",MODEL_UPDATED:"modelUpdated",VIEW_ID_UPDATED:"viewIdUpdated"};t.ROUTER_EVENTS=d;const u="currentRoute",h="push",p="replace",g={BACK:"back",FORWARD:"forward"};t.HISTORY_MOVES=g;const E=2,_=["client","force_ui","ui","v","test-id","exp_flags"];t.MAX_SHARE_TEXT_LENGTH=1e3;class T extends a.Model{constructor(e,t){var s;super(e,t),this.historyObject=window.history,this.documentObject=window.document,this.urlController=new l.UrlController(window.location),function(e){const t={method:p,state:{index:0,queryParams:{},viewId:i(e)},enforced:!0},s=_,n=e.getRouteWithQueryString();if(function(e){return o.default.isEmpty(e.currentState)}(e)){const i=e.getQueryParams();i.text&&(t.state.trText=i.text),i.srcLang&&(t.state.srcLang=i.srcLang),i.dstLang&&(t.state.dstLang=i.dstLang);for(let e,n=0,r=s.length;n<r;n+=1)e=s[n],i[e]&&(t.state.queryParams[e]=i[e]);e.updateHistory(n,t)}}(this),s=this,window.addEventListener("popstate",({state:e})=>{if(!e)return;const t=s.getHistoryState(),i=function(e,t){const s=e.getHistoryState(),i={currentState:t,previousState:s};return t.index>s.index?(i.direction=g.FORWARD,i.step=t.index-s.index):(i.direction=g.BACK,i.step=s.index-t.index),i}(s,e),n=s.urlController.getRoute();i.direction===g.BACK&&i.step>0&&o.default.isArray(s.minorViews)&&s.minorViews.forEach(e=>s.emit("closeMinorView",e)),t.action!==e.action&&(t.action&&s.emit("cancelAction",t.action),e.action&&s.emit("activateAction",e.action)),s.emit(d.HISTORY_MOVE,i),s.currentState=e,s.emit(d.MODEL_UPDATED,function(e){const t={};return t.text=e.trText||"",e.srcLang&&(t.srcLang=e.srcLang),e.dstLang&&(t.dstLang=e.dstLang),t}(e)).emit(d.VIEW_ID_UPDATED,e.viewId,t.viewId).setProperty(u,n)})}navigateInitialRoute(){const e=this.urlController.getRoute();this.emit(d.NAVIGATED_FROM_URL,{route:e,pathArray:this.urlController.getPathArray(e)}),this.setProperty({isLoaded:!0})}updateTranslationState(e){const t=this.urlController.getRouteFromTranslationProps(e),s=n(this.getHistoryState()),i=n(e),r=!o.default.isEqualDeep(s,i),a=t.slice(0,1e3);r&&this.updateHistory(a,{state:i})}updateHistory(e,t={}){return!1}updateCurrentState(e={}){const t=this.urlController.getRoute(),s={...this.getHistoryState(),...e};s.route=this.urlController.addQueryParamsToPathname(t,s);try{this.historyObject.replaceState(s,void 0,s.route)}catch(e){console.error(e)}this.currentState=s}removeQueryParams(e){const t=this.urlController.getRoute(),s=this.urlController.getQueryParams(!1),i=this.getHistoryState();e.forEach(e=>delete s[e]),i.route=`${t}${this.urlController.buildQueryString(s)}`;try{this.historyObject.replaceState(i,void 0,i.route)}catch(e){console.error(e)}}createEmptyHistoryStep(){this.updateHistory(this.urlController.getRouteWithQueryString(),{enforced:!0})}pushHistoryState(e={},t={}){return!1}pushMinorView(e){this.minorViews.push(e)}excludeMinorView(e){this.minorViews=this.minorViews.filter(t=>t!==e)}getRouteFromState(e){return e?this.getHistoryState().route:"/"}getCollectionId(){return this.urlController.getCollectionId()}back(){this.historyObject.back()}getHistoryState(){return!1}getCurrentViewId(){return this.getHistoryState().viewId}getRouteWithQueryString(){return this.urlController.getRouteWithQueryString()}getQueryParams(e=!0){return this.urlController.getQueryParams(e)}getQueryParam(e){return this.getQueryParams()[e]}getRefPageParam(){return this.getQueryParam("ref_page")}openCollection(e,t={}){const s=e.type===E,i=e.public&&Boolean(e.serverId),n=new c.RouteBuilder(l.VIEW_IDS.COLLECTIONS);s||i?n.append(e.serverId):t.isTop&&n.append(e.id),setTimeout(()=>this.openCollectionsInternal(n.build(),e,t),0)}openCollectionsInternal(e,t,s){const i=this.getHistoryState();let n=!1;if(o.default.isObject(i.viewId)){const e=i.viewId.collectionId===t.id,r=i.viewId.isTop&&i.viewId.collectionId,o=i.action===s.action;if(n=!i.viewId.isTop&&t.sourceCollectionId===i.viewId.collectionId,(!r||e)&&o)return}const r={route:e,action:s.action,viewId:{view:l.VIEW_IDS.COLLECTIONS,collectionId:t.id,isTop:s.isTop}},a=n?p:h,c={method:s.method||a};this.pushHistoryState(r,c)}closeCollection(e={}){this.pushHistoryState({route:new c.RouteBuilder(l.VIEW_IDS.COLLECTIONS).build(),viewId:l.VIEW_IDS.COLLECTIONS},e)}isCurrentRoute(e){return this.urlController.isCurrentRoute(e)}getEventNames(){return d}isVisibleRoute(e){return-1!==l.ACTIVE_VIEWS.indexOf(e)}getRouteFromViewName(e){return this.urlController.getRouteFromViewName(e)}}t.Router=T,T.minorViews=[]},function(e,t,s){"use strict";t.__esModule=!0,t.EXAMPLES_OPTIONS=t.DictionaryExamplesModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(171),o=s(172);t.EXAMPLES_OPTIONS={DEBUG:1,CHUNKS:2,LIGHTWEIGHT:4,RANDOM_RANKING:8,LEARNING:16,MONOLING:32,STACKOVERFLOW:64,SITES:128};class a extends r.DictionaryModel{constructor(...e){super(...e),this.label="queryCorpus"}getParams(){const e=this.getProps();return{...super.getParams(),src:e.text,dst:e.translation,options:e.options,chunks:e.chunks?1:0,maxlen:e.maxLength,v:2}}getDefaults(){return{ui:"",srv:"",url:"/",src:"",text:"",data:"",lang:"",flags:0,options:0,chunks:!1,maxLength:0,voteResults:"",expandedLists:"",speakersSupport:""}}hasOption(e){return(this.getProperty("options")&e)===e}setOption(e,t){let s=this.getProperty("options");return Boolean(t)===this.hasOption(e)||(s+=e*(t?1:-1),this.setProperty("options",s)),this}isValidResponse(e){const t=n.default.safeParseJSON(e);return(0,o.validateServerResponse)(t)}prepareExamples(e){const t=n.default.safeParseJSON(e),s=(0,o.transformServerExamples)(t),{allExamples:i}=s;return i.length&&this.emit("examplesRendered"),s}setVoteResult(e,t){const s=this.getVoteResults();s[e]=t,this.setVoteResults(s)}getVoteResults(){const e=this.getProperty("voteResults");return e?JSON.parse(e):{}}setVoteResults(e){this.setProperty("voteResults",JSON.stringify(e))}setSpeakerSupport(e,t,s){const i=this.getSpeakersSupport();i[e]={srcValid:t,dstValid:s},this.setSpeakersSupport(i)}setSpeakersSupport(e){this.setProperty("speakersSupport",JSON.stringify(e))}getSpeakersSupport(){const e=this.getProperty("speakersSupport");return e?JSON.parse(e):{}}setExpandedList(e,t){const s=this.getExpandedLists();s[e]=t,this.setExpandedLists(s)}getExpandedLists(){const e=this.getProperty("expandedLists");return e?JSON.parse(e):{}}setExpandedLists(e){this.setProperty("expandedLists",JSON.stringify(e))}}t.DictionaryExamplesModel=a},function(e,t,s){"use strict";t.__esModule=!0,t.ToastPresenter=void 0;var i=s(20);class n extends i.Presenter{constructor(e){super(e);const t=this.getView(),s=this.getModel();t.on("tap",function(){s.resetTimer(),this.setVisible(!1)}),s.on("timedout",function(){t.setVisible(!1)}).on("set:text",function(e,s){if(!e)return this.resetTimer(),t.setVisible(!1);this.resetTimer(),t.setTextContent(e).setVisible(!0),this.setTimeout(s.delay)})}showToast(e,t){return this.getModel().setProperty("text",e,{delay:t}),this}}t.ToastPresenter=n},function(e,t,s){"use strict";t.__esModule=!0,t.ToastModel=void 0;var i=s(4);class n extends i.Model{resetTimer(){return clearTimeout(this.getProperty("timer")),this}_onTimeout(){return this.emit("timedout")}setTimeout(e){return this.setProperty("timer",setTimeout(this._onTimeout.bind(this),e||this.getProperty("delay")))}getDefaults(){return{text:"",timer:0,delay:2e3}}}t.ToastModel=n},function(e,t,s){"use strict";function i(){return r.default.iOS?"ios":r.default.android?"android":"windows"}t.__esModule=!0,t.Uniproxy=t.STREAM_CONTROL_REASONS=t.STREAM_CONTROL_ACTIONS=t.EVENTS=t.ERRORS=t.CONNECTION_STATUSES=t.CLOSING_CODES=void 0;var n,r=(n=s(0))&&n.__esModule?n:{default:n},o=s(9);const a={OPEN:"open",CONNECTING:"connecting",CLOSE:"close",ERROR:"error",RECONNECT:"reconnect",MESSAGE:"message",STREAM:"stream",STREAM_CONTROL:"stream_control",READY:"ready",STOP:"stop",STATUS_CHANGED:"status_changed"};t.EVENTS=a;const l={CONNECTING:"connecting",OPEN:"open",CLOSING:"closing",CLOSED:"closed",STOPPED:"stopped"};t.CONNECTION_STATUSES=l;const c={NORMAL:1e3,OFFLINE:4001,CONNECTING_TIMEOUT:4002,HEARTBEAT_TIMEOUT:4003,CONNECTION_DIED:4004,STOP:4005,UNAUTHORIZED:4006,NOT_INTERNAL_NETWORK:4007};t.CLOSING_CODES=c;const d={REQUEST_TIMEOUT_ERROR:"request_timeout",SYNC_STATE_ERROR:"sync_state",EVENT_ERROR:"event_error",CONNECTION_ERROR:"connection",UNSUPPORTED_PACKET:"unsupported_packet",RATE_LIMIT_ERROR:"rate_limit",RESPONSE_ERROR:"response"};t.ERRORS=d;const u={CLOSE:0,CHUNK:64};t.STREAM_CONTROL_ACTIONS=u;const h={NO_ERROR:0,PROTOCOL_ERROR:1,INTERNAL_ERROR:2,FLOW_CONTROL_ERROR:3,SETTINGS_TIMEOUT:4,STREAM_CLOSED:5,FRAME_SIZE_ERROR:6,REFUSED_STREAM:7,CANCEL:8,COMPRESSION_ERROR:9,CONNECT_ERROR:10,ENHANCE_YOUR_CALM:11,INADEQUATE_SECURITY:12,HTTP_1_1_REQUIRED:13};t.STREAM_CONTROL_REASONS=h;const p="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";class g extends o.Emitter{constructor(e){super(),this._nextStreamId=-1,this._status=l.STOPPED,this._requests={},this._ws=null,this._seqNumber=1,this._apiKey=e.apiKey,this._url=e.url,this._uuid=r.default.guid(p),this._vins={application:{lang:window.config.UI_LANG,platform:i(),uuid:this._uuid,app_id:"ru.yandex.translate."+("tr-text"===window.config.SRV?"desktop":"touch")}}}startStream(){return this._nextStreamId+=2,this._nextStreamId}closeStream(e,t,s=h.NO_ERROR){return this._sendRaw({streamcontrol:{action:u.CLOSE,streamId:e,reason:s,messageId:t}})}start(){this._ws=new WebSocket(this._url),this._ws.binaryType="arraybuffer",this._ws.onclose=this._handleClose.bind(this),this._ws.onerror=this._handleError.bind(this),this._ws.onmessage=this._handleMessage.bind(this),this._ws.onopen=this._handleOpen.bind(this),this.emit(a.CONNECTING),this.setStatus(l.CONNECTING)}stop(){this.ensureClose(c.NORMAL),this.setStatus(l.STOPPED)}isConnected(){return this._ws&&this._status===l.OPEN}ensureConnection(e){this._ws&&this._status!==l.STOPPED||this.start(),this._status===l.CONNECTING?this.once(a.OPEN,e):this.isConnected()&&e()}sendRequest(e,t,s={},i=(()=>{}),n=(()=>{}),r=1e4){const o=this.sendEvent(e,t,s),a="SynchronizeState"===t;if(!o)return navigator.onLine&&this._throwError(d.CONNECTION_ERROR,{namespace:e,name:t}),n(d.CONNECTION_ERROR);const l=window.setTimeout(()=>{a||(this._processRequest(o,d.REQUEST_TIMEOUT_ERROR),this._throwError(d.REQUEST_TIMEOUT_ERROR,{messageId:o}))},r);return this._requests[o]=((e,t)=>{window.clearTimeout(l),e?(navigator.onLine&&this._throwError(e,{messageId:o}),n(e)):t&&i(t.payload),delete this._requests[o]}),o}sendEvent(e,t,s={}){const{streamId:i}=s,n=r.default.guid(p),o={header:{namespace:e,name:t,messageId:n,streamId:i,seqNumber:this._seqNumber},payload:s};if(this._sendRaw({event:o}))return this._seqNumber++,n}_sendRaw(e){if(!this._ws||this._ws.readyState!==WebSocket.OPEN)return!1;try{return this._ws.send(e instanceof Blob?e:JSON.stringify(e)),!0}catch(e){return!1}}sendStreamData(e,t,s=null){const i=new ArrayBuffer(4);return new DataView(i).setUint32(0,e),this._sendRaw(new Blob([i,t],{type:s}))}setStatus(e){this._status=e,this.emit(a.STATUS_CHANGED,e)}ensureClose(e=c.NORMAL,t=null){if(this._ws){this._ws.onclose=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onopen=null;try{this._ws.readyState<WebSocket.CLOSING&&this._ws.close(e)}finally{this._ws=null,this.emit(a.CLOSE,{reason:t}),this.setStatus(l.CLOSED)}}}_processRequest(e,t,s){const i=e&&this._requests[e];i&&i.call(this,t,s)}_sendSyncState(){try{this.sendRequest("System","SynchronizeState",{uuid:this._uuid,auth_token:this._apiKey,vins:this._vins})}catch(e){this._throwError(e.message,e)}}_handleOpen(){this._sendSyncState(),this.setStatus(l.OPEN),this.emit(a.OPEN)}_handleClose(e){const t=window.navigator.onLine?e.code:c.OFFLINE;this.ensureClose(t,e.reason)}_handleError(){this._throwError(d.CONNECTION_ERROR)}_handleMessage({data:e}){if(e){if(e instanceof ArrayBuffer)return this._receiveStream(e);try{const t=JSON.parse(e);return t?t.hasOwnProperty("streamcontrol")?this._receiveStreamControl(t.streamcontrol):t.hasOwnProperty("directive")?this._handleDirective(t.directive):this._throwError(d.UNSUPPORTED_PACKET):this._throwError(d.UNSUPPORTED_PACKET)}catch(e){return this._throwError(d.UNSUPPORTED_PACKET,e)}}}_handleDirective(e){switch(`${e.header.namespace}:${e.header.name}`){case"System:EventException":case"System:InvalidAuth":this._receiveException(e);break;default:this._receiveMessage(e)}}_receiveStream(e){const t=new DataView(e);this.emit(a.STREAM,{streamId:t.getUint32(0),data:t.buffer.slice(4)})}_receiveStreamControl(e){this.emit(a.STREAM_CONTROL,{data:e})}_receiveException(e){const{header:t,payload:s}=e,i=function(e){return e&&e.Response?e.Response.RateLimit?d.RATE_LIMIT_ERROR:d.RESPONSE_ERROR:d.EVENT_ERROR}(s);this._processRequest(t.refMessageId,i,e),this._throwError(i,{header:t,payload:s})}_receiveMessage(e){const{header:t}=e;this._processRequest(t.refMessageId,void 0,e),this.emit(a.MESSAGE,{data:e})}_throwError(e,t={}){this.emit(a.ERROR,{error:e,data:t})}}t.Uniproxy=g},function(e,t,s){"use strict";t.__esModule=!0,t.initTextArea=t.TEXTAREA_APP_EVENTS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(11),o=s(2),a=(s(3),s(46)),l=s(141);const c={FOCUS:"textFocus",BLUR:"textBlur",TAP:"textTap",KEYDOWN:"textKeydown",PASTE:"textPaste",CLEAR:"textDelete"};t.TEXTAREA_APP_EVENTS=c;const d=40,u=250;t.initTextArea=function(e){const t=this,s=e.USE_FAKEAREA&&r.InputView.fakeAreaSupported,i=this.getView(),h=this.getSettings(),p=this.getTextareaPresenter(),g=p.getView(),E=this.getModel();E.setProperty("isFakeTextArea",s);const _=new o.TouchView({element:e.ELEMENTS.clearButton}),T=new o.TouchView({element:e.ELEMENTS.sourceTranslit}),m=n.default.debounce(()=>{setTimeout(()=>{const e=g.getSelection();if(e.start===e.end)return;e.trim=!0;const t=p.getValue(e);t&&E.setProperty("selText",t)},10)}),f=n.default.debounce(()=>{this.updateTrText("type-end")},1500);let S;T.onTap(e=>{e.preventDefault(),e.stopImmediatePropagation()});const C=()=>{document.execCommand("insertHTML",!1,"\n"),this.emit("input")};this.on("pageReady",function(){const t=e.DEFAULT_TEXT||"";window.location.pathname!==e.COLLECTIONS_PATHNAME&&g.setFocus(!0),g.getValue()&&g.getValue()!==p.getValue()&&g.setValue(""),g.setValue(t,{caret:t.length,sender:"url"})}).on("keyboardOpen",function(){g.setFocus(!0)}).on("refreshAlertShow",function(){e.IS_SEARCH_BOT||(g.setFocus(!1),i.setState("expired",!0).on("keydown",function(e){n.default.preventEvent(e),e.keyCode===r.InputView.keys.ENTER&&t.reload()}))}).on("visibilityChange",function(e){e||t.reloadIfSessionExpired()}).onAction("swapDirection",()=>{const e=E.getProperty("text"),t=E.getProperty("translation");t&&(E.setProperty("translation",e,{sender:"translator"}),E.setProperty("text",t,{sender:"translator"}))}).onAction("expiredRefresh",()=>{this.reload()}).onAction("applyText",e=>{const t={sender:n.default.getDataAttr(e,"sender")},s=n.default.getDataAttr(e,"text"),i=n.default.getDataAttr(e,"translation"),r=n.default.getDataAttr(e,"src-lang"),o=n.default.getDataAttr(e,"dst-lang"),a=n.default.getDataAttr(e,"swap-dir");s&&E.setProperty("text",s,t),i&&E.setProperty("translation",i,t),r&&E.setProperty("srcLang",r,t),o&&E.setProperty("dstLang",o,t),a&&this.swapDirection()}).addHotKey(a.HOT_KEYS_MAP.FOCUS_INPUT,{condition:()=>!g.hasState("focused"),callback:()=>p.setCaret(E.getProperty("text").length),getActionName:()=>"focus_input"}).addHotKey(a.HOT_KEYS_MAP.CLEAR_INPUT,{view:_,getActionName:()=>"clear_input"}).bindFocusActivation(_),i.onStateChanged("longtext",function(){g.getContentElement().value=String(g.getContentElement().value)}).onStateChanged("editing",function(e){e&&g.setFocus(!1)}).setState("faked",s),g.on("tap",function(e){t.emit(c.TAP,p.getCaret(),e),i.setState("listening",!1)}).on("scroll",function(e){if(e.target!==this.getContentElement())return;const t=this.getScrollInfo();E.setProperty("textScrollY",100/t.maxTop*t.top,{userScroll:this.userScroll}),this.userScroll=!0}).on(o.TOUCH_VIEW_EVENTS.SELECT,e=>m(e)).on("mouseup",e=>{if(-1===n.default.get(e,"target.className","").indexOf("translit")&&!n.default.getClosest(e.target,e=>"button"===e.getAttribute("role"))){if(!g.getContentElement().contains(e.target)){const e=g.getValue().length;g.setSelection({start:e,end:e})}m()}}).on("keydown",function(e){t.emit(c.KEYDOWN,e)}).on("keydown",e=>!1).on("enterPressed",()=>{h.isOptionEnabled(l.AVAILABLE_OPTIONS.ENTER)&&!this.getPredictorPresenter().getView().isEnabled()&&C()}).onStateChanged("empty",e=>{i.setState("empty",e)}).onStateChanged("focused",e=>{t.emit(c.FOCUS,e),e?i.setState("collapsed",!1):t.updateTrText()}).on("focus",()=>{g.setState({focused:!0})}).on("blur",()=>{g.setState({focused:!1}),this.emit(c.BLUR),S=p.getCaret()}).bindDOMEvents("scroll",!0).bindDOMEvents("blur",!0).bindDOMEvents("focus",!0).bindDOMEvents("paste select keydown enterPressed mouseup"),E.setFilter("selText",function(e){let s=e,i=this.getProperty("spellerData");if(!i)return s;try{i=JSON.parse(i)}catch(e){return s}return n.default.isArray(i)&&i.forEach(function(e){e.s&&e.s.length&&s===e.word&&(t.hasSpellerSavedWord(e.word)||(s=e.s[0]))}),s}),i.on("stateChanged:collapsed",function(e){e&&g.setFocus(!1)}),p.on("input",function(e,s){e.length-s.oldValue.length>1&&!s.sender&&t.emit(c.PASTE,e,s.oldValue),s.caret=s.caret||this.getCaret(),t.setText(e,s),f()});const A=(e={})=>{("langHistory"===e.sender||"langSelect"===e.sender)&&(p.setCaret(S),g.setFocus(!0))};return E.on("change",function(s,i,r){switch(s){case"text":this.setProperty("timestamp",Date.now());const s=i.length;if(g.setFocus(!0),"synonyms"===r.sender){const e=g.getSelection();if(e.start!==e.end){const t=r.oldValue.slice(e.start,e.end);e.start+=t.search(/\S/),e.end-=t.length-t.search(/\s*$/),n.default.extend(r,e),r.caret=e.start+s}}p.setValue(i,r),r.caret&&p.setCaret(r.caret);const o=g.getScrollInfo();this.setProperty("textScrollY",100/o.maxTop*o.top),_.setEnabled(i);break;case"trText":this.setProperty("selText","",{silent:!0});break;case"srcLang":A(r),g.setLanguage(i),T.setState("chinese","zh"===i);break;case"dstLang":A(r);break;case"timestamp":i-r.oldValue>e.SESSION_RESUME_TIME&&t.emit("sessionResumed",i-r.oldValue);break;case"sourceTranslit":T.setTextContent(i||""),t.emit("containerHeightChanged");break;case"translationScrollY":r.userScroll&&g.scrollTo(g.getScrollInfo().maxTop/100*i)}}),E.onChange("text",e=>{const t=e.length,s=t<=d,n=t>d&&t<=u,r=t>u;i.setState({size0:s,size1:n,size2:r})}).on("translationViewScrollY",e=>{g.scrollTo(e)}).on("moveTextAreaCaret",e=>{p.setCaret(e)}),_.on("tap",()=>{this.emit(c.CLEAR),E.setProperty("text","",{sender:"clearButton"}),t.toggleTranslatorExpandState(!1)}),h.hasProperty("savedText")&&(e.DEFAULT_TEXT=h.getProperty("savedText"),h.setProperty("savedText",null)),g.setValue(""),this}},function(e,t,s){"use strict";t.__esModule=!0,t.CARDS_CAROUSEL_EVENTS=t.AbstractCardsCarousel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=(s(30),s(6)),o=s(3);s(153);const a={APPLY_PHRASE:"applyPhrase",APPLY_ACTIVE_PHRASE:"applyActivePhrase",OPEN_STORY:"openStory"};t.CARDS_CAROUSEL_EVENTS=a;class l extends r.Component{constructor(e,t){super(e,t),this.refs={carousel:"carousel"};const{stories:s=[]}=e;s.length&&(n.default.toggleClass(this.getContainer(),"theme-night"),this.patchPhraseThemes(),this.onceRendered(()=>{o.$tracker.sendMetric("stories_rendered",{stories:s.map(({id:e})=>e).join(",")})})),this.update()}patchPhraseThemes(){return!1}getCardsCount(){return!1}applyPhrase(e){return!1}openStory(e){return!1}getPhraseBg(e){return!1}getStoryPreview(e){return!1}itemsTemplate(){return!1}}t.AbstractCardsCarousel=l,l.defaults={activeCard:0,phrases:[],stories:[]}},function(e,t,s){"use strict";function i(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,r(e,t,"get"))}function n(e,t,s){return function(e,t,s){if(t.set)t.set.call(e,s);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=s}}(e,r(e,t,"set"),s),s}function r(e,t,s){if(!t.has(e))throw new TypeError("attempted to "+s+" private field on non-instance");return t.get(e)}t.__esModule=!0,t.Tooltip=void 0,s(1);var o,a=(o=s(0))&&o.__esModule?o:{default:o},l=s(2),c=s(25),d=new WeakMap,u=new WeakSet;class h extends c.PureComponent{constructor(e,t={}){let s;t.container?s=t.container:(s=document.createElement("div"),document.body.append(s)),t.container=s,super(e,t),u.add(this),this.refs={root:this.getId()},d.set(this,{writable:!0,value:null}),this.onChange(["content","position"],()=>this.update()),["scroll","resize"].forEach(e=>{a.default.bind(window,e,()=>{!this.getProperty("hidden")&&this.rootElement&&(this.getProperty("sticky")?this.update():this.hide())})}),a.default.bind(document.body,l.TouchView.eventTypes.START,e=>{this.rootElement&&(a.default.getClosest(e.target,e=>e===this.rootElement)||this.hide())}),this.getProperty("sticky")&&(n(this,d,new IntersectionObserver(e=>{e.forEach(e=>{!this.getProperty("hidden")&&e.intersectionRatio<.75&&this.hide()})})),this.onChange("target",(e,{oldValue:t})=>{t&&i(this,d).unobserve(t),this.update()}))}show(e){return!1}hide(){return!1}update(e){return!1}handleMouseLeave(){return!1}content(){return this.getProperty("content")}template({html:e,cn:t}){return!1}}t.Tooltip=h,h.defaults={content:"",position:"left",target:null,promo:!1,hidden:!0,sticky:!1,shouldAutoHide:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.synTitles=t.i18n=t.TABS=t.EXAMPLE_TABS=void 0;const i=window.config||{},n=i.LOCALIZATIONS||{};t.i18n=n;const r=i.TABS||{};t.TABS=r;const o=i.SYN_TITLES||{};t.synTitles=o;const a=i.EXAMPLE_TABS||{};t.EXAMPLE_TABS=a},,,function(e,t,s){"use strict";t.__esModule=!0,t.Database=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(9),o=s(200);class a extends r.Emitter{static isSupported(){try{return"indexedDB"in window&&window.indexedDB}catch(e){return!1}}constructor(e){if(super(),!e||!e.name)throw new Error("Can't open the base with no name");if(!e.version||!n.default.isNumber(e.version))throw new Error("Unsupported base version");this._name=e.name,this._trace=[],this._active=!1,this._version=e.version,this._keyGenerator=new o.KeyGenerator}open(){return!1}tryReconnect(){return!1}safeTransaction(e,t){return!1}waitReconnect(e){return!1}addTrace(e){return!1}getTrace(){return!1}generateKey(){return!1}isActive(){return!1}createDatabase(){return!1}upgradeDatabase(){return!1}}t.Database=a},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(201),o=s(146);class a extends o.CollectionServerModel{static getRandomColor(){return this.COLORS[Math.floor(Math.random()*this.COLORS.length)]}static generateColorRules(e,t){const s=this.COLOR_CSSRULE;try{this.COLORS.forEach(function(e){i.insertRule(n.default.parseString(s,t,e),i.cssRules.length?i.cssRules.length:0)})}catch(e){}}constructor(e,t){super(e,t);const s=this,i=new r.CollectionDatabase({name:r.CollectionDatabase.DATABASE_NAME,version:r.CollectionDatabase.DATABASE_VERSION},{migrateParams:{defaultFavName:t.defaultFavName,defaultHistoryName:t.defaultHistoryName}});this._database=i,i.on("upgradeneeded",function(){s.emit("upgradeneeded")}).on("ready",function(){s.emit("dbReady")}).on("close",function(){s.emit("dbClosed")}).on("synced",function(){this.getCollections(),this.getRecordsByCollection(s.getProperty("activeId")),s.emit("synced")}).on("checked",function(e){s.emit("checked",e)}).on("added",function(e,t){if(this.getCollections({sync:t.subscribe}),!t.subscribe){if(s.getProperty("addingRecord")){const t=s.getItems();t.push(e),s.setProperty("addingRecord",!1).setItems(t).emit("addToNewCollection",e.id)}s.isValid("activeId",e.id)&&s.setProperty("activeId",e.id)}}).on("addedRecords",function(e){this.getCollections(),this.getRecordsByCollection(e)}).on("records",function(e,t,i){if(i.sync){const i=s.getItems().find(function(e){return e.id===t});s.timeoutSyncCollection(i.serverId,e)}else s.setRecords(e),s.emit("recordsReceived",t,e),t===s.getProperty("activeId")&&s.checkRecord(),i.active&&s.deleteRecords()}).on("collections",function(e,t){s.setItems(e),t.sync?(s._presyncCollections(s.getPreSyncData()),s.emit("collectionsSynced")):(s.checkRecord(),s.emit("updateTop")),s.emit("collectionsSet")}).once("collections",()=>{this.emit("firstCollectionSync")}).on("collectionUpdated",function(){this.getCollections()}).on("recordUpdated",function(e=null){s.checkRecord(),s.emit("recordUpdated",e)}).on("recordDeleted",e=>{i.getCollections(),this.getItems().some(t=>t.type===o.COLLECTION_TYPES.HISTORY&&t.id===e)?i.getRecordsByCollection(e):i.getRecordsByCollection(this.getProperty("activeId"))}).on("collectionDeleted",(e={})=>{i.getCollections({sync:e.unsubscribed})}).on("resetedScore",function(e){s.emit("updateRecords",e)}).on("resetedIds",function(){s.emit("resetedIds").setProperty("syncedUid",null),this.getCollections({sync:!s.isNotAuthorized()})}).on("checkRecordError",function(e){s.emit("checkRecordError",String(e))}).on("databaseBlocked",function(e){const t={trace:e,sender:"blocked"};s.emit("databaseError",t)}).on("openError",function(e){s.emit("databaseError",{name:e&&e.name,sender:"openTryCatch",message:e&&e.message})}).on("error",function(e,t,i){const n=e.target.error,r={name:n&&n.name,trace:i,sender:t,message:n&&n.message};s.emit("databaseError",r)}).on("indexNotFound",function({indexName:e,version:t}){s.emit("dbIndexNotFound",{indexName:e,version:t})}).open()}getDefaults(){return{srv:"",uid:"",url:"/",limit:0,recordsLimit:0,items:"",records:"",value:"",xtoken:"",activeId:"",text:"",srcLang:"",dstLang:"",translation:"",syncedUid:"",addingRecord:!1}}isNotAuthorized(){return!this.getProperty("uid")}timeoutSyncCollection(e,t){const s=this,i=this.getSyncData(e,t);setTimeout(function(){s._syncCollection(e,i)},Math.floor(Math.random()*a.SYNC_TIMEOUT))}getCollectionList(){return this._database.getCollections(),this}getCollection(e){return this._database.getRecordsByCollection(e),this}deleteCollection(e){const t=this._database;let s,i=this.getItems(),n="";return t.deleteCollection(e),e===this.getProperty("activeId")&&(s=i.filter(function(e){return e.type===o.COLLECTION_TYPES.FAVORITES})[0],s?n=s.id:(i=i.filter(function(t){return e!==t.id&&!o.CollectionServerModel.isSubscription(t)}),i.length&&(n=i[0].id)),this.setProperty("activeId",n)),this}createCollection(e){const t=this._database,s=!e.sourceCollectionId,i={name:e.name,type:s?o.COLLECTION_TYPES.COLLECTION:o.COLLECTION_TYPES.SUBSCRIPTION,color:e.color,public:e.public,status:o.COLLECTION_STATUSES.ADDED,version:0,recordsCount:e.recordsCount||0,creationTimestamp:o.CollectionServerModel.getTimestamp(),attributesTimestamp:o.CollectionServerModel.getTimestamp()};return s||(i.authorName=e.authorName,i.sourceCollectionId=e.sourceCollectionId,i.authorUid=e.authorUid),s&&!i.color&&(i.color=a.getRandomColor()),t.createCollection(i,{subscribe:!s}),this}updateCollection(e,t){return t.status=o.COLLECTION_STATUSES.UPDATED,t.attributesTimestamp=o.CollectionServerModel.getTimestamp(),this._database.updateCollectionData(e,t),this}
addRecords(e,t){return this._database.addRecords(e,t),this}deleteRecords(e){let t=e;const s=this._database,i=this.getProps(),n=this.getRecords();if(!t){const e=n.find(function(e){return i.text===e.text&&i.srcLang+"-"+i.dstLang===e.lang&&i.translation===e.translation});e&&(t=[e.id])}return t&&s.deleteRecords(t),this}resetRecordsScore(e){return this._database.resetRecordsScore(e),this}updateRecord(e,t){return t.modificationTimestamp=o.CollectionServerModel.getTimestamp(),this._database.updateRecord(e,t),this}updateHistoryRecord(e,t){return this._database.updateHistoryRecord(e,t),this}deleteRecordByProps(e,t){return this._database.deleteRecordByProps(e,t),this}moveRecords(e,t){const s=this._database;return e.forEach(function(e){s.moveRecord(e,t)}),this}checkRecord(e=this.getProperty("activeId")){const t=this._database,s=this.getProps();return e&&t.isActive()&&s.text&&s.translation?(t.checkRecord({text:s.text,lang:s.srcLang+"-"+s.dstLang,translation:s.translation,collectionId:e}),this):this.emit("checked",!1)}getActive(){return this._database.getRecordsByCollection(this.getProperty("activeId"),{active:!0}),this}syncCollections(){const e=this._database,t=this.getProps();return t.syncedUid&&(this.isNotAuthorized()||t.syncedUid!==t.uid)?e.resetServerIds():e.getCollections({sync:!this.isNotAuthorized()}),this}subscribe(e){return this.createCollection({name:e.name,color:e.color,public:!1,authorName:e.authorName,authorUid:e.authorUid,sourceCollectionId:e.id}),this}getPreSyncData(){let e=this.getItems();return this.getProperty("shouldSyncHistory")||(e=e.filter(e=>e.type!==o.COLLECTION_TYPES.HISTORY)),{collectionsStatuses:e.filter(e=>e.serverId||e.status!==o.COLLECTION_STATUSES.DELETED).map(function(e){if(e.serverId)return{id:e.serverId,type:e.type,tmpId:e.id,status:e.status,version:e.version};const t={name:e.name,type:e.type,tmpId:e.id,status:o.COLLECTION_STATUSES.ADDED,creationTimestamp:e.creationTimestamp};return e.color&&(t.color=e.color),o.CollectionServerModel.isSubscription(e)?(t.authorName=e.authorName,t.sourceCollectionId=e.sourceCollectionId):t.public=e.public,t})}}getSyncData(e,t){let s={};const i=this.getItems().find(function(t){return t.serverId===e});return i&&(s={name:i.name,type:i.type,tmpId:i.id,version:i.version,attributesTimestamp:i.attributesTimestamp},i.color&&(s.color=i.color),o.CollectionServerModel.isSubscription(i)?s.authorName=i.authorName:s.public=i.public),s.status=i?o.COLLECTION_STATUSES.UPDATED:o.COLLECTION_STATUSES.ABSENT,t&&t.length&&(s.recordsStatuses=t.filter(function(e){return e.serverId||e.status!==o.COLLECTION_STATUSES.DELETED}).map(function(e){return e.serverId?{id:e.serverId,score:e.score,tmpId:e.id,status:e.status,modificationTimestamp:e.modificationTimestamp}:{lang:e.lang,text:e.text,score:e.score,tmpId:e.id,status:o.COLLECTION_STATUSES.ADDED,translation:e.translation,creationTimestamp:e.creationTimestamp,modificationTimestamp:e.modificationTimestamp}})),{collectionStatus:s}}processCollections(e){const t=this._database,s=this,i=this.getItems();return e.length?(e.forEach(function(e){switch(e.action){case o.COLLECTION_ACTIONS.ADD:s.timeoutSyncCollection(e.id);break;case o.COLLECTION_ACTIONS.DROP:case o.COLLECTION_ACTIONS.DELETE:t.deleteCollection(e.tmpId,!0);break;case o.COLLECTION_ACTIONS.UPDATE:t.getRecordsByCollection(e.tmpId,{sync:!0});break;case o.COLLECTION_ACTIONS.REGISTER:i.map(function(t){return t.id===e.tmpId&&(t.serverId=e.id),t}),s.setItems(i),t.updateCollectionData(e.tmpId,{status:o.COLLECTION_STATUSES.UPDATED,serverId:e.id}),t.getRecordsByCollection(e.tmpId,{sync:!0});break;case o.COLLECTION_ACTIONS.POSTPONE:case o.COLLECTION_ACTIONS.MERGE:}}),this):this.emit("synced")}mergeCollection(e){const t=this._database,s=this.getItems().find(function(t){return t.id===e.tmpId||t.serverId===e.id}),i=e.changedAttributes||{},n=e.recordsActions||[];switch(e.action){case o.COLLECTION_ACTIONS.NOP:t.updateCollectionData(s.id,{status:o.COLLECTION_STATUSES.UNCHANGED});break;case o.COLLECTION_ACTIONS.DELETE:t.deleteCollection(s.id,!0);break;case o.COLLECTION_ACTIONS.ADD:const r={};Object.keys(i).forEach(function(e){r[e]=i[e]}),r.status=o.COLLECTION_STATUSES.UNCHANGED,r.serverId=e.id,t.addCollection(r,this.mergeRecords(n));break;case o.COLLECTION_ACTIONS.UPDATE:Object.keys(i).forEach(function(e){s[e]=i[e]}),s.status=o.COLLECTION_STATUSES.UNCHANGED,t.updateCollection(s,this.mergeRecords(n))}return this}mergeRecords(e){const t=[],s=[],i=[];return e.forEach(function(e){switch(e.modificationTimestamp=e.modificationTimestamp||e.creationTimestamp||0,e.score=e.score||0,e.action){case o.COLLECTION_ACTIONS.ADD:t.push({lang:e.lang,text:e.text,translation:e.translation,serverId:e.id,score:e.score,status:o.COLLECTION_STATUSES.UNCHANGED,creationTimestamp:e.creationTimestamp,modificationTimestamp:e.modificationTimestamp});break;case o.COLLECTION_ACTIONS.DROP:case o.COLLECTION_ACTIONS.DELETE:s.push({id:e.tmpId});break;case o.COLLECTION_ACTIONS.UPDATE:i.push({id:e.tmpId,params:{score:e.score,status:o.COLLECTION_STATUSES.UNCHANGED,modificationTimestamp:e.modificationTimestamp}});break;case o.COLLECTION_ACTIONS.REGISTER:i.push({id:e.tmpId,params:{serverId:e.id,status:o.COLLECTION_STATUSES.UNCHANGED}});break;case o.COLLECTION_ACTIONS.POSTPONE:}}),{new:t,deleted:s,updated:i}}filter(e){const t=this.getRecords(),s=n.default.trim(e).toLowerCase();return t.forEach(function(e){e.filtered=s&&(e.deleted||e.text.toLowerCase().indexOf(s)<0&&e.translation.toLowerCase().indexOf(s)<0)}),t}getRecords(){let e=this.getProperty("records");try{e=JSON.parse(e)}catch(t){e=[]}return e}setRecords(e){return this.setProperty("records",e&&JSON.stringify(e))}}t.CollectionModel=a,a.SYNC_TIMEOUT=2e3,a.COLORS=["#b0a79a","#ffbb5a","#fd9060","#ff6665","#e43c31","#c44f69","#9d65a9","#6c65a9","#3779bc","#6fc3e0","#59cd9c","#a5c94b"],a.COLOR_CSSRULE='.{0}[data-color="{1}"] { color: {1}; }'},function(e,t,s){"use strict";t.__esModule=!0,t.RouteBuilder=void 0,t.RouteBuilder=class{constructor(e){this.routeList=[],e&&this.append(e)}append(e){return this.routeList.push(e),this}build(){return"/"+this.routeList.join("/")}}},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryMultipleModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(147),o=s(138),a=s(148),l=s(134),c=s(149),d=s(171),u=s(70),h=s(172);class p extends d.DictionaryModel{constructor(e,t){super(e,t),this.label="lookupMultiple";const{getLangDir:s}=e;this._getLangDir=s,this.onSet("data",(e,t={})=>{if("selection"===t.reason)return;const s=this.getDeclensions(e);this.emit(o.DECLENSIONS_EVENTS.DECLENSIONS_FETCHED,s)}).onSet("data",e=>{const t=this.getIdiom(e);this.emit(a.IDIOMS_EVENTS.IDIOM_FETCHED,t)}).onSet("data",(e,t={})=>{if("selection"===t.reason)return;const s=this.getDefinitionAndAbbreviations(e);this.emit(l.DEFINITION_EVENTS.DEF_FETCHED,s)}).onSet("data",(e,t={})=>{if("selection"===t.reason)return;const s=this.getRelatedWords(e);this.emit(r.RELATED_WORDS_EVENTS.WORDS_FETCHED,{relatedWords:s,visible:s&&this.hasRelatedWords(s)})}).onSet("data",(e,t={})=>{if("selection"===t.reason||t.invalid)return;const s=this.parseDataResponse(e);this.emit(c.DICTIONARY_EVENTS.DICT_FETCHED,s)})}getLangDir(){const e=this._getLangDir();return this.getProperty("dirReversed")?e.split("-").reverse().join("-"):e}getParams(){let e,t;const s=this.getProps(),i=s.type.split(","),n=[];for(e=0,t=i.length;e<t;e++)i[e]===u.DictionaryPresenter.types.REGULAR?n.push(s.srcLang+"-"+s.dstLang+"."+i[e]):n.push(s.srcLang+"."+i[e]);return{...super.getParams(),ui:s.ui,srv:s.srv,text:s.text,flags:s.flags,dict:n.join(",")}}hasRelatedWords({synWords:e,antWords:t,derivedWords:s}){return[e,t,s].some(e=>e.length)}transformDefinition(e,t=!1){return{imgUrl:e.img,origUrl:e.orig,textVal:e.def.split(/[<>]/).map((e,t)=>({text:e,highlighted:t%2!=0})),altText:e.text,sourceUrl:e.ref.url,sourceName:e.ref.name,isAbbreviation:t}}getDefinition(e){const t=n.default.get(e,"0.tr.0");return!t||t.idiom||t.abbr?null:{...this.transformDefinition(t),origText:e[0].text}}getAbbreviations(e){return n.default.get(e,"0.tr.0.abbr",!1)?e.map(({text:e,tr:t})=>({...this.transformDefinition(t[0],!0),abbrText:e})):[]}getDefinitionAndAbbreviations(e){const t={definition:null,abbreviations:[]};if(!e)return t;const s=n.default.safeParseJSON(e),i=this.getLangDir();if(!s[i])return t;const r=s[i][u.DictionaryPresenter.types.DEF];return n.default.isNonEmptyArray(r)?{definition:this.getDefinition(r),abbreviations:this.getAbbreviations(r)}:t}getIdiom(e){if(!e)return null;const t=this.getLangDir(),s=n.default.safeParseJSON(e);if(!s[t])return null;const i=s[t][u.DictionaryPresenter.types.DEF];if(Array.isArray(i)&&i.length){var r,o,a;const e=i[0],t=null===(r=e.tr)||void 0===r?void 0:r[0],s=null!==(o=null==t?void 0:t.def)&&void 0!==o?o:"",n=null!==(a=e.text)&&void 0!==a?a:"",l=t.idiom;return s&&n&&l?{definition:s,text:n}:null}return null}getRelatedWords(e){if(!e)return null;const t=n.default.safeParseJSON(e);if(!t)return null;const{srcLang:s}=this.getProps(),i=t[s]||{};return{synWords:i.syn||[],derivedWords:i.deriv||[],antWords:i.ant||[]}}getDeclensions(e){const t=this.getLangDir(),s="en-ru"===t;if(!e)return[];const i=n.default.safeParseJSON(e);if(!i[t])return[];const r=i[t][u.DictionaryPresenter.types.REGULAR];return r&&r.length?(0,h.transformServerDeclensions)({dict:r,isEnglish:s}):[]}}t.DictionaryMultipleModel=p},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(8),o=s(130),a=s(65),l=s(17),c=s(29),d=s(70),u=s(211);class h extends a.SyncModel{constructor(...e){super(...e),this.label="dict"}getParams(){const e=this.getProps();return{sid:e.sid,ui:e.ui,srv:e.srv,text:e.text,type:e.type,lang:e.srcLang+"-"+e.dstLang,flags:e.flags}}getDefaults(){return{ui:"",srv:"",url:"/",data:"",text:"",type:"",flags:0,srcLang:"",dstLang:"",customExamples:!1,customExamplesText:""}}hasFlag(e){return(this.getProperty("flags")&e)===e}hasType(e){let t=this.getProperty("type");return t=t?t.split(","):[],-1!==t.indexOf(e)}setType(e,t){let s=this.getProperty("type");s=s?s.split(","):[];const i=s.indexOf(e);return Boolean(t)===i>=0||(t?s.push(e):s.splice(i,1),this.setProperty("type",s.join(","))),this}setFlag(e,t){let s=this.getProperty("flags");return Boolean(t)===this.hasFlag(e)||(s+=e*(t?1:-1),this.setProperty("flags",s)),this}runRequest(e={}){const{url:t}=this.getProps(),s=this.getParams();return this.setRequest(l.HTTPRequest.get(t,s,(t,i)=>{const n=t?t.code:l.HTTPRequest.codes.OK;if(n===l.HTTPRequest.codes.OK){if(!this.isValidResponse(i.text)){const e=i.text?i.text.slice(0,o.MAX_LOG_RESPONSE_TEXT_LENGTH):null;(0,r.logError)(new u.DictionaryApiParseError(this.label,n),{additional:{text:s.text,lang:s.lang,responseText:e}})}this.setProperty("data",i.text,{reason:e.reason,resultLength:i.body&&i.body.result&&i.body.result.length})}else n!==c.HTTPError.ABORT&&(this.emit("error",t),(0,r.logError)(new u.DictionaryApiError(this.label,n),{additional:{text:s.text,lang:s.lang}}))}))}isValidResponse(e){return!0}requestData(e){if(this.abort(),!this.isValid())return this;this.getSid().then(()=>this.runRequest(e))}parseDataResponse(e){if(!e)return null;const t=n.default.safeParseJSON(e),s=this.getLangDir();if(!t[s])return null;const i=t[s][d.DictionaryPresenter.types.REGULAR];return i&&i.length?i:null}}t.DictionaryModel=h},function(e,t,s){"use strict";function i(e,t){return{text:e,highlighted:t%2!=0}}function n(e){const t=e.src.split(/[<>]/),s=e.dst.split(/[<>]/),n=e.ref;return{id:e.id,refType:n.type,ref:n.type===c.IDIOM?c.IDIOM:n.title,isIdiom:n.type===c.IDIOM,isNews:n.type===c.NEWS,isSites:n.type===c.SITES,isIT:n.type===c.IT,isBook:n.type===c.BOOK,isMovieOrSeries:n.type===c.MOVIE||n.type===c.SERIES,exampleVal:t.map(i),originalVal:t.join(""),exampleTrs:s.map(i),originalTrs:s.join(""),title:n.type===c.NEWS?a.locales.labels.news:n.title,origTitle:n.orig_title,author:n.author,translator:n.translator,year:n.year,director:n.director,refUrl:n.url}}t.__esModule=!0,t.transformServerDeclensions=function({dict:e,isEnglish:t}){const s=[],i=e=>{const t=o.default.get(e,"pos.code","");return l.POS_CODES[t]||""},n=e=>{const t={optional:"",main:e};if("("!==e[0])return t;try{const[,t,s]=e.match(/^(\(.+?\)) (.+)$/);return{optional:t,main:s}}catch(e){return t}},r=({headers:e=[],headerComments:t=[],rows:s,rowComments:i=[],timelines:r=[]})=>s.map((s,o)=>{const a=s.map((e,t)=>({value:n(e),comment:Array.isArray(i[o])?i[o][t]:""})),l={header:e[o]||"",comment:t[o]||"",cells:a},c=r[o]||null;return c&&(l.timeline=c),l}),a=(e,t)=>(e.length||(e=[""]),e.map((e,s)=>({header:e,tables:r(t[s])})));for(const n of e){const e=i(n),r=o.default.get(n,"text",""),l=o.default.get(n,"prdg.data.0.tabs",[]),c=o.default.get(n,"prdg.data.0.tables",[]);if(!e||!c.length)continue;const d={isEnglish:t,text:r,partOfSpeech:e,tabs:a(l,c)};s.push(d)}return s.sort((e,t)=>{const s=l.POS_ORDER[e.partOfSpeech],i=l.POS_ORDER[t.partOfSpeech];return s-i}),s},t.transformServerExamples=function(e){const t=o.default.get(e,"result.tabs",[]),s=o.default.get(e,"result.examples",[]);if(0===s.length)return{exampleTabs:[],allExamples:[]};const i=[],r=t.map(e=>({...e,examples:[]}));for(const e of s){const t=n(e);i.push(t),o.default.get(e,"ref.type")!==c.NEWS&&r[e.tabIndex].examples.push(t)}return{exampleTabs:r,allExamples:i}},t.validateServerResponse=function(e){const t=o.default.get(e,"result.tabs"),s=o.default.get(e,"result.examples"),i=o.default.isArray(t),n=o.default.isArray(s);if(!i||!n)return!1;if(t.length)for(const e of t){const t=e.text;if(!o.default.isString(t)||!t.length)return!1;const s=e.translation;if(!(o.default.hasProperty(s,"text")||o.default.hasProperty(s,"other")||o.default.hasProperty(s,"idiom")||o.default.hasProperty(s,"hide")))return!1}if(s.length){const e=s[0];if(![o.default.isNumber(e.tabIndex),o.default.isString(e.id),o.default.isString(e.src)&&e.src.length,o.default.isString(e.dst)&&e.dst.length,Object.values(c).includes(o.default.get(e,"ref.type"))].every(e=>e))return!1}return!0},s(1);var r,o=(r=s(0))&&r.__esModule?r:{default:r},a=s(30),l=s(70);const c={IDIOM:"idiom",BOOK:"book",SERIES:"series",MOVIE:"movie",NEWS:"news",SITES:"sites",IT:"IT"}},function(e,t,s){"use strict";t.__esModule=!0,t.PredictorModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(8),o=s(130),a=s(45),l=s(72),c=s(17),d=s(29),u=s(213),h=s(214);class p extends l.ListboxModel{static prepareValue(e,t){const s=t.pos;let i=t.index,n=t.value;return s<0?i+=s:n=new Array(s+1).join(" ")+n,{text:e.slice(0,i)+n+e.slice(t.index),caret:i+n.length}}static extractWords(e,t){if(!n.default.trim(e))return"";const s=e.match(/(\S+\s*)/g),i=t?-t:0;return s?s.slice(i).join(""):""}constructor(e,t={}){super(e,t),this._url=t.url,this._counter=0,this._detectUrl=t.detectUrl,this._detectCounter=0}getParams(){const e=this.toJSON();return{q:e.text,srv:e.srv,sid:e.sid,lang:e.srcLang,limit:e.limit}}getDefaults(){return{pos:0,srv:"",text:"",auto:!1,index:0,value:"",items:"",limit:10,reason:"",srcLang:"",dstLang:"",endOfWord:!1}}validateDetectResponse(e,t){if(!n.default.hasAlpha(t.q))return!0;const s=e&&e.body,{languages:i}=this.getProps();return n.default.isObject(s)&&i[s.lang]}runDetectRequest(){if(!this.canDetectLanguage())return this;const e=this.getDetectParams(),t=++this._detectCounter;c.HTTPRequest.get(this._detectUrl,e,(s,i)=>{var n,a;const l=s&&c.HTTPRequest.isAbortedCode(s.code),u=i&&c.HTTPRequest.isSuccessCode(i.code),p=(0,o.getLogErrorCode)({response:i,error:s});if(!u&&!l)return void(0,r.logError)(new h.DetectApiError(e.hint,p));if(u&&!l&&!this.validateDetectResponse(i,e)){const t=i.text?i.text.slice(0,o.MAX_LOG_RESPONSE_TEXT_LENGTH):null;return void(0,r.logError)(new h.DetectParseError(e.hint),{additional:{responseText:t}})}if(t!==this._detectCounter||JSON.stringify(e)!==JSON.stringify(this.getDetectParams()))return;if(!u)return this.emit("detectError",s||new d.HTTPError(p,i.body.message));const g=null==i||null===(n=i.body)||void 0===n?void 0:n.lang;g&&this.setProperty("srcLang",g,{kbd:Boolean(null==i||null===(a=i.body)||void 0===a?void 0:a.kbd),detected:!0})})}detectLanguage(){return a.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runDetectRequest()}),this}getDetectParams(){const e=this.toJSON();return{sid:e.sid,srv:e.srv,text:n.default.trim(e.text),hint:[e.srcLang,e.dstLang].join(","),options:e.detectOptions}}canDetectLanguage(){return this.isValid("text")&&this.getProperty("auto")}validateSuggestionsResponse(e){const t=e&&e.body;return n.default.isObject(t)&&n.default.isArray(t.text)&&"number"==typeof t.pos&&"boolean"==typeof t.endOfWord}runSuggestionRequest(){if(!this.canRequestSuggestion())return this;const e=this.getParams(),t=++this._counter;this.emit("query",e),c.HTTPRequest.get(this._url,e,(s,i)=>{const n=s&&c.HTTPRequest.isAbortedCode(s.code),a=i&&c.HTTPRequest.isSuccessCode(i.code);if(a||n)if(!a||n||this.validateSuggestionsResponse(i)){if(t===this._counter&&JSON.stringify(e)===JSON.stringify(this.getParams()))return s?this.emit("error",s):void this.setProperty({pos:i.body.pos,endOfWord:i.body.endOfWord}).setItems(i.body.text&&i.body.text.length?i.body.text:"")}else{const t=i.text?i.text.slice(0,o.MAX_LOG_RESPONSE_TEXT_LENGTH):null;(0,r.logError)(new u.PredictorParseError(e.lang),{additional:{responseText:t}})}else{const t=(0,o.getLogErrorCode)({response:i,error:s});(0,r.logError)(new u.PredictorApiError(e.lang,t))}})}requestSuggestion(){return a.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runSuggestionRequest()}),this}canRequestSuggestion(){return this.isValid()}}t.PredictorModel=p},function(e,t,s){"use strict";t.__esModule=!0,t.MicNotificationChip=t.MAC_NOTIFICATION_CHIP_TYPES=void 0;var i=s(6),n=s(2),r=s(26);const o={DISABLED:"disabled",ACTIVATING:"activating"};t.MAC_NOTIFICATION_CHIP_TYPES=o;class a extends i.Component{constructor(e,t){super(e,t),this.locales=r.desktopLocales.micNotificationChip,this.update(),this.handleEnableMicGif(),this.tooltipView=new n.TouchView({element:e.tooltipElement}),this.tooltipView.setVisible(this.getProperty("type")===o.ACTIVATING),this.onChange("type",()=>{this.tooltipView.setVisible(this.getProperty("type")!==o.DISABLED),this.update()}),this.onVisibilityChanged(e=>{e||this.tooltipView.setVisible(!1)})}handleEnableMicGif(){const{gifUrl:e}=this.getProps(),t=document.createElement("img");t.classList.add("micNotificationChipTooltip_image"),t.setAttribute("alt",this.locales.micEnableInstructionAlt),t.src=e,t.onload=(()=>{const e=this.getProps().tooltipElementWrapper,s=this.getProps().spinnerElement;e&&s&&(e.removeChild(s),e.appendChild(t))})}getTitle(){return this.getProperty("type")===o.ACTIVATING?this.locales.micActivating:this.locales.micDisabled}isTooltipVisible(){return this.tooltipView.isVisible()}closeTooltip(){this.tooltipView.setVisible(!1)}template({html:e,cn:t}){return e`
            <div @click=${()=>this.closeTooltip()}
                 class="${t("button")({view:"primary",disabled:!0,size:"l",round:!0})} micNotificationChip"
                 data-tooltip="${this.locales.micAccessDenied}"
                 data-tooltip-position="top-right"
                 data-tooltip-vetrical-margin="5">
                ${this.getTitle()}
            </div>
        `}}t.MicNotificationChip=a,a.defaults={type:o.DISABLED}},function(e,t,s){"use strict";t.__esModule=!0,t.MAX_EXAMPLES_AMOUNT=t.EXAMPLES_FILTER_DELIMITER=t.EXAMPLES_FILTER_ALL=t.DictionaryPresenter2=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(70);const o=window.config||{},a="allTr";t.EXAMPLES_FILTER_ALL=a,t.EXAMPLES_FILTER_DELIMITER=":",t.MAX_EXAMPLES_AMOUNT=10;class l extends r.DictionaryPresenter{static prepareExampleData(e,t,s,i=[],n,r=[],o=[],a=[]){return l.prepareItems(e).filter(e=>l.filterItem(e,n)).map((e,c)=>l.processItem(e,c,t,s,i,n,r,o,a)).filter(e=>e.examples.length)}static prepareItems(e){return e}static filterItem(e,t){const s=e.translation,i=s.text||s;if(t&&t.includes(":")){const n=s.pos&&s.pos.code;return t===[a,null].join(":")||t===[i,n].join(":")||t===[e.text,null].join(":")}if(!t||t===a||i===t)return e}static processItem(e,t,s,i,r,a,c,d,u){let h;h=e.translation.other?o.TABS.other:e.translation.idiom?o.TABS.idioms:e.translation.text||e.translation;const p=a===h,g=r[t],E=e.examples.filter(({id:e})=>!n.default.isArray(u)||!u.includes(e)).map(function(e){return l.processExample(e,s,i,c,d,h)});return l.prepareExampleGroup(e,t,E,p,g,h)}static processExample(e,t,s,i,r,o){const a=e.src.split(/[<>]/),c=e.dst.split(/[<>]/),d=l.prepareOneExample(e,a,c,t,s,o);if(n.default.hasProperty(i,d.id)&&(d.voteResult={isGood:i[d.id],isBad:!i[d.id]}),n.default.hasProperty(r,d.id)){const e=r[d.id];d.speakerSrc=e.srcValid,d.speakerDst=e.dstValid}return d}static prepareOneExample(e,t,s,i,n,r){return{id:e.id,exampleVal:t.map(function(e,t){return{text:e,highlighted:t%2!=0}}),originalVal:t.join(""),srcLang:i,exampleTrs:s.map(function(e,t){return{text:e,highlighted:t%2!=0}}),originalTrs:s.join(""),translation:r,dstLang:n,ref:"idiom"===e.ref.type?e.ref.type:e.ref.title,author:e.ref.author,translator:e.ref.translator,year:e.ref.year,director:e.ref.director,title:e.ref.title,origTitle:e.ref.orig_title,message:l.getTooltipMessage(e.ref),refType:e.ref.type,refUrl:e.ref.url}}static prepareExampleGroup(e,t,s,i,r,a){const l=s.length-o.MIN_EXAMPLE_COUNT,c=e.translation,d=c.pos?c.pos:null,u=c.other;return{pos:!u&&d&&d.text,text:e.text,index:t,showAll:s.length===o.MAX_EXAMPLE_COUNT,posCode:!u&&d&&d.code,tooltip:!u&&d&&d.tooltip,examples:s,expanded:i||r,filtered:i,other:u,moreCount:s.length>o.MIN_EXAMPLE_COUNT?s.length-o.MIN_EXAMPLE_COUNT:"",translation:a,moreMessage:l>0?n.default.parseString(o.MORE_MESSAGE,l):""}}static getTooltipMessage(e){const t=e.type||e.refType;switch(t){case"news":return o.REFERENCE_TOOLTIP_MESSAGES.news;case"book":return n.default.parseString(o.REFERENCE_TOOLTIP_MESSAGES.book,e.author,e.title,e.translator);case"movie":case"series":return n.default.parseString(o.REFERENCE_TOOLTIP_MESSAGES[t],e.title,e.director);case"idiom":return o.REFERENCE_TOOLTIP_MESSAGES.idiom}}constructor(e){super(e);const t=this;this.getModel().on("change:voteResults",function(e,s){t._renderData(this.getProperty("data"),s)}).on("change:speakersSupport",function(e,s){t._renderData(this.getProperty("data"),s)}).on("change:expandedLists",function(e,s){t._renderData(this.getProperty("data"),s)})}updateView(){const e=this.getModel();this._renderData(e.getProperty("data"))}setTranslation(e,t){return this.getModel().setProperty("translation",e,t),this}getDict(){return this.getModel().getProperty("dict")}setVoteResult(e,t){this.getModel().setVoteResult(e,t)}setVoteResults(e){return this.getModel().setVoteResults(e),this}getVoteResults(){return this.getModel().getVoteResults()}setSpeakerSupport(e,t,s){this.getModel().setSpeakerSupport(e,t,s)}setSpeakersSupport(e){return this.getModel().setSpeakersSupport(e),this}getSpeakersSupport(){return this.getModel().getSpeakersSupport()}setExpandedList(e,t){this.getModel().setExpandedList(e,t)}getExpandedLists(){return this.getModel().getExpandedLists()}setDict(e,t){return this.getModel().setProperty("dict",e,t),this}setMaxLength(e,t){return this.getModel().setProperty("maxLength",e,t),this}setData(e,t){return this.getModel().setProperty("data",e,t),this}setCustomExamplesFlag(e,t){const s=this.getModel();return s.setProperty({customExamplesText:e?s.getProperty("text"):"",customExamples:e},t),this}customExamplesEnabled(){return Boolean(this.getModel().getProperty("customExamples"))}getText(){return this.getModel().getProperty("text")}getSelectedText(){return this.getModel().getProperty("selText")}setSelectedText(e,t){return this.getModel().setProperty("selText",e,t),this}getSrcLanguage(){return this.getModel().getProperty("srcLang")}getDstLanguage(){return this.getModel().getProperty("dstLang")}_handleSetData(e,t){this.emit("dataSet",e,t)}_handleChangeLang(){this.emit("langChanged")}}t.DictionaryPresenter2=l},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerView=t.RECOGNIZER_STATES=void 0;var i=s(2);t.RECOGNIZER_STATES={LISTENING:"listening",PREPARING:"preparing",INVALID:"invalid",ACTIVATING:"activating",MIC_DISABLED:"mic-disabled"};class n extends i.TouchView{}t.SpeechRecognizerView=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerNative=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(142);class o extends r.SpeechRecognizerBase{static isAvailable(){const e=window.SpeechRecognition||window.webkitSpeechRecognition;return e&&n.default.isFunction(e)&&!/opr/.test(navigator.userAgent.toLowerCase())}constructor(e={}){super(e),this._options=e,this._isListening=!1}getRecognition(){return this._recognition||this._createRecognizer(),this._recognition}getNewRecognition(){return this._createRecognizer(),this._recognition}_createRecognizer(){this._recognition&&this._clearListeners();const{continuous:e,interimResults:t}=this._options,s=new(window.SpeechRecognition||window.webkitSpeechRecognition);s.continuous=e,s.interimResults=t,s.onstart=this._onStart.bind(this),s.onend=this._onEnd.bind(this),s.onresult=this._onResult.bind(this),s.onerror=s.onend,this._recognition=s}_clearListeners(){const e=this._recognition;e.onstart=null,e.onend=null,e.onresult=null,e.onerror=null}_onStart(){this._isListening=!0,this.emit(r.RECOGNITION_EVENTS.START,"native")}_onEnd(e){this._isListening=!1,"error"===e.type&&this.getRecognition().abort(),this.emit(r.RECOGNITION_EVENTS.END,"error"===e.type?e.error:"")}_onResult(e){this._isListening&&this.emit(r.RECOGNITION_EVENTS.RECOGNIZE,e)}stopListening(){return this.getRecognition().abort(),this}startRecognition(e){const t=this.getNewRecognition();if(!navigator.onLine)return this.emit(r.RECOGNITION_EVENTS.END,r.RECOGNITION_ERRORS.NETWORK);t.lang=e,t.start()}convertLanguage(e,t){t(o.langs[e]||"")}prepareData(e,t){let s="",i=!0;const r=e.results;for(let t=e.resultIndex,n=r.length;t<n;t++){if(!r[t])return;r[t][0]&&(s+=r[t][0].transcript),r[t].isFinal||(i=!1)}return{final:i,value:n.default.trim(s),index:t,resultIndex:e.resultIndex}}getVisualizer(){return null}getPriority(){return/yabrowser/.test(navigator.userAgent.toLowerCase())?r.RECOGNITION_PRIORITIES.LOW:r.RECOGNITION_PRIORITIES.NORMAL}}t.SpeechRecognizerNative=o,o.langs={el:"el-GR",en:"en-GB",ru:"ru-RU",uk:"uk-UA"}},function(e,t,s){"use strict";t.__esModule=!0,t.StreamPlayer=t.AUDIO_FORMATS=void 0;var i=s(10);t.AUDIO_FORMATS={WEBM:"audio/webm;codecs=opus",OGG:"audio/ogg;codecs=opus",WAV:"audio/x-wav;bit=16",WAV_PCM:"audio/x-pcm;bit=16",RAW:"audio/x-raw"};const n="no_stream",r="decode_error",o="buffer_source_error",a="player_error";t.StreamPlayer=class{constructor(e){this.stream=null,this.activeSource=null,this.activeBufferIndex=0,this.stopped=!0,this.format="",this.streamFactory=e,this.audioContext=null}setAudioContext(e){this.audioContext=e}start({onStart:e,onError:t,onFinished:s,format:i}){this.decodeErrorCounter=0,this.format=i,this.stopped=!1,this.onStart=e,this.onError=t,this.onFinished=s}stop(){this.stream&&this.stream.break(),this.finished()}onPackage(e){this.stream||(this.stream=this.streamFactory({onBufferReady:this.onBufferReady.bind(this),format:this.format})),this.stream?this.stream.add(e):this.error(n)}onStreamFinished(){this.stream&&this.stream.finish()}onBufferReady(e,t){e?(this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),this.audioContext.decodeAudioData(e,e=>this.handleDecodeAudioData(e,t),this.handleDecodeError.bind(this))):this.stop()}handleDecodeError(e){if(0==this.decodeErrorCounter++){const t=e?e.message:null;(0,i.getGlobalEmitter)().emit("uniproxyTtsError",r,t,{format:this.format,errorCount:this.decodeErrorCounter})}else this.decodeErrorCounter>5&&(this.error(r,e),this.decodeErrorCounter=0)}handleDecodeAudioData(e,t){this.stopped||(this.audioBuffers||(this.audioBuffers=[]),this.audioBuffers[t]=e,this.playBuffer())}finished(){this.onFinished&&this.onFinished(),this.clean()}clean(){this.stream=null,this.stopped=!0,this.audioBuffers=null,this.activeBufferIndex=0,this.activeSource&&(this.activeSource.disconnect(),this.activeSource.removeEventListener("ended",this.handleEnded.bind(this)),this.activeSource.removeEventListener("error",this.handleError.bind(this,o)),this.activeSource.stop()),this.activeSource=null,this.onStart=null,this.onError=null,this.onFinished=null}error(e=null,t=null){null===e&&(e=a);const s=t instanceof Error?t.message:null;this.onError&&this.onError(e,s),this.clean()}playBuffer(e=!1){if(!this.audioBuffers||!this.audioBuffers.length)return;const t=this.audioBuffers[this.activeBufferIndex];if(t&&(!this.activeSource||e)){this.audioContext||(this.audioContext=new(window.AudioContext||window.webkitAudioContext));const e=this.audioContext,s=e.createBufferSource();this.activeSource=s,s.buffer=t,s.connect(e.destination),s.addEventListener("ended",this.handleEnded.bind(this)),s.addEventListener("error",this.handleError.bind(this,o)),s.start(),0===this.activeBufferIndex&&this.onStart&&this.onStart()}}handleError(e,t=null){this.error(e,t)}handleEnded(){this.activeSource&&(this.activeSource.disconnect(),this.activeSource=null),this.audioBuffers&&this.stream?(this.audioBuffers[this.activeBufferIndex]=null,this.stream.finished&&this.stream.index===this.activeBufferIndex?this.finished():(this.activeBufferIndex++,this.audioBuffers[this.activeBufferIndex]&&this.playBuffer(!0))):this.clean()}}},function(e,t,s){"use strict";t.__esModule=!0,t.SharePresenter=void 0;var i=s(135);class n extends i.ListboxPresenter{constructor(e){super(e),this.on("itemSelected",function(){this.share()})}share(){const e=this.getModel();return e.share(),this.emit("share",e.getParams())}write(){const e=this.getModel();return e.write(),this.emit("write",e.getMailParams())}setLink(e){return this.getModel().setProperty("link",e),this}setTitle(e){return this.getModel().setProperty("title",e),this}setDescription(e){return this.getModel().setProperty("description",e),this}}t.SharePresenter=n},function(e,t,s){"use strict";t.__esModule=!0,t.ShareModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(72);const o="telegram",a="whatsapp",l="odnoklassniki";class c extends r.ListboxModel{share(){const e=this.getParams(),t=encodeURIComponent(e.url).replace(/%2520/g,"%2B");let s;s=e.service===o?`https://telegram.me/share/url?text=${e.title}&url=${t}`:e.service===a?"whatsapp://send?text="+t:e.service===l?`https://connect.ok.ru/offer?url=${t}&title=${encodeURIComponent(e.title)}`:this.getProperty("url")+"?"+n.default.toQueryString(e),window.open(s)}write(){window.location.href="mailto:?"+n.default.toQueryString(this.getMailParams())}getParams(){const e=this.toJSON();return{url:e.link,title:e.title,service:e.value,description:e.description}}getDefaults(){return{url:"",link:"",title:"",value:"",items:"",description:""}}getMailParams(){const e=this.toJSON();return{subject:e.title,body:e.description}}}t.ShareModel=c},function(e,t,s){"use strict";t.__esModule=!0,t.TTSPresenter=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(20),o=s(136);class a extends r.Presenter{static normalizeText(e){return n.default.trim(e.replace(/[^\S\r\n]+/g," "))}constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();this._players=[],s.on("tap",()=>{s.hasState("playing")&&this._onActionStarted({action:o.PLAYER_ACTIONS.STOP,manual:!0}),s.hasState("invalid")?this.emit("invalidState",i.toJSON()):this.toggle()}).on("stateChanged:invalid",function(e){t.emit("toggleValid",!e)}),i.onChange(["text","lang"],()=>{this._updatePlayerState()})}_updatePlayerState(){const e=this.getView(),t=this.getModel(),{text:s,lang:i}=t.getProps();this.stop(),this._resetPlayingCounter(),this.getPlayerState(s,i,function(s){e.setState("invalid",s!==o.PLAYER_STATES.OK),t.setProperty("state",s)})}stop(){const e=this._players.some(e=>e.isActive());this._players.forEach(e=>e.stop()),e&&!this.getView().hasState("silent")&&this._onActionStarted({action:o.PLAYER_ACTIONS.STOP,manual:!0})}play(){const{text:e,lang:t}=this.getProps(),s=!!Boolean(window.config.ENABLE_TTS_SLOWING)&&this._getPlayingCounter()%2;n.default.asyncFilter(this.getSortedPlayers(e,t),(i,n)=>i.play(e,t,s,e=>{e?this._incrementPlayingCounter():n(!1)}))}getPlayerState(e,t,s){n.default.asyncFilter(this._players,function(e,s){e.isLangSupported(t,s)},function(t){let i=t;return i.length?(i=i.filter(t=>t.isTextSupported(e)),i.length?(i=i.filter(t=>t.isTextSizeBelowLimit(e)),i.length?void s(o.PLAYER_STATES.OK):s(o.PLAYER_STATES.TEXT_SIZE_EXCEEDED)):s(o.PLAYER_STATES.TEXT_NOT_SUPPORTED)):s(o.PLAYER_STATES.LANG_NOT_SUPPORTED)})}getSortedPlayers(e,t){return this._players.map(s=>[s.getPriority(e,t),s]).sort(([e],[t])=>t-e).map(([e,t])=>t)}toggle(){const e=this.isActive();return e?this.stop():this.play(),!e}isActive(){return this._players.some(function(e){return e.isActive()})}isValid(e,t,s){this.getPlayerState(e,t,e=>{s(e===o.PLAYER_STATES.OK)})}addPlayer(e){e.on("actionStarted",this._onActionStarted.bind(this)),e.on("playerUpdated",this._updatePlayerState.bind(this)),this._players.push(e)}setText(e){return this.getModel().setProperty("text",a.normalizeText(e)),this}setLanguage(e){return this.getModel().setProperty("lang",e),this}_getPlayingCounter(){return this.getModel().getProperty("counter")||0}_incrementPlayingCounter(){return this.getModel().setProperty("counter",this._getPlayingCounter()+1),this}_resetPlayingCounter(){return this.getModel().setProperty("counter",0),this}_onActionStarted(e){const t=this.getView(),s=e.action,{STOP:i,LOAD:n,PLAY:r}=o.PLAYER_ACTIONS;t.setState({silent:s===i,loading:s===n,playing:s===r}),this.emit("actionStarted",{...e,...this.getProps()})}}t.TTSPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.HISTORY_APP_EVENTS=t.AbstractHistoryModule=void 0;var i=s(5),n=s(238),r=s(184),o=s(185);const a={PRE_OPEN_HISTORY:"preOpenHistory",OPEN_HISTORY:"openHistory"};t.HISTORY_APP_EVENTS=a;class l extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="history",this.recordFields=["text","translation","srcLang","dstLang"],this.historyCache=this.makeHistoryCache(),this.historyCollection=this.makeHistoryCollection(),this.history=this.makeHistoryComponent(),this.updateHistoryAsync=this.debounceMethod(this.updateHistory,1e3),this.updateHistorySessionAsync=this.debounceMethod(this.updateHistorySession,500),this.listenApp(),this.listenAppModel(),this.listenHistoryCollection(),this.listenHistoryComponent(),this.updateHistorySettingState(),this.historyCache.getSessionRecord()&&(this.historyCollection.processRecord(this.historyCache.getSessionRecord()),this.historyCache.setSessionRecord(null))}makeHistoryCache(){return new r.HistoryCache({},{name:r.STORE_KEY,maxItems:this.appConfig.MAX_HISTORY_SHOW})}makeHistoryCollection(){return new n.HistoryCollection({maxTextLength:this.appConfig.MAX_FAV_TEXT_LENGTH,maxRecords:this.appConfig.MAX_HISTORY_RECORDS})}makeHistoryComponent(){}getRecord(){const e={};return this.recordFields.forEach(t=>{e[t]=this.appModel.getProperty(t)}),e}isHistorySettingEnabled(){return this.appSettings.isOptionEnabled("history")}updateHistorySettingState(){const e=this.isHistorySettingEnabled();this.appModel.setProperty({historyEnabled:e}),this.history.setSettingState(e),this.historyEnabled=e}updateHistory(){this.historyEnabled&&this.historyCollection.processRecord(this.getRecord())}updateHistorySession(){if(this.historyEnabled){const e=this.getRecord();this.historyCache.setSessionRecord(this.historyCollection.isRecordValid(e)?e:null)}}listenAppModel(){this.appModel.onChange(this.recordFields,()=>{this.updateHistorySessionAsync()}).onChange("translation",e=>{this.history.setVisible(!e)})}listenApp(){this.app.on("databaseError",()=>{this.historyCollection.setProperty("updating",!1)})}listenHistoryCollection(){this.historyCollection.onChange("records",e=>{this.historyCache.setRecords(e)})}listenHistoryComponent(){this.history.on(o.HISTORY_EVENTS.OPEN_HISTORY,()=>{this.app.emit(a.PRE_OPEN_HISTORY),this.historyCollection.isReady()?this.app.emit(a.OPEN_HISTORY):this.historyCollection.onceReady(()=>{this.app.emit(a.OPEN_HISTORY)})}).on(o.HISTORY_EVENTS.APPLY_ITEM,({text:e,srcLang:t,dstLang:s})=>{this.appModel.setProperty({text:e,srcLang:t,dstLang:s},{sender:"translationHistory"})})}}t.AbstractHistoryModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.COLLECTION_EVENTS=void 0,t.getCollectionsEmitter=function(){return i};const i=new(s(9).Emitter);t.COLLECTION_EVENTS={SYNCED:"synced",DB_READY:"dbReady",INIT:"init",COLLECTIONS_SET:"collectionsSet"}},function(e,t,s){"use strict";t.__esModule=!0,t.STORE_KEY=t.HistoryCache=t.HISTORY_CACHE_FIELDS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(63);t.STORE_KEY="yTrHistory";const a={RECORDS:"records",SESSION_RECORD:"sessionRecord"};t.HISTORY_CACHE_FIELDS=a;class l extends o.Storage{constructor(e,t={}){super(e,t);const{maxItems:s=10}=t;this.maxItems=s,this.getRecords()||this.setRecords([])}setRecords(e){return!1}getRecords(){return this.getProperty(a.RECORDS)}setSessionRecord(e){return this.getSpace()<n.default.safeStringifyJSON(e).length?(r.$tracker.sendMetric("storage_error",{record_size:n.default.safeStringifyJSON(e)}),this):this.setProperty(a.SESSION_RECORD,e)}getSessionRecord(){return this.getProperty(a.SESSION_RECORD)}}t.HistoryCache=l,l.defaults={records:[],sessionRecord:null}},function(e,t,s){"use strict";t.__esModule=!0,t.HISTORY_METRIKAS=t.HISTORY_EVENTS=t.AbstractHistoryComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(6),o=s(184),a=s(3);const l={APPLY_ITEM:"applyItem",OPEN_HISTORY:"openHistory"};t.HISTORY_EVENTS=l;const c={APPLY_ITEM:"applyItem",OPEN_HISTORY:"openHistory"};t.HISTORY_METRIKAS=c;const{$track:d}=(0,a.getTrackerByNamespace)(c);class u extends r.Component{constructor(e,t){super(e,t);const{storageModel:s}=e;s.onChange(o.HISTORY_CACHE_FIELDS.RECORDS,()=>this.updateComponent()),this.onChange("settingEnabled",()=>this.updateComponent()),this.updateComponent()}updateComponent(){const{storageModel:e,settingEnabled:t}=this.getProps();this.setEnabled(e.getRecords().length>0&&t),this.update()}setSettingState(e){return this.setProperty("settingEnabled",e)}applyItem(e,t){d(c.APPLY_ITEM,{index:t}),this.emit(l.APPLY_ITEM,e)}openHistoryCollection(e){d(c.OPEN_HISTORY,{source:e}),this.emit(l.OPEN_HISTORY)}getItems(){const{storageModel:e,maxItems:t}=this.getProps();return e.getRecords().slice(0,t)}getLangDir(e){return n.default.isRTLLang(e)?"rtl":"ltr"}}t.AbstractHistoryComponent=u,u.defaults={settingEnabled:!0,maxItems:10}},function(e,t,s){"use strict";t.__esModule=!0,t.getAvailablePlayers=function(e,t){const s=e.FORCE_UNIPROXY,o=!s,a=[];return!s&&i.TTSNativePlayer.isAvailable()&&a.push(new i.TTSNativePlayer({rate:e.TTS_RATE,maxTextLength:e.MAX_NATIVE_TTS_LENGTH})),r.TTSUniproxyPlayer.isAvailable()&&a.push(new r.TTSUniproxyPlayer({uniproxy:t,maxTextLength:e.MAX_UNIPROXY_TTS_LENGTH})),n.TTSOnlinePlayer.backendSupportedFormats.find(({format:t,quality:s})=>!(!o||!n.TTSOnlinePlayer.isAvailable(t)||(a.push(new n.TTSOnlinePlayer({speakerUrl:e.TTS_URL,speakerLangs:e.TTS_LANGS,maxTextLength:e.MAX_TTS_LENGTH,params:{format:t,quality:s,chunked:64,platform:"web","mock-ranges":1,application:"x-protobuf"}})),0))),a},t.isScreenNarrow=function(e){return window.innerWidth<e.NARROW_SCREEN_WIDTH};var i=s(239),n=s(240),r=s(241)},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractStream=void 0;var i=s(243);t.AbstractStream=class{constructor({onBufferReady:e}){this.pendingBuffer=null,this.index=-1,this.finished=!1,this.breaked=!1,this.preloadBufferSize=void 0,this.bufferSize=void 0,this.onBufferReady=e}add(e){}getChunk(e){}createBuffer(e=0){this.index++,this.pendingBuffer=new i.PackageBuffer(Math.max(e,0===this.index?this.preloadBufferSize:this.bufferSize))}insert(e,t){const s=t?t.byteLength:0,i=e.byteLength+s;this.pendingBuffer||this.createBuffer(i),this.pendingBuffer&&(this.pendingBuffer.add(e,t)||(this.ready(),this.createBuffer(i),this.pendingBuffer.add(e,t)))}finish(){this.finished=!0,this.ready()}break(){this.breaked=!0,this.pendingBuffer=null}ready(){this.pendingBuffer?(this.onBufferReady(this.getChunk(this.pendingBuffer.relax()),this.index),this.pendingBuffer=null):this.onBufferReady(void 0,this.index)}}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslitModel=void 0;var i=s(8),n=s(29),r=s(65),o=s(17),a=s(251);class l extends r.SyncModel{getData(){const{lang:e,text:t}=this.getProps();return{lang:e,text:t}}getParams(){const{sid:e,srv:t}=this.getProps();return{sid:e,srv:t}}getDefaults(){return{sid:"",srv:"",url:"/",lang:"",text:"",translit:""}}validateResponse(e){return e&&"string"==typeof e.body&&e.body}runRequest(){const e=new o.HTTPRequest(this.getProperty("url"));if(this.abort(),!this.isValid())return this;const t=this.getData();return this.setRequest(e.setType(o.HTTPRequest.types.FORM).setData(t).setParams(this.getParams()).setMethod(o.HTTPRequest.methods.POST).send((e,t)=>{const s=e&&e.code===n.HTTPError.ABORT;!(t&&t.code===o.HTTPRequest.codes.OK)||s||this.validateResponse(t)||(0,i.logError)(new a.TranslitApiError),e&&this.emit("error",e),this.setProperty("translit",e?"":t.body)}))}requestTranslit(){return this.getSid().then(()=>this.runRequest()),this}}t.TranslitModel=l},function(e,t,s){"use strict";t.__esModule=!0,t.TranslitPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(20);class o extends r.Presenter{constructor(e={}){super(e);const t=this,s=this.getView();this.getModel().on("error",function(e){t.emit("error",e)}).on("change",function(e,i){switch(e){case"lang":case"text":t.requestTranslit();break;case"translit":t.emit("result",i),s.setVisible(i).setTextContent(i)}}).on("invalid",function(){this.setProperty("translit","")}),this.requestTranslit=n.default.debounce(this.requestTranslit,e.debounceDelay||200)}getLang(){return this.getModel().getProperty("lang")}getText(){return this.getModel().getProperty("text")}setLang(e){return this.getModel().setProperty("lang",e),this}setText(e){return this.getModel().setProperty("text",e),this}requestTranslit(){return this.getModel().requestTranslit(),this}}t.TranslitPresenter=o},function(e,t,s){"use strict";t.__esModule=!0,t.Suggestions=t.SUGGESTIONS_TYPES=t.SUGGESTIONS_METRIKAS=t.SUGGESTIONS_EVENTS=t.SUGGESTIONS_APPLYING_SOURCES=void 0;var i=s(6),n=s(16),r=s(3);const o={APPLY:"apply",ITEMS_UPDATED:"itemsUpdated"};t.SUGGESTIONS_EVENTS=o;const a={SHOW:"show",APPLY:"apply",ITEM_HOVER:"itemHover",ITEM_NAVIGATE:"itemNavigate"};t.SUGGESTIONS_METRIKAS=a;const l={SUGGEST:"suggest",PREDICT:"predict"};t.SUGGESTIONS_TYPES=l;const c={CLICK:"click",ENTER:"enter",TAB:"tab"};t.SUGGESTIONS_APPLYING_SOURCES=c;const{$track:d}=(0,r.getTrackerByNamespace)(a);class u extends i.Component{constructor(e,t){super(e,t);const{model:s}=e,i=["predictions","suggestions"];s.onChange(i,(e,t)=>{this.resetActiveIndex(),this.setProperty(e,t?t.predictions.filter(t=>"suggestions"!==e||!this.hasPrediction(t.src)):[])}),this.onChange(e=>{this.updateAsync({field:e})}).onRendered(({field:e})=>{i.includes(e)&&this.emit(o.ITEMS_UPDATED)}).onStateChanged([n.VIEW_STATES.HIDDEN,n.VIEW_STATES.DISABLED],()=>{this.isVisible()&&this.isEnabled()&&d(a.SHOW,this.getTrackingParams())})}hasPrediction(e){return this.getProperty("predictions").some(({src:t})=>t.toLowerCase()===e.toLowerCase())}getTrackingParams(){const{model:e}=this.getProps();return{lang:e.getLangPair()}}getActiveIndex(){return this.getProperty("activeIndex")}getTypeByIndex(e){const{suggestions:t,predictions:s}=this.getProps();return e<s.length?l.PREDICT:e<t.length+s.length?l.SUGGEST:null}applyItem(e,t,{index:s,source:i}){return d(a.APPLY,{...this.getTrackingParams(),len:e.src.length,type:t,index:s,source:i}),this.emit(o.APPLY,e,t)}applySuggest(e,t){return this.applyItem(e,l.SUGGEST,t)}applyPredict(e,t){return this.applyItem(e,l.PREDICT,t)}applyActiveItem(e){const{suggestions:t,predictions:s,activeIndex:i}=this.getProps();if(i<s.length)this.applyPredict(s[i],{source:e,index:i});else if(i<t.length+s.length){const n=i-s.length;this.applySuggest(t[n],{source:e,index:n})}return this}updateActiveIndex(e){if(!this.isEnabled())return;const{suggestions:t,predictions:s,activeIndex:i}=this.getProps(),n=t.length+s.length;let r=i+e;r<0?r=n-1:r>=n&&(r=0);const o=this.getTypeByIndex(r),c=o===l.PREDICT?r:r-s.length;return d(a.ITEM_NAVIGATE,{...this.getTrackingParams(),index:c,type:o}),this.setActiveIndex(r)}setActiveIndex(e){return this.setProperty({activeIndex:e})}resetActiveIndex(){return this.setActiveIndex(0)}handlePosition(e,t=!1){return this.setPosition(e,t)}onHoverPredict(e){if(this.getActiveIndex()!==e)return d(a.ITEM_HOVER,{...this.getTrackingParams(),index:e,type:l.PREDICT}),this.setActiveIndex(e)}onHoverSuggest(e,t){if(this.getActiveIndex()!==e+t)return d(a.ITEM_HOVER,{...this.getTrackingParams(),index:e,type:l.PREDICT}),this.setActiveIndex(e+t)}onClickPredict(e){const{predictions:t}=this.getProps();return this.applyPredict(t[e],{index:e,source:c.CLICK})}onClickSuggest(e){const{suggestions:t}=this.getProps();return this.applySuggest(t[e],{index:e,source:c.CLICK})}template({html:e,nothing:t,cn:s}){const{suggestions:i,predictions:n,activeIndex:r,model:o}=this.getProps(),{srcLang:a,dstLang:l}=o.getProps(),c=n.length&&i.length&&!o.arePosesEqual(),d=1===n.length&&!i.length,u=s("suggestions-item"),h=s("suggestions-wrapper");return e`
            <div class=${h({no_predict_prefix:!c,single_predict:d})}>
                ${n.map(({src:t,dst:s},i)=>e`
                    <div class=${u({predict:!0,active:i===r,no_dst:!s})}
                        @mouseover=${()=>this.onHoverPredict(i)}
                        @click=${()=>this.onClickPredict(i)}>
                        <div class=${u("value")} lang=${a}>${t}</div>
                        ${s&&e`<div class=${u("translation")} lang=${l}>${s}</div>`}
                    </div>
                `)}
                ${i.length&&n.length?e`
                    <div class="suggestions-divider"></div>
                `:t}
                ${i.map(({src:t,dst:s},i)=>e`
                    <div class=${u({suggest:!0,active:i+n.length===r})}
                        @mouseover=${()=>this.onHoverSuggest(i,n.length)}
                        @click=${()=>this.onClickSuggest(i)}>
                        <div class=${u("value")} lang=${a}>${t}</div>
                        ${s&&e`<div class=${u("translation")} lang=${l}>${s}</div>`}
                    </div>
                `)}
            </div>
        `}}t.Suggestions=u,u.defaults={suggestions:[],predictions:[],activeIndex:0}},function(e,t,s){"use strict";t.__esModule=!0,t.History=void 0,s(15);var i=s(185);t.HISTORY_EVENTS=i.HISTORY_EVENTS,t.HISTORY_METRIKAS=i.HISTORY_METRIKAS;class n extends i.AbstractHistoryComponent{getItems(){const{storageModel:e,maxItems:t}=this.getProps();return e.getRecords().slice(0,t)}template(){return!1}}t.History=n,n.defaults={settingEnabled:!0,maxItems:5}},function(e,t,s){"use strict";t.__esModule=!0,t.initTTSPlayer=t.TTS_APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(181),o=s(136),a=s(2),l=s(4),c=(s(3),s(46)),d=s(186);const u={SPEAKER_ACTION:"speakerAction"};t.TTS_APP_EVENTS=u,t.initTTSPlayer=function(e){const t=this,s=this.getView(),i=this.getModel(),h=this.toJSON(),p=new a.TouchView({element:e.ELEMENTS.textSpeaker,stopDefaultAction:!0}),g=new a.TouchView({element:e.ELEMENTS.translatorSpeaker,stopDefaultAction:!0}),E=new r.TTSPresenter({view:p,model:new l.Model}),_=new r.TTSPresenter({view:g,model:new l.Model}),T=()=>{E.stop(),_.stop()};[E,_].forEach(t=>{(0,d.getAvailablePlayers)(e,this._uniproxy).forEach(e=>{t.addPlayer(e)})}),this.on("visibilityChange",function(e){e&&T()}).on("dialogTap",T).bindFocusActivation(p).bindFocusActivation(g),i.on("change",function(e,t){switch(e){case"text":E.setText(t);break;case"srcLang":E.setLanguage(t);break;case"dstLang":_.setLanguage(t);break;case"translation":case"userTranslation":_.setText(t)}}),s.on("stateChanged:listening",e=>{e&&T()});const m={};E.on("actionStarted",function(e){return!1}).on("toggleValid",function(e){p.setEnabled(e)}),_.on("actionStarted",function(e){switch(e.action){case o.PLAYER_ACTIONS.LOAD:E.stop(),s.setState("listening",!1);break;case o.PLAYER_ACTIONS.PLAY:case o.PLAYER_ACTIONS.ERROR:t.emit(u.SPEAKER_ACTION,e);break;case o.PLAYER_ACTIONS.STOP:m(_,e.manual)}}).on("toggleValid",function(e){g.setEnabled(e)});const f=t=>{t.getModel().onChange("state",s=>{s===o.PLAYER_STATES.OK?t.getView().setTooltipText(e.LOCALIZATIONS.ttsValidState):s===o.PLAYER_STATES.LANG_NOT_SUPPORTED?t.getView().setTooltipText(e.LOCALIZATIONS.ttsInvalidLangState):s!==o.PLAYER_STATES.TEXT_SIZE_EXCEEDED&&s!==o.PLAYER_STATES.TEXT_NOT_SUPPORTED||t.getView().setTooltipText(e.LOCALIZATIONS.ttsInvalidTextSizeState)})};f(E),f(_);const S=()=>{p.setTooltipPosition(document.body.clientWidth<1400?"top-right":"top")};return this.on("resize",n.default.throttle(S,500)),S(),this.addHotKey(c.HOT_KEYS_MAP.SRC_TTS,{view:p,getActionName:()=>"src_tts"}).addHotKey(c.HOT_KEYS_MAP.DST_TTS,{view:g,getActionName:()=>"dst_tts"}),h.text&&E.setText(h.text),h.srcLang&&E.setLanguage(h.srcLang),h.dstLang&&_.setLanguage(h.dstLang),h.translation&&_.setText(h.translation),this}},function(e,t,s){"use strict";t.__esModule=!0,t.getDefinitionAndAbbreviationsInfo=function({definition:e,abbreviations:t}){const s=Boolean(e),i=n.default.isNonEmptyArray(t);return{hasDefinition:s,hasAbbreviations:i,hasDefinitionOrAbbreviations:s||i}};var i,n=(i=s(0))&&i.__esModule?i:{default:i}},,,,,,function(e,t,s){"use strict";s(73);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(71),o=s(2),a=s(4),l=s(167),c=s(168),d=s(23),u=(s(202),s(106)),h=(s(125),s(128),s(129)),p=(s(204),s(205),s(207)),g=(s(271),s(272),s(273),s(276)),E=s(279),_=(s(284),s(288),s(292),s(294),s(296),s(297)),T=(s(302),s(312),s(313),s(314)),m=s(315);window.initTextApp=(e=>{(0,r.rumSendTimeMark)(r.RUM_COUNTERS.APP_INIT_START),(0,r.rumTimeStart)(r.RUM_COUNTERS.APP_INIT_DURATION),function(e){!function(t,s,i,n){const r=i(46),o=i.apply(void 0,[83,73,68]);e[o]=e[o].split(r).map(function(e){return e.split("").reverse().join("")}).join(r)}(0,0,String.fromCharCode)}(e);const{initialSourceLang:t,initialTargetLang:s}=d.TranslateApplication.getInitialLangs(document.body);e.DEFAULT_TEXT=document.body.getAttribute("data-text"),e.DEFAULT_SRC_LANG=t,e.DEFAULT_DST_LANG=s,e.TEMPLATES=(0,T.getTextTemplates)(),e.ELEMENTS=(0,m.getTextElements)();const i=new p.TextTranslateApplication({config:e,view:new o.TouchView({element:document.documentElement,ignoreSelection:!0,DOMEvents:`keydown keypress ${o.TouchView.eventTypes.MOVE} copy`}),model:new a.Model({text:"",trText:"",selText:"",srcLang:"",dstLang:"",tooltip:"",complaint:!1,timestamp:Date.now(),textScrollY:0,translation:"",spellerData:"",sourceTranslit:"",targetTranslit:"",userTranslation:"",translationScrollY:0,leadSpacingsCount:0},{validators:{srcLang:e=>n.default.hasProperty(d.TranslateApplication.getAllSrcLangs(),e),dstLang:e=>n.default.hasProperty(d.TranslateApplication.getAllDstLangs(),e)}})});return i.initTextArea(e),i.registerModule(u.DesktopLanguagesModule),e.ENABLE_SEO_SSR||i.registerModule(g.DictionaryModule).registerModule(E.ExamplesModule),i.initUniproxy(e).initTTSPlayer(e).initSpeechRecognition(e),e.USE_FAKEAREA&&i.initSourceTranslit(e),e.ENABLE_STORIES&&i.registerModule(_.StoriesModule),e.ENABLE_COLLECTION&&(e.SUBSCRIPTION_MENU_ITEMS=n.default.extend(e.SUBSCRIPTION_MENU_ITEMS,{subscribe:{icon:"add",title:e.LOCALIZATIONS.collectionSubscribe,action:"subscribe"}})),e.LANDING_TYPE?e.LANDING_TYPE===d.LANDING_TYPES.TRANSLATOR?(e.CLCK_PATH="web_desktop.landing.translate",p.TextTranslateApplication.isHistoryAvailable()&&(e.DEFAULT_TEXT||window.history.state||window.history.replaceState({},""),i.initHistory(e)),i.initDescription(e)):e.LANDING_TYPE===d.LANDING_TYPES.DICTIONARY&&(e.DICT_PAGE_DESCRIPTION=!0,e.CLCK_PATH="web_desktop.landing.dict",p.TextTranslateApplication.isHistoryAvailable()&&(window.history.replaceState({trText:e.DEFAULT_TEXT,srcLang:e.DEFAULT_SRC_LANG,dstLang:e.DEFAULT_DST_LANG},""),i.getModel().once("change:translation",function(){i.initHistory(e)})),i.initDescriptionDict(e)):(p.TextTranslateApplication.isHistoryAvailable()&&(e.DEFAULT_TEXT||window.history.state||window.history.replaceState({},""),i.initHistory(e)),i.initDescription(e)),e.ENABLE_LANG_SWITCHERS&&i.registerModule(h.LangSwitcherModule),l.Database.isSupported()&&(c.CollectionModel.generateColorRules(document.getElementById("collectionColors"),"clts .collection-color"),i.initCollections(e)),i.emit(d.TRANSLATE_APP_EVENTS.INIT_DONE),(0,r.rumTimeEnd)(r.RUM_COUNTERS.APP_INIT_DURATION),i})},function(e,t,s){"use strict";t.__esModule=!0,t.KeyGenerator=void 0;class i{static getRadix(){return this._CHARS.length}static getCharAt(e){return this._CHARS.charAt(e)}static generateRandomStr(e){let t="";const s=this.getRadix();for(;t.length<e;)t+=this.getCharAt(Math.floor(Math.random()*s));return t}static convertInt(e){let t=e,s="";const i=this.getRadix();do{s=this.getCharAt(t%i)+s,t=Math.floor(t/i)}while(t>0);return s}constructor(e,t){const s=this.constructor;this._maxLength=e||s.DEFAULT_LENGTH,this._maxCounterDigits=t||s.DEFAULT_COUNTER_DIGITS,this._counter=this._generateCounter()}generate(){const e=this.constructor;let t=e.convertInt(Date.now())+e.convertInt(this._counter);return this._incrementCounter(),t+=e.generateRandomStr(this._maxLength-t.length),t}_getCounterLimit(){return Math.pow(this.constructor.getRadix(),this._maxCounterDigits)}_generateCounter(){return Math.floor(Math.random()*this._getCounterLimit())}_incrementCounter(){this._counter=(this._counter+1)%this._getCounterLimit()}}t.KeyGenerator=i,i._CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i.DEFAULT_COUNTER_DIGITS=2,i.DEFAULT_LENGTH=14},function(e,t,s){"use strict";t.__esModule=!0,t.DB_STORES=t.DB_INDEXES=t.CollectionDatabase=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(8),o=s(167),a=s(146);const l={COLLECTIONS:"collections",RECORDS:"records"};t.DB_STORES=l;const c={BY_COLLECTION:"by_collection_id",BY_RECORD:"by_record",BY_RECORD_HASH:"by_record_hash",BY_DATE:"by_creation_date",BY_COLLECTION_AND_DATE:"by_collection_and_date",BY_COLLECTION_AND_DATE_KEY:"by_collection_and_date_key"};t.DB_INDEXES=c;class d extends o.Database{static sameRecordData(e,t){return e.text===t.text&&e.lang===t.lang&&e.translation===t.translation}static getTextHash(e){let t,s=5381;const i=e.lang+e.text+e.translation,n=i.length;for(t=0;t<n;t++)s=33*s^i.charCodeAt(t);return(s>>>0).toString(16)}static getTextHashKey(e,t=e.collectionId){return this.getTextHash(e)+"::"+t}static getCreationTimeKey(e){let t=String(1e3*e.creationTimestamp);for(;t.length<13;)t="0"+t;return e.collectionId+"::"+t}constructor(e,t){super(e),this._migrateParams=t.migrateParams}prepareRecord(e,t){return e.id=e.id||this.generateKey(),e.collectionId=e.collectionId||t.id,e.creationTimestamp||(e.creationTimestamp=a.CollectionServerModel.getTimestamp()),e.creationTimeKey=d.getCreationTimeKey(e),e.modificationTimestamp=e.modificationTimestamp||e.creationTimestamp,t.type!==a.COLLECTION_TYPES.FAVORITES&&t.type!==a.COLLECTION_TYPES.COLLECTION||(e.textHashKey=d.getTextHashKey(e)),e}cloneRecord(e){return{text:e.text,lang:e.lang,score:e.score,status:a.COLLECTION_STATUSES.ADDED,translation:e.translation,creationTimestamp:e.creationTimestamp,modificationTimestamp:e.modificationTimestamp}}createDatabase(e){const t=e.target.result,s=t.createObjectStore(l.COLLECTIONS,{keyPath:"id"}),i=t.createObjectStore(l.RECORDS,{keyPath:"id"});s.createIndex(c.BY_DATE,"creationTimestamp",{unique:!1}),i.createIndex(c.BY_COLLECTION,"collectionId",{unique:!1}),i.createIndex(c.BY_RECORD_HASH,"textHashKey",{unique:!1}),i.createIndex(c.BY_COLLECTION_AND_DATE_KEY,"creationTimeKey",{unique:!1}),s.add(this.getFavoritesCollectionParams()),s.add(this.getHistoryCollectionParams())}upgradeDatabase(e){try{e.oldVersion<2&&this._upgradeDatabase2(e),e.oldVersion<5&&this._upgradeDatabase5(e)}catch(t){(0,r.logError)(t,{version:e.oldVersion})}}_upgradeDatabase2(e){const t=this,s={},i=e.target.transaction,n=i.objectStore(l.RECORDS),r=i.objectStore(l.COLLECTIONS);n.deleteIndex(c.BY_RECORD),n.deleteIndex(c.BY_COLLECTION_AND_DATE),n.createIndex(c.BY_RECORD_HASH,"textHashKey",{unique:!1}),n.createIndex(c.BY_COLLECTION_AND_DATE_KEY,"creationTimeKey",{unique:!1}),r.openCursor().onsuccess=function(e){const i=e.target.result;if(i){const e=i.value;s[e.id]=e,i.continue()}else n.openCursor().onsuccess=function(e){const i=e.target.result;if(i){const e=s[i.value.collectionId];e?i.update(t.prepareRecord(i.value,e)):i.delete(),i.continue()}else t.addTrace("migrFnsh")}}}_upgradeDatabase5(e){const t=e.target.transaction,s=t.objectStore(l.RECORDS),i=t.objectStore(l.COLLECTIONS),n=(t,s,i)=>{t.indexNames.contains(s)||(this.emit("indexNotFound",{indexName:s,version:e.oldVersion}),t.createIndex(s,i,{unique:!1}))};n(s,c.BY_RECORD_HASH,"textHashKey"),n(s,c.BY_COLLECTION,"collectionId"),n(s,c.BY_COLLECTION_AND_DATE_KEY,"creationTimeKey"),n(i,c.BY_DATE,"creationTimestamp")}getFavoritesCollectionParams(){const e=this._migrateParams;return{id:this.generateKey(),attributesTimestamp:a.CollectionServerModel.getTimestamp(),creationTimestamp:0,type:a.COLLECTION_TYPES.FAVORITES,name:e.defaultFavName,public:!1,status:a.COLLECTION_STATUSES.ADDED,version:0,recordsCount:0}}getHistoryCollectionParams(){const e=this._migrateParams;return{id:this.generateKey(),attributesTimestamp:a.CollectionServerModel.getTimestamp(),creationTimestamp:0,type:a.COLLECTION_TYPES.HISTORY,name:e.defaultHistoryName,public:!1,status:a.COLLECTION_STATUSES.ADDED,version:0,recordsCount:0}}createHistoryCollection(){this.createCollection(this.getHistoryCollectionParams(),{subscribe:!1})}createCollection(e,t={}){const s=this._db.transaction(l.COLLECTIONS,"readwrite"),i=s.objectStore(l.COLLECTIONS);e.id=this.generateKey(),s.oncomplete=(()=>{t.silent||this.emit("added",e,t)}),s.onerror=(e=>{this.emit("error",e,"createCollection")}),i.add(e)}getCollections(e={}){const t=this.safeTransaction(l.COLLECTIONS);if(!t)return this.waitReconnect(()=>this.getCollections(e));const s=this,i=[],n=window.IDBKeyRange.bound(0,Number.MAX_VALUE);t.objectStore(l.COLLECTIONS).index(c.BY_DATE).openCursor(n).onsuccess=function(t){const s=t.target.result;s&&((e.sync||s.value.status!==a.COLLECTION_STATUSES.DELETED)&&i.push(s.value),s.continue())},t.oncomplete=function(){s.emit("collections",i,e)},t.onerror=function(e){s.emit("error",e,"getCollections")}}checkRecord(e){try{this.checkRecordUnsafe(e)}catch(e){this.emit("checkRecordError",e)}}checkRecordUnsafe(e){const t=this.safeTransaction(l.RECORDS);if(!t)return this.waitReconnect(()=>this.checkRecordUnsafe(e));let s;const i=this,n=d.getTextHashKey(e),r=window.IDBKeyRange.only(n);t.objectStore(l.RECORDS).index(c.BY_RECORD_HASH).openCursor(r).onsuccess=function(t){const i=t.target.result;if(i){const t=i.value;!s&&t.status!==a.COLLECTION_STATUSES.DELETED&&d.sameRecordData(t,e)&&(s=!0),i.continue()}},t.oncomplete=function(){i.emit("checked",s)},t.onerror=function(e){i.emit("error",e,"checkRecordUnsafe")}}getRecordsByCollection(e,t={}){if(!e)return;const s=this.safeTransaction(l.RECORDS);if(!s)return this.waitReconnect(()=>this.getRecordsByCollection(e,t));const i=[],n=e+d.INDEX_BEGIN,r=e+d.INDEX_END,o=window.IDBKeyRange.bound(n,r);s.objectStore(l.RECORDS).index(c.BY_COLLECTION_AND_DATE_KEY).openCursor(o,"prev").onsuccess=function(e){const s=e.target.result;s&&((t.sync||s.value.status!==a.COLLECTION_STATUSES.DELETED)&&i.push(s.value),s.continue())},s.oncomplete=(()=>{this.emit("records",i,e,t)}),s.onerror=(e=>{this.emit("error",e,"getRecordsByCollection")})}addRecords(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.addRecords(e,t));let i=0;const n=this,r=t.id,o=s.objectStore(l.RECORDS),u=s.objectStore(l.COLLECTIONS),h=o.index(c.BY_RECORD_HASH);s.oncomplete=function(){n.emit("addedRecords",r)},s.onerror=function(e){n.emit("error",e,"addRecords")},e.forEach(function(e,s,l){const c=l.length;let p;const g=d.getTextHashKey(e),E=window.IDBKeyRange.only(g);h.openCursor(E).onsuccess=function(l){const h=l.target.result;h?(!p&&d.sameRecordData(h.value,e)&&(p=h.value),h.continue()):(p?p.status===a.COLLECTION_STATUSES.DELETED&&(p.score=0,p.status=a.COLLECTION_STATUSES.UPDATED,p.modificationTimestamp=e.modificationTimestamp,o.put(p),i++):(o.add(n.prepareRecord(e,t)),i++),s===c-1&&(u.get(r).onsuccess=function(e){const t=e.target.result;t&&(t.status=a.COLLECTION_STATUSES.UPDATED,t.recordsCount=(t.recordsCount||0)+i,u.put(t))}))}})}addCollection(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.addCollection(e,t));const i=this,n=s.objectStore(l.RECORDS);e.id=this.generateKey(),e.recordsCount=t.new.length,s.objectStore(l.COLLECTIONS).add(e).onsuccess=function(){t.new.forEach(function(t){n.add(i.prepareRecord(t,e))})},s.oncomplete=function(){i.emit("synced")},s.onerror=function(e){i.emit("error",e,"addCollection")}}updateCollection(e,t){const s=this.safeTransaction(l.RECORDS,"readwrite");if(!s)return this.waitReconnect(()=>this.updateCollection(e,t));let i=0;const n=this._db,r=this,o=s.objectStore(l.RECORDS);t.deleted.forEach(function(e){o.get(e.id).onsuccess=function(t){const s=t.target.result;s&&s.status!==a.COLLECTION_STATUSES.DELETED&&i++,o.delete(e.id)}}),s.oncomplete=function(){const s=n.transaction(n.objectStoreNames,"readwrite"),o=s.objectStore(l.RECORDS),a=s.objectStore(l.COLLECTIONS);a.get(e.id).onsuccess=function(s){const n=s.target.result;t.new.forEach(function(t){o.add(r.prepareRecord(t,e))}),t.updated.forEach(function(e){o.get(e.id).onsuccess=function(t){const s=t.target.result;Object.keys(e.params).forEach(function(t){s[t]=e.params[t]}),o.put(s)}}),Object.keys(e).forEach(function(t){n[t]!==e[t]&&(n[t]=e[t])});const l=(n.recordsCount||0)+t.new.length-i;n.recordsCount=l<0?0:l,a.put(n)},s.oncomplete=function(){r.emit("synced")},s.onerror=function(e){r.emit("error",e,"updateCollectionAdd")}},s.onerror=function(e){r.emit("error",e,"updateCollection")}}updateCollectionData(e,t){const s=this.safeTransaction(l.COLLECTIONS,"readwrite");if(!s)return this.waitReconnect(()=>this.updateCollectionData(e,t));const i=this,n=s.objectStore(l.COLLECTIONS);n.get(e).onsuccess=function(e){const s=e.target.result;Object.keys(t).forEach(function(e){s[e]=t[e]}),n.put(s)},s.oncomplete=function(){i.emit("collectionUpdated")},s.onerror=function(e){i.emit("error",e,"updateItem")}}deleteCollection(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.deleteCollection(e,t));const i=this,n=s.objectStore(l.RECORDS),r=s.objectStore(l.COLLECTIONS),o=window.IDBKeyRange.only(e),d=n.index(c.BY_COLLECTION);let u=!1;r.get(e).onsuccess=function(s){const i=s.target.result;t||!i.serverId?r.delete(e):(i.status=a.COLLECTION_STATUSES.DELETED,r.put(i)),u=i.type===a.COLLECTION_TYPES.SUBSCRIPTION},d.openCursor(o).onsuccess=function(e){const t=e.target.result;t&&(t.delete(),t.continue())},s.oncomplete=function(){i.emit("collectionDeleted",{unsubscribed:u})},s.onerror=function(e){i.emit("error",e,"deleteCollection")}}updateRecord(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.updateRecord(e,t));const i=this,n=s.objectStore(l.RECORDS);let r;n.get(e).onsuccess=function(e){const i=e.target.result,o=s.objectStore(l.COLLECTIONS),c=i.score+t.score;i.score=c<0?0:c,i.status=a.COLLECTION_STATUSES.UPDATED,i.modificationTimestamp=t.modificationTimestamp,n.put(i),r=i.collectionId,o.get(i.collectionId).onsuccess=function(e){const t=e.target.result;t&&(t.status=a.COLLECTION_STATUSES.UPDATED,o.put(t))}},s.oncomplete=function(){i.emit("recordUpdated",r)},s.onerror=function(e){i.emit("error",e,"updateRecord")}}updateHistoryRecord(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.updateHistoryRecord(e,t));const i=s.objectStore(l.RECORDS),n=s.objectStore(l.COLLECTIONS),r=i.index(c.BY_COLLECTION),o=window.IDBKeyRange.only(e),u=t.srcLang+"-"+t.dstLang;n.get(e).onsuccess=(e=>{const t=e.target.result;t&&(t.status=a.COLLECTION_STATUSES.UPDATED,n.put(t))}),r.openCursor(o).onsuccess=(e=>{const s=e.target.result;if(s){const e=s.value;e.translation===t.translation&&e.text===t.text&&e.lang===u&&(e.creationTimestamp=a.CollectionServerModel.getTimestamp(),e.modificationTimestamp=a.CollectionServerModel.getTimestamp(),e.creationTimeKey=d.getCreationTimeKey(e),e.status=a.COLLECTION_STATUSES.UPDATED,s.update(e)),s.continue()}}),s.oncomplete=(()=>{this.emit("recordUpdated",e)}),s.onerror=(e=>{this.emit("error",e,"updateHistoryRecord")})}deleteRecordByProps(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.deleteRecordByProps(e,t));const i=s.objectStore(l.RECORDS),n=s.objectStore(l.COLLECTIONS),r=i.index(c.BY_COLLECTION),o=window.IDBKeyRange.only(e),d=t.lang||t.srcLang+"-"+t.dstLang;n.get(e).onsuccess=(e=>{const t=e.target.result;t&&(t.recordsCount--,t.status=a.COLLECTION_STATUSES.UPDATED,n.put(t))}),r.openCursor(o).onsuccess=(e=>{const s=e.target.result;if(!s)return;const n=s.value;n.translation===t.translation&&n.text===t.text&&n.lang===d&&(n.serverId?(n.status=a.COLLECTION_STATUSES.DELETED,s.update(n)):i.delete(s.primaryKey)),s.continue()}),s.oncomplete=(()=>{this.emit("recordDeleted",e)}),s.onerror=(e=>{this.emit("error",e,"deleteHistoryRecord")})}resetRecordsScore(e){const t=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!t)return this.waitReconnect(()=>this.resetRecordsScore(e));const s=this,i=[],n=t.objectStore(l.RECORDS),r=t.objectStore(l.COLLECTIONS),o=n.index(c.BY_COLLECTION),d=window.IDBKeyRange.only(e);r.get(e).onsuccess=function(e){const t=e.target.result;t.status=a.COLLECTION_STATUSES.UPDATED,r.put(t)},o.openCursor(d).onsuccess=function(e){const t=e.target.result;t&&(t.value.score=0,t.value.status=a.COLLECTION_STATUSES.UPDATED,t.value.modificationTimestamp=a.CollectionServerModel.getTimestamp(),t.update(t.value),i.push(t.value),t.continue())},t.oncomplete=function(){s.emit("resetedScore",i)},t.onerror=function(e){s.emit("error",e,"resetRecordsScore")}}moveRecord(e,t){const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.moveRecord(e,t));const i=this,n=t.id,r=s.objectStore(l.RECORDS),o=s.objectStore(l.COLLECTIONS),u=r.index(c.BY_RECORD_HASH),h=d.getTextHashKey(e,n),p=window.IDBKeyRange.only(h),g=function(e,t){let s=e.recordsCount||0;s=t?s+1:s-1,e.status=a.COLLECTION_STATUSES.UPDATED,e.recordsCount=s<0?0:s,o.put(e)};let E,_;const T=e.collectionId;u.openCursor(p).onsuccess=function(s){const l=s.target.result;l?(!E&&d.sameRecordData(l.value,e)&&(E=l.value),l.continue()):(E?E.status===a.COLLECTION_STATUSES.DELETED&&(E.status=a.COLLECTION_STATUSES.UNCHANGED,r.put(E),o.get(n).onsuccess=function(e){g(e.target.result,!0)}):(_=i.prepareRecord(i.cloneRecord(e),t),r.add(_),o.get(n).onsuccess=function(e){g(e.target.result,!0)}),e.serverId?(e.status=a.COLLECTION_STATUSES.DELETED,r.put(e)):r.delete(e.id),o.get(T).onsuccess=function(e){g(e.target.result)})},s.oncomplete=function(){i.emit("recordUpdated")},s.onerror=function(e){i.emit("error",e,"moveRecord")}}deleteRecords(e){const t=n.default.isArray(e)?e:[e];if(!t.length)return;const s=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!s)return this.waitReconnect(()=>this.deleteRecords(e));let i;const r=this,o=s.objectStore(l.RECORDS),d=s.objectStore(l.COLLECTIONS);o.index(c.BY_COLLECTION).openCursor().onsuccess=function(e){const s=e.target.result;if(s){if(-1!==t.indexOf(s.primaryKey)){const e=s.value;i=s.key,e.serverId?(e.status=a.COLLECTION_STATUSES.DELETED,s.update(e)):o.delete(s.primaryKey)}s.continue()}else i&&(d.get(i).onsuccess=function(e){const s=e.target.result,i=(s.recordsCount||0)-t.length;s.status=a.COLLECTION_STATUSES.UPDATED,s.recordsCount=i<0?0:i,d.put(s)})},s.oncomplete=function(){r.emit("recordDeleted",i)},s.onerror=function(e){r.emit("error",e,"deleteRecords")}}resetServerIds(){const e=this.safeTransaction(this._db.objectStoreNames,"readwrite");if(!e)return this.waitReconnect(()=>this.resetServerIds());const t=this,s=e.objectStore(l.RECORDS);e.objectStore(l.COLLECTIONS).openCursor().onsuccess=function(e){const t=e.target.result;if(t){const e=t.value;e.status===a.COLLECTION_STATUSES.DELETED?t.delete():e.serverId&&(e.status=a.COLLECTION_STATUSES.ADDED,delete e.serverId,t.update(e)),t.continue()}else s.openCursor().onsuccess=function(e){const t=e.target.result;let s;t&&(s=t.value,s.status===a.COLLECTION_STATUSES.DELETED?t.delete():s.serverId&&(s.status=a.COLLECTION_STATUSES.ADDED,delete s.serverId,t.update(s)),t.continue())}},e.oncomplete=function(){t.emit("resetedIds")},e.onerror=function(e){t.emit("error",e,"resetServerIds")}}}t.CollectionDatabase=d,d.INDEX_BEGIN="::",d.INDEX_END="::~",d.DATABASE_NAME="ytr_collections",d.DATABASE_VERSION=5},function(e,t,s){"use strict";t.__esModule=!0,t.SeoModule=t.LANDING_TEXT_PREFIX=t.LANDING_LANGS_PREFIX=t.APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(156);t.APP_EVENTS={},t.LANDING_TEXT_PREFIX="dictionary",t.LANDING_LANGS_PREFIX="translator";class a extends r.AppModule{constructor(e,t){super(e,t);const s=n.default.slice(document.querySelectorAll("link[rel=canonical], link[rel=alternate]"));this.links=s.map(e=>{const t=e.getAttribute("href");return{el:e,host:t.split("/").slice(0,3).join("/"),query:n.default.fromQueryString(t.split("?",2)[1])}}),this.updateSeoLinksAsync=this.debounceMethod(this.updateSeoLinks,200),this.appModel.onChange(["srcLang","dstLang","trText"],this.updateSeoLinksAsync.bind(this)),this.app.getRouter().on(o.ROUTER_EVENTS.HISTORY_UPDATED,this.updateSeoLinksAsync.bind(this))}getCanonicalPath(){const{pathname:e,search:t}=window.location,{srcLang:s,dstLang:i,trText:n}=this.appModel.getProps();return"/"===e?n&&n.length<=o.MAX_SHARE_TEXT_LENGTH?`/dictionary/${s}-${i}/${encodeURIComponent(n)}`:`/translator/${s}-${i}`:e+t}updateSeoLinks(){const e=this.getCanonicalPath();this.links.forEach(({el:t,host:s,query:{ui:i}})=>{let n=s+e;i&&!e.includes("?")&&(n+="?ui="+i),t.setAttribute("href",n)})}}t.SeoModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.VIEW_IDS=t.UrlController=t.ACTIVE_VIEWS=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(4),o=s(169);const a=/\w+-\w+/,l={OCR:"ocr",TRANSLATE:"translate",COLLECTIONS:"collections"};t.VIEW_IDS=l;const c=[l.OCR,l.TRANSLATE,l.COLLECTIONS];t.ACTIVE_VIEWS=c;const d=e=>{if(!e&&!(e=>a.test(e))(e))return[];const t=e.split("-");return t[0]&&t[1]?t:[]};class u extends r.Model{constructor(e){super({},{}),this.locationObject=e}getRouteWithQueryString(){return this.getRoute()+this.getQueryString()}getQueryParams(e){const t=this.getQueryString();let s={};if(t.length>1){if(s=n.default.fromQueryString(t.slice(1)),!e)return s;const i=d(s.lang);if(i.length>0){const[e,t]=i;s.srcLang=e,s.dstLang=t}}return s}getRouteFromTranslationProps({queryParams:e={},srcLang:t,dstLang:s,trText:i}){const n={...e,...this.getQueryParams()};return n.source_lang&&n.target_lang&&delete n.lang,t&&(n.source_lang=t),s&&(n.target_lang=s),i?n.text=i:delete n.text,"/"+this.buildQueryString(n)}getRoute(){return this.locationObject.pathname}getQueryString(){return this.locationObject.search}getPathArray(e=this.getRoute()){return e.split("/").slice(1)}hasQueryString(e){return-1!==e.indexOf("?")}getRouteFromViewName(e){return new o.RouteBuilder(e).build()}isCurrentRoute(e){return-1!==this.getRoute().indexOf(e)}isMainPageWithoutQueryParams(e){return"/"===e}getCollectionId(){return this.getPathArray()[1]}buildQueryString(e){return n.default.isEmpty(e)?"":"?"+n.default.toQueryString(e)}buildUrl(e,t){return n.default.isEmpty(t)||this.hasQueryString(e)?e:e+this.buildQueryString(t)}addQueryParamsToPathname(e,t){return this.isMainPageWithoutQueryParams(e)?this.getRouteFromTranslationProps(t):c.includes(this.getPathArray(e)[0])?this.buildUrl(e,t.queryParams):e}}t.UrlController=u},function(e,t,s){"use strict";t.__esModule=!0,t.TypingSpeedModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5);s(3);const o="predictor",a="clearButton",l="input",c="cut";class d extends r.AppModule{constructor(e,t){super(e,t),this.timeout=null,this.hasPredicted=!1,this.hasSuggested=!1,this.startTimestamp=null,this.lastTimestamp=null,this.counters=this.getClearCounters(),this.listenAppModel()}getClearCounters(){return{duration:0,typed:0,suggested:0,predicted:0,cleared:0,clearedPredicts:0,clearedSuggests:0}}handleSuggest(e,t){"suggest"===t?this.counters.suggested+=Math.abs(e):this.counters.predicted+=Math.abs(e)}handleTyping(e){this.counters.typed+=Math.abs(e)}handleClearing(e){this.hasPredicted?this.counters.clearedPredicts+=1:this.hasSuggested&&(this.counters.clearedSuggests+=1),this.counters.cleared+=Math.abs(e)}listenAppModel(){this.appModel.onChange("text",(e,{reason:t,sender:s,suggestType:i,oldValue:r=""})=>{const d=e,u=d.length-r.length,h=t===l,p=t===c,g=s===o,E=s===a;null!==this.timeout&&clearTimeout(this.timeout),E||(this.timeout=setTimeout(()=>{this.timeout=null,this.handleEnd()},3e3),u&&(h||g||p)&&(this.startTimestamp||(this.startTimestamp=n.default.now()),this.lastTimestamp=n.default.now(),u>0?g?this.handleSuggest(u,i):this.handleTyping(u):this.handleClearing(u),this.hasPredicted=g&&"suggest"!==i,this.hasSuggested=g&&"suggest"===i,u&&!d&&(this.lastTimestamp=n.default.now(),this.handleEnd())))})}handleEnd(){return!1}}t.TypingSpeedModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.DesktopDynamicTitleModule=void 0;var i=s(206);s(156);class n extends i.DynamicTitleModule{constructor(e,t){super(e,t),this.listenRouter()}listenRouter(){return!1}}t.DesktopDynamicTitleModule=n},function(e,t,s){"use strict";t.__esModule=!0,t.DynamicTitleModule=void 0;var i=s(5);class n extends i.AppModule{constructor(e,t){super(e,t)}makePageTitle(){return!1}setPageTitle(e){return!1}}t.DynamicTitleModule=n},function(e,t,s){"use strict";t.__esModule=!0,t.TextTranslateApplication=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(156),o=s(63),a=s(46),l=s(208),c=s(209),d=s(212),u=s(2),h=s(24),p=s(150),g=s(32),E=s(173),_=s(139),T=s(215),m=s(11),f=s(140),S=s(152),C=s(141),A=s(174),L=s(217),y=s(218),R=s(219),O=s(220),I=s(221),P=s(222),N=s(223),v=s(233),b=s(234),M=s(245),x=s(246),D=s(247),w=s(250),V=s(252),k=s(253),U=s(257),H=s(258),G=s(259),B=s(260),F=s(261),Y=s(262),$=s(263),W=s(161),K=s(264),X=s(192),q=s(265),j=s(266),z=s(268);class J extends a.DesktopTranslateApplication{constructor(e){super(e),this.initToast=n.default.bindInit(L.initToast),this.initUrlView=n.default.bindInit(y.initUrlView),this.initResizer=n.default.bindInit(R.initResizer),this.initHistory=n.default.bindInit(O.initHistory),this.initKeyboard=n.default.bindInit(I.initKeyboard),this.initSelectionPopup=n.default.bindInit(P.initSelectionPopup),this.initSpeechRecognition=n.default.bindInit(N.initSpeechRecognition),this.initPredictor=n.default.bindInit(v.initPredictor),this.initSuggestions=n.default.bindInit(z.initSuggestions),this.initCollections=n.default.bindInit(b.initCollections),this.initCopying=n.default.bindInit(M.initCopying),this.initAlignment=n.default.bindInit(x.initAlignment),this.initSourceTranslit=n.default.bindInit(w.initSourceTranslit),this.initTargetTranslit=n.default.bindInit(V.initTargetTranslit),this.initTranslator=n.default.bindInit(k.initTranslator),this.initComplaintPopup=n.default.bindInit(U.initComplaintPopup),this.initShareButton=n.default.bindInit(H.initShareButton),this.initExternalView=n.default.bindInit(G.initExternalView),this.initAlternatives=n.default.bindInit(D.initAlternatives),this.initTranslationVote=n.default.bindInit(B.initTranslationVote),this.initTextCounter=n.default.bindInit(F.initTextCounter),this.initDescription=n.default.bindInit(Y.initDescription),this.initDescriptionDict=n.default.bindInit($.initDescriptionDict),this.initTextArea=n.default.bindInit(W.initTextArea),this.initMetrikas=n.default.bindInit(K.initMetrikas),this.initTTSPlayer=n.default.bindInit(X.initTTSPlayer),this.initUniproxy=n.default.bindInit(q.initUniproxy),this.initDistBanner=n.default.bindInit(j.initDistBanner);const t=this,s=this.getDesktopSettings(),i=this.getView(),o=this.getModel();this._settings=s,this._router=new r.Router,s.on("change",function(e,s,i){switch(e){case"textboxHeight":t.emit("resizerResize",i)}}),i.on("tap",function(e){const s=this.getClosest(e.target,function(e){return e.hasAttribute("data-external-name")});s&&t.emit("externalClick",n.default.getAttribute(s,"data-external-name"))}).on("copy",function(e){if("emj"===o.getProperty("dstLang"))return;const t=window.getSelection().toString(),s=e.clipboardData||window.clipboardData;t&&s&&!1!==s.setData("Text",t)&&n.default.preventEvent(e)}),o.on("change",function(e,s,i){switch(e){case"text":switch(i.sender){case"dictionary":t.emit("dictLinkClick",s,i);break;case"synonyms":t.emit("synonymsInsert",s,i);break;case"favourites":t.emit("favInsert")}break;case"srcLang":case"dstLang":switch(i.sender){case"langHistory":case"langSelect":t.emit("langChanged",e,i)}break;case"complaint":t.emit("dictComplaintToggle",s,i);break;case"examplesComplaint":s&&t.emit("examplesComplaintStart",i)}}),o.onChange("text",(e,t)=>{switch(t.sender){case"example":case"relatedWords":case"dictionary":case"declensions":setTimeout(()=>this.scrollToTop(),0)}}).onChange("trText",e=>{i.setState("empty",!e)}),this.trackPerformance()}getRouter(){return this._router}getConfig(){return this._config}getSpellerSavedWords(){const e=this.getSettings().getProperty("savedSpellerItems");return e?e.split(";"):[]}hasSpellerSavedWord(e,t=this.getModel().getProperty("srcLang")){return-1!==this.getSpellerSavedWords().indexOf(t+":"+e)}getTranslatorView(){if(!this._translatorView){const e=window.config;this._translatorView=new l.TranslatorView({element:e.ELEMENTS.textbox2,template:e.TEMPLATES.translator,partials:{value:e.TEMPLATES.emojiValue},contentElement:e.ELEMENTS.translation})}return this._translatorView}getDictionaryModel(){return this._dictionaryModel||(this._dictionaryModel=this.makeDictionaryModel()),this._dictionaryModel}getBannedExamplesStorage(){return this._bannedExamplesStorage||(this._bannedExamplesStorage=new o.Storage({},{name:"cmplExpl"})),this._bannedExamplesStorage}getExamplesModel(){
return this._examplesModel||(this._examplesModel=this.makeExamplesModel()),this._examplesModel}getContainerView(){return this._containerView||(this._containerView=new u.TouchView({element:this.getConfig().ELEMENTS.contentContainer})),this._containerView}toggleTranslatorExpandState(e){return window.config.DAILY_PHRASES?(this.getView().setState("translatorExpanded",e),this):this}scrollToTop(){n.default.smoothScrollTo(document.documentElement,0)}makeDictionaryModel(){const e=this.getConfig(),t=this.getSettings();return new c.DesktopDictionaryMultipleModel({ui:e.UI_LANG,srv:e.SRV,url:e.DICTIONARY_URL,getLangDir:()=>this.getLangsPair(),settings:t,constants:{disableDictionary:e.DISABLE_DICTIONARY,dictionaryLangs:e.DICTIONARY_LANGS,maxDictQuery:e.MAX_DICT_QUERY,maxDictWordsCount:e.MAX_DICT_WORD_COUNT}})}makeExamplesModel(){const e=this.getConfig(),t=this.getSettings();return new d.DesktopExamplesModel({ui:e.UI_LANG,srv:e.SRV,url:e.EXAMPLES_URL,chunks:!0,maxLength:e.MAX_EXAMPLE_LENGTH,settings:t,constants:{maxExampleQuery:e.MAX_EXMP_QUERY,maxExampleWordCount:e.MAX_EXMP_WORD_COUNT,exampleLangs:e.EXAMPLE_LANGS,disableExamples:e.DISABLE_EXAMPLES}})}getPredictorPresenter(){if(!this._predictorPresenter){const e=this.getConfig();this._predictorPresenter=new p.PredictorPresenter({view:new g.ListboxView({element:e.ELEMENTS.predictor,template:e.TEMPLATES.predictor}),model:new E.PredictorModel({languages:e.TRANSLATOR_LANGS,srv:e.SRV,limit:e.MAX_PREDICTOR_ITEMS,detectOptions:p.PredictorPresenter.detectOptions.KBD},{languages:e.TRANSLATOR_LANGS,url:e.PREDICTOR_URL,detectUrl:e.DETECTOR_URL,validators:{text(t){return t&&t.length<=e.MAX_PREDICTOR_QUERY&&!n.default.isElvishLanguage(this.getProperty("srcLang"))&&!n.default.isUrl(n.default.trim(t))},srcLang:t=>n.default.hasProperty(e.PREDICTOR_LANGS,t)}})})}return this._predictorPresenter}getMeasurerViewDst(){if(!this._measurerViewDst){const e=this.getConfig();this._measurerViewDst=new h.TemplateView({element:e.ELEMENTS.measurerDst,template:e.TEMPLATES.measurer})}return this._measurerViewDst}getMeasurerViewSrc(){if(!this._measurerViewSrc){const e=this.getConfig();this._measurerViewSrc=new h.TemplateView({element:e.ELEMENTS.measurer,template:e.TEMPLATES.measurer})}return this._measurerViewSrc}getLayerView(){if(!this._layerView){const e=this.getConfig();this._layerView=new h.TemplateView({element:e.ELEMENTS.textLayer,template:e.TEMPLATES.measurer})}return this._layerView}getTranslatorModel(){if(!this._translatorModel){const e=this.getConfig();this._translatorModel=new T.TranslatorModel2({srv:e.SRV,url:e.TRANSLATOR_URL,options:_.TranslatorModel.options.ALIGN|e.TRANSLATOR_EXTRA_OPTIONS,maxTranslatorQuery:e.MAX_TRANSLATOR_QUERY,translatorLangs:e.TRANSLATOR_LANGS})}return this._translatorModel}onToggleSpellerOption(e){return this.getSettings().onToggleOption(C.AVAILABLE_OPTIONS.AUTOCORRECT,e)}getTextareaPresenter(){if(!this._textareaPresenter){const e=this.getConfig(),t=e.USE_FAKEAREA&&m.InputView.fakeAreaSupported,s=new m.InputView({element:e.ELEMENTS.textbox,activateFocus:!1,contentElement:t?m.InputView.makeFakeArea(e.ELEMENTS.fakeArea):e.ELEMENTS.textarea});s.bindDOMEvents("scroll",!0),this._textareaPresenter=new f.InputPresenter({view:s,model:new S.InputModel})}return this._textareaPresenter}getTextInputView(){return this.getTextareaPresenter().getView()}autoSpellerEnabled(){return this.getSettings().isOptionEnabled(C.AVAILABLE_OPTIONS.AUTOCORRECT)}getComplaintCommentInput(){if(!this._complaintPopupCommentInput){const e=this.getConfig();this._complaintPopupCommentInput=new f.InputPresenter({view:new m.InputView({element:e.ELEMENTS.complaintPopupComment,activateFocus:!0,contentElement:e.ELEMENTS.complaintPopupCommentInput}),model:new S.InputModel})}return this._complaintPopupCommentInput}getSpeechRecognitionChip(){if(!this._speechRecognitionChip){const e=this.getConfig();this._speechRecognitionChip=new A.MicNotificationChip({gifUrl:e.MIC_ENABLE_GIF,tooltipElement:e.ELEMENTS.micNotificationChipTooltip,tooltipElementWrapper:e.ELEMENTS.micNotificationChipTooltipWrapper,spinnerElement:e.ELEMENTS.micNotificationChipTooltipSpinner},{container:e.ELEMENTS.micButtonChip})}return this._speechRecognitionChip}}t.TextTranslateApplication=J},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorView=void 0;var i=s(24);class n extends i.TemplateView{getSelectedText(e){const t={src:"",dst:""},s=window.getSelection();if(s&&s.anchorNode&&s.focusNode){let i=s.anchorNode,n=s.focusNode;i===n&&"translation"===i.id&&(t.dst=e),t.src=s.toString(),i.compareDocumentPosition(n)===Node.DOCUMENT_POSITION_PRECEDING&&(n=i,i=s.focusNode);const r=[this.getAlign(i.parentNode)];if(i!==n)for(i=i.parentNode;i&&!i.contains(n);)i=i.nextElementSibling,r.push(this.getAlign(i));r.filter((e,t,s)=>e&&s.findIndex(t=>t&&t[0]===e[0]&&t[1]===e[1])===t).forEach((s,i,n)=>{t.dst+=e.slice(s[0],s[1]),i!==n.length-1&&(t.dst+=" ")})}return t}getAlign(e){const t=this.getClosest(e,function(e){return e.hasAttribute&&e.hasAttribute("data-align")},!0);return t?t.getAttribute("data-align").split(":").map(Number):null}getOffsetHeight(){const e=this.getContentElement("[data-complaint-type=fullTextTranslation]");return e?e.offsetHeight:0}}t.TranslatorView=n},function(e,t,s){"use strict";t.__esModule=!0,t.DesktopDictionaryMultipleModel=void 0,(i=s(0))&&i.__esModule;var i,n=s(170);class r extends n.DictionaryMultipleModel{constructor(e,t){super(e,t);const{config:s,settings:i,constants:n}=e;this.config=s,this.settings=i,this.constants=n,this.setValidator(this.getDefaultValidators())}getDefaultValidators(){return!1}}t.DesktopDictionaryMultipleModel=r},function(e,t,s){"use strict";t.__esModule=!0,t.IdiomsModel=void 0;var i=s(4);class n extends i.Model{needReset(){return!1}updateHash(e){return!1}}t.IdiomsModel=n},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryApiParseError=t.DictionaryApiError=void 0;class i extends Error{constructor(e,t){super(),this.message=`DictionaryApiError ${e} ${t}`}}t.DictionaryApiError=i;class n extends Error{constructor(e){super(),this.message="DictionaryApiParseError "+e}}t.DictionaryApiParseError=n},function(e,t,s){"use strict";t.__esModule=!0,t.DesktopExamplesModel=void 0,(i=s(0))&&i.__esModule;var i,n=s(157);class r extends n.DictionaryExamplesModel{constructor(e,t){super(e,t);const{constants:s,settings:i}=e;this.constants=s,this.settings=i,this.setValidator(this.getDefaultValidators())}getDefaultValidators(){return!1}}t.DesktopExamplesModel=r},function(e,t,s){"use strict";t.__esModule=!0,t.PredictorParseError=t.PredictorApiError=void 0;class i extends Error{constructor(e,t){super(),this.message=`PredictorAPIError [${e}] [${t}]`}}t.PredictorApiError=i;class n extends Error{constructor(e){super(),this.message=`PredictorParseError [${e}]`}}t.PredictorParseError=n},function(e,t,s){"use strict";t.__esModule=!0,t.DetectParseError=t.DetectApiError=void 0;class i extends Error{constructor(e,t){super(),this.message=`DetectApiError [${e}] [${t}]`}}t.DetectApiError=i;class n extends Error{constructor(e){super(),this.message=`DetectParseError [${e}]`}}t.DetectParseError=n},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorModel2=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(8),o=s(130),a=s(216),l=s(139),c=s(29),d=s(17),u=s(151);class h extends l.TranslatorModel{constructor(e={},t={}){super(e,t),this._chunks=[],this._chunkSize=e.chunkSize||600,this._maxThreads=e.maxThreads||4,this._activeRequests=[],t.validators||this.setValidator(this.getDefaultValidators()),this.on("invalid",this.reset)}reset(){return this._index=0,this._align="",this._chunks.length=0,this._activeRequests.forEach(function(e){e.abort()}),this._activeRequests.length=0,this._completedThreads=0,this}getDefaultValidators(){const{maxTranslatorQuery:e,translatorLangs:t}=this.getProps();return{text(){const t=this.getText().join("\n");return t&&t.length<=e&&!n.default.isUrl(t)},srcLang(e){return n.default.hasProperty(t,e)&&e!==this.getProperty("dstLang")},dstLang(e){return n.default.hasProperty(t,e)&&e!==this.getProperty("srcLang")}}}getData(e){const t=l.TranslatorModel.prototype.getData.call(this);return e&&(t.text=[e]),t}getParams(e){const t=l.TranslatorModel.prototype.getParams.call(this);return e&&(t.id=t.id.replace(/\d+$/,e)),t}makeChunks(){let e,t=this.getText().join("\n");for(;t;)e=n.default.truncateText(t,this._chunkSize),this._chunks.push(e),t=t.slice(e.length);return this}requestTranslation(){return!this.isValid()||this.getProperty("shouldNotRequest")||(this.emit("request"),this.reset(),this.makeChunks(),this.increaseCounter(),this.getSid().then(()=>{this.saveLastTranslationId(this.getTranslationId()),this.emit("query",n.default.extend(this.getData(),this.getParams()));for(let e=0;e<this._maxThreads;e++)this.translateNextChunk()})),this}translateNextChunk(){const e=this._chunks.length;if(!e)return this;const t=this._index++,s=this._chunks[t];if(t<e){if(s.length>this._chunkSize||!n.default.trim(s))return this.translateNextChunk();const e=this.getData(s),i=new d.HTTPRequest(this.getProperty("url")).setType(d.HTTPRequest.types.FORM).setData(e).setParams({...this.getParams(t),ajax:1}).setMethod(d.HTTPRequest.methods.POST);i.setHeader("X-Retpath-Y",window.location.origin),this._activeRequests.push(i.send(this._handleChunkResponse.bind(this,t)))}else++this._completedThreads===this._maxThreads&&this.setProperty("translation",this._chunks.join(""),{align:this._align});return this}_handleChunkResponse(e,t,s){const i=s&&(0,a.getCaptcha)(s.body);i?(0,a.redirect2Captcha)(i):this._processChunk(e,t,s)}_processChunk(e,t,s){const i=(0,o.getLogErrorCode)({response:s,error:t}),n=t&&d.HTTPRequest.isAbortedCode(t.code),a=s&&d.HTTPRequest.isSuccessCode(s.code);if(a&&!n&&!this.validateResponse(s)){const{srcLang:e,dstLang:t,srv:i}=this.getProps(),n=s.text?s.text.slice(0,o.MAX_LOG_RESPONSE_TEXT_LENGTH):null;(0,r.logError)(new u.UnexpectedTranslationApiResponse(e,t,i),{additional:{responseText:n}})}if(a&&(this._chunks[e]=s.body.text.join("\n"),s.body.align&&1===this._chunks.length&&(this._align=s.body.align[0]),this.translateNextChunk()),!a&&!n){const{srcLang:e,dstLang:n,srv:o}=this.getProps();(0,r.logError)(new u.TranslateApiError(i,e,n,o)),this.reset().emit("error",t||new c.HTTPError(i,s.body.message))}}}t.TranslatorModel2=h},function(e,t,s){"use strict";t.__esModule=!0,t.getCaptcha=function(e){return n.default.isObject(e)&&"captcha"===e.type?e.captcha["captcha-page"]:null},t.redirect2Captcha=function(e){e&&(r.$tracker.sendMetric("antirobot_ajax_captcha"),window.location.replace(e))};var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3)},function(e,t,s){"use strict";t.__esModule=!0,t.initToast=void 0;var i=s(158),n=s(2),r=s(159);t.initToast=function(e){const t=new i.ToastPresenter({view:new n.TouchView({element:e.ELEMENTS.errorToast,contentElement:e.ELEMENTS.errorToastContent}),model:new r.ToastModel({delay:e.TOAST_DELAY})});return this.getModel().on("set:toast",function(e,s){t.getView().setState("commonComplaint",s.commonComplaint),t.showToast(e,s.delay)}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initUrlView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(24);t.initUrlView=function(e){const t=new r.TemplateView({element:e.ELEMENTS.url,template:e.TEMPLATES.url}),s=this.getView(),i=this.getModel();return this.onAction("translatePage",function(){if(!t.isEnabled())return;this.emit("translatePage");const{text:e}=this.getProps();this.openSiteTranslateUrl(e)}),t.on("stateChanged:hidden",function(e){s.setState("url",!e)}),i.on("change",function(s,i){let r;switch(s){case"text":case"srcLang":case"dstLang":if(r=this.toJSON(),r.text=n.default.trim(r.text),!r.text){t.setVisible(!1);break}n.default.isUrl(r.text)&&(this.setProperty({trText:r.text,translation:r.text}),t.renderData({ui:e.UI_LANG,url:r.text,lang:r.srcLang+"-"+r.dstLang}).setVisible(!0).setEnabled(!n.default.hasProperty(e.INVALID_URL_LANGS,r.srcLang)&&!n.default.hasProperty(e.INVALID_URL_LANGS,r.dstLang)));break;case"translation":i&&!n.default.isUrl(i)&&t.setVisible(!1)}}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initResizer=void 0;var i=s(24);t.initResizer=function(e){const t=this,s=new i.TemplateView({element:e.ELEMENTS.translationLayer,template:e.TEMPLATES.measurer}),n=this.getView(),r=this.getModel(),o=this.getLayerView();n.getContentElement('[data-resizer-target="max"]'),n.getContentElement('[data-resizer-target="src"]'),n.getContentElement('[data-resizer-target="dst"]');const a=function(){return!1},l=function(e){switch(e){case"longtext":case"keyboard":a()}},c=function(e,t){switch(e){case"text":o.renderData({text:t,rightText:this.getProperty("sourceTranslit")&&"."});break;case"sourceTranslit":o.renderData({text:this.getProperty("text"),rightText:t&&"."});break;case"targetTranslit":s.renderData({text:this.getProperty("translation"),rightText:t&&"."});break;case"translation":case"userTranslation":s.renderData({text:t,rightText:this.getProperty("targetTranslit")&&"."})}};return function(e){const i=e?"on":"off";t[i]("resize",a),t[i]("containerHeightChanged",a),n[i]("stateChanged",l),r[i]("change",c),o[i]("contentChanged",a),s[i]("contentChanged",a)}(!0),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initHistory=void 0,t.initHistory=function(e){return this.getModel(),this._router,!1}},function(e,t,s){"use strict";t.__esModule=!0,t.initKeyboard=void 0,s(2),t.initKeyboard=function(e){return!1}},function(e,t,s){"use strict";t.__esModule=!0,t.initSelectionPopup=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(32),o=s(170),a=s(157),l=s(2),c=s(70),d=s(11),u=s(175);const h="box-dst",p="box-src";t.initSelectionPopup=function(e){let t;const s=this,i=this._settings,g=this.getView(),E=this.getModel(),_=E.getProps(),T=new u.DictionaryPresenter2({view:new r.ListboxView({template:e.TEMPLATES.empty}),model:new o.DictionaryMultipleModel({ui:e.UI_LANG,srv:e.SRV,url:e.DICTIONARY_URL,getLangDir:()=>this.getLangsPair()},{validators:{text:t=>!!g.hasState("select")&&!e.DISABLE_DICTIONARY&&t&&!/[\n\r]/.test(t)&&t.length<=e.MAX_DICT_QUERY&&n.default.getValueTokens(t).length<=e.MAX_DICT_WORD_COUNT&&!n.default.isUrl(t)&&n.default.hasAlpha(t),srcLang(t){const s=this.getProperty("dstLang");return t!==s&&(n.default.hasProperty(e.DICTIONARY_LANGS,t+"-"+s)||n.default.hasProperty(e.DICTIONARY_LANGS,t+"-"+t))},dstLang(t){const s=this.getProperty("srcLang");return s!==t&&(n.default.hasProperty(e.DICTIONARY_LANGS,s+"-"+t)||n.default.hasProperty(e.DICTIONARY_LANGS,s+"-"+s))}}})}),m=new a.DictionaryExamplesModel({ui:e.UI_LANG,srv:e.SRV,url:e.EXAMPLES_URL,chunks:!0,maxLength:e.MAX_EXAMPLE_LENGTH},{validators:{text:t=>!!g.hasState("select")&&!e.DISABLE_EXAMPLES&&t&&!/[\n\r]/.test(t)&&t.length<=e.MAX_EXMP_QUERY&&n.default.getValueTokens(t).length<=e.MAX_EXMP_WORD_COUNT&&!n.default.isUrl(t)&&n.default.hasAlpha(t),srcLang(t){const s=this.getProperty("dstLang");return t!==s&&n.default.hasProperty(e.EXAMPLE_LANGS,t+"-"+s)},dstLang(t){const s=this.getProperty("srcLang");return s!==t&&n.default.hasProperty(e.EXAMPLE_LANGS,s+"-"+t)}}}),f=new u.DictionaryPresenter2({view:new r.ListboxView({template:e.TEMPLATES.empty}),model:m}),S=new r.ListboxView({element:e.ELEMENTS.popunder,template:e.TEMPLATES.examplePopup}),C=new r.ListboxView({element:e.ELEMENTS.popunderTooltip,template:e.TEMPLATES.empty}),A=this.getTranslatorView(),L=(this.getMeasurerViewSrc(),this.getMeasurerViewDst(),()=>{const{selTr:e,selText:t}=E.getProps();let s="";return e&&(s=h),t&&(s=p),s}),y=(e={})=>{let t=e.source||L();const i={...e,source:t};s.emit("popupShown",{...i})},R=function(){const s=f.getText();n.default.getValueTokens(s).length>e.MAX_EXMP_WORD_COUNT||!n.default.hasAlpha(s)?S.setVisible(!1):(S.renderData({noExamples:!0}),S.setVisible(!0),y({show:!0,empty:!0}),clearTimeout(t),t=setTimeout(function(){S.setVisible(!1)},4e3))},O=function(){s._dictPopup=void 0,s._exmpPopup=void 0},I=()=>{},P=n.default.debounce(function(){const{trText:e,selTr:i,selText:n}=E.getProps();if(!e||!i&&!n)return O(),void S.setVisible(!1);s._exmpPopup||s._dictPopup&&s._dictPopup.hasWords?(s._dictPopup=s._dictPopup||{},s._dictPopup.text=s._dictPopup.text||i||n,s._dictPopup.hasExamples=s._exmpPopup&&s._exmpPopup.hasExamples,s._dictPopup.items=s._exmpPopup&&s._exmpPopup.items,s._dictPopup.isSrc=Boolean(n),S.setState("overflow",s._dictPopup.hasWords),S.renderData(s._dictPopup),S.setVisible(!0),y({show:!0}),clearTimeout(t)):R()},200),N=()=>{s._dictPopup&&s._dictPopup.hasWords&&s._exmpPopup?P.callNow():P()},v=n.default.debounce(function(e,t,s){-1===s.target.className.indexOf("translit")&&setTimeout(()=>{const e=E.getProperty("text"),t=A.getSelectedText(e);t.src&&setTimeout(function(){E.setProperty("selTr",t.src,{dst:t.dst})},0)},10)}),b=function(t,s){let i="",n="";const r=[];return t.forEach(function(e){i=e.pos&&e.pos.code,n=e.text,e.tr.forEach(function(e,t){r.push({name:s,value:e.text,title:n,groupIndex:t,partOfSpeech:i}),e.syn&&e.syn.forEach(function(e){r.push({name:s,value:e.text,title:n,groupIndex:t,partOfSpeech:i})})})}),r.length>e.MAX_SYNONYMS_ITEMS2&&(r.length=e.MAX_SYNONYMS_ITEMS2),r[r.length-1].isLast=!0,r},M=e=>{e.keyCode===d.InputView.keys.ESCAPE&&(s._dictPopup||s._exmpPopup)&&S.isVisible()&&(S.setVisible(!1),O())};this.on("resize",()=>{O(),S.setVisible(!1)}).on("textKeydown",function(e){M(e)}).on("action",function(e){switch(e){case"retry":T.requestData(),f.requestData()}}).on(["trTextSelect","trTextClick"],(e,...t)=>v(...t)).onAction("enableCustomMode",n.default.debounce(()=>{S.setVisible(!1),n.default.removeAllSelections()})),E.on("change",function(t,i,r){let o,a;const l=E.getProperty("trText"),d=E.getProperty("srcLang"),u=E.getProperty("dstLang");switch(t){case"text":(s._dictPopup||s._exmpPopup)&&(O(),S.setVisible(!1)),"dictionary"===r.sender&&"tr"===r.type&&s.swapDirection();break;case"trText":case"selText":a=n.default.trim(i);const h="selText"===t,p="trText"===t,_=n.default.getValueTokens(a).length>e.MAX_EXMP_WORD_COUNT,m=f.customExamplesEnabled();if(h&&m&&_)return;o=a&&h&&!_&&n.default.hasAlpha(a)&&T.hasType(c.DictionaryPresenter.types.REGULAR),g.setState("select",o),a&&!m&&(T.setSrcLanguage(d,{silent:!0}).setDstLanguage(u).requestData(),f.setSrcLanguage(d,{silent:!0}).setDstLanguage(u,{silent:!0}).setTranslation("",{silent:!0}).setMaxLength("selText"===t?e.MAX_EXAMPLE_POPUP_LENGTH:e.MAX_EXAMPLE_LENGTH).requestData()),o&&(O(),I({isTranslation:!1}),S.renderData({noExamples:!0,template:!0})),T.setText(a),f.setText(a),p&&f.setCustomExamplesFlag(!1);break;case"selTr":const C=r.dst&&r.dst.length<=e.MAX_EXMP_DST_QUERY?r.dst:"";a=n.default.trim(i),T.setSrcLanguage(u,{silent:!0}).setDstLanguage(d),o=a&&n.default.hasAlpha(a)&&T.hasType(c.DictionaryPresenter.types.REGULAR),o&&(O(),g.setState("select",!0),I({isTranslation:!0}),S.renderData({noExamples:!0,template:!0}).setState("text",!1).setVisible(!0),T.setText(a).requestData(),f.setSrcLanguage(u,{silent:!0}).setDstLanguage(d,{silent:!0}).setTranslation(C,{silent:!0}).setMaxLength(e.MAX_EXAMPLE_POPUP_LENGTH).setText(a).requestData());break;case"srcLang":E.setProperty("supportExamples",e.EXAMPLE_LANGS[i+"-"+u]),f.setCustomExamplesFlag(!1).setSrcLanguage(i).setDstLanguage(u).setText(l).requestData(),T.setSrcLanguage(i).setDstLanguage(u).setText(l).requestData();break;case"dstLang":E.setProperty("supportExamples",e.EXAMPLE_LANGS[d+"-"+i]),f.setCustomExamplesFlag(!1).setSrcLanguage(d).setDstLanguage(i).setText(l).requestData(),T.setFlag(c.DictionaryPresenter.flags.DEFINITIONS,i===e.UI_LANG).setSrcLanguage(d).setDstLanguage(i).setText(l).requestData()}}),g.on("stateChanged:select",function(e){e||(O(),S.setVisible(!1))}).on("stateChanged:empty",function(e){e&&g.setState("select",!1)}).on("tap",function(e){if(S.isVisible()&&!S.getElement().contains(e.target)){let e=L();S.setVisible(!1),y({source:e})}}),A.on("keydown",function(e){e.keyCode===d.InputView.keys.A&&n.default.hasCtrlKey(e)?E.setProperty("selTr",E.getProperty("translation"),{dst:E.getProperty("text")}):M(e)}).bindDOMEvents("keydown",!0),S.on("stateChanged:hidden",function(i){i?(E.setProperty("selText","",{silent:!0}),E.setProperty("selTr","",{silent:!0}),f.getModel().getProperty("maxLength")!==e.MAX_EXAMPLE_LENGTH&&(f.setText("",{silent:!0}),T.setText("",{silent:!0})),g.hasState("emptyPopup")||g.setState("select",!1)):(clearTimeout(t),s._showedExamples||(s._showedExamples=!0))}).on(l.TouchView.eventTypes.OVER,function(e){const t={},i=e.target;n.default.hasClass(i,"example_ref")&&!C.isVisible()&&(C.setHTMLContent(n.default.getAttribute(i,"data-message")),function(e,t){const s=t.getElement(),i=e.left,n=e.top-t.getRect().height;s.style.left=i+"px",s.style.top=n+"px"}(i.getBoundingClientRect(),C),C.setState("popup",S.isVisible()),C.setVisible(!0),t.type=n.default.getAttribute(i,"data-type"),t.text=f.getText(),t.origin=n.default.getAttribute(i,"data-ref"),s.emit("originTooltipShown",t))}).on(l.TouchView.eventTypes.OUT,function(e){const t=e.target;n.default.hasClass(t,"example_ref")&&C.isVisible()&&C.setVisible(!1)}).bindDOMEvents(l.TouchView.eventTypes.OVER).bindDOMEvents(l.TouchView.eventTypes.OUT),T.setFlag(c.DictionaryPresenter.flags.MORPHO,!0).setFlag(c.DictionaryPresenter.flags.FAMILY,e.FAMILY).setFlag(c.DictionaryPresenter.flags.SHORT_POS,!0).setFlag(c.DictionaryPresenter.flags.TOOLTIPS,!0).setFlag(c.DictionaryPresenter.flags.IDIOMS,!0).setFlag(c.DictionaryPresenter.flags.LONG_EXAMPLES,!0),f.setFlag(c.DictionaryPresenter.flags.MORPHO,!0).setFlag(c.DictionaryPresenter.flags.FAMILY,e.FAMILY).setFlag(c.DictionaryPresenter.flags.SHORT_POS,!0).setFlag(c.DictionaryPresenter.flags.TOOLTIPS,!0).setFlag(c.DictionaryPresenter.flags.IDIOMS,!0).setVoteResults(i.getProperty("voteResults")),f.on("dataSet",function(e,t){g.hasState("select")&&(s._dictPopup||t.resultLength?N():t.resultLength||R())}).on("error",function(e){e&&setTimeout(function(){E.setProperty("selText","",{silent:!0}),E.setProperty("selTr","",{silent:!0}),g.setState("select",!1)},500)}),f.prepareData=function(e){const t={},i=n.default.safeParseJSON(e),r=n.default.get(i,"result.tabs",[]),o=n.default.get(i,"result.examples",[]);if(!r.length)return null;const a=L();if(s.emit("examplesRendered",{text:this.getText(),popup:g.hasState("select"),source:a}),g.hasState("select")){const e=Boolean(E.getProperty("selText"));t.items=[],t.hasExamples=!0;for(let s=0;s<2;s++){const i=r[s];if(!i)break;i.examples=o.filter(e=>e.tabIndex===s);const n=i.translation,a=n.text||n,l=n.pos;"idiom"!==i.examples[0].ref.type&&t.items.push({exampleId:i.examples[0].id,pos:l?l.text:null,posCode:l?l.code:null,original:i.text,text:i.translation.other?"":a,ref:i.examples[0].ref.title,refType:i.examples[0].ref.type,message:u.DictionaryPresenter2.getTooltipMessage(i.examples[0].ref),srcExp:i.examples[0].src.split(/[<>]/).map(function(t,s){return{text:t,highlighted:s%2!=0,needSwap:!e}}),dstExp:i.examples[0].dst.split(/[<>]/).map(function(t,s){return{text:t,highlighted:s%2!=0,needSwap:e}})})}s._exmpPopup=t,g.setState("emptyPopup",!1)}};const x=e=>{const t=[];return e.gen&&t.push({value:e.gen.text,title:e.gen.tooltip}),e.num&&t.push({value:e.num.text,title:e.num.tooltip}),e.dia&&t.push({value:e.dia.text,title:e.dia.tooltip}),t};return T.prepareData=function(t){let i,r,o="",a=0;const l=e.SYN_TITLES2,d=E.getProperty("srcLang"),u=E.getProperty("dstLang"),h=E.getProperty("srcLang")+"-"+E.getProperty("dstLang"),p=E.getProperty("dstLang")+"-"+E.getProperty("srcLang"),_={words:[]},m=[],f=[],S={dict:{},syn:{}};if(!t)return null;let C=JSON.parse(t);const A=C[d]||C[u];if(C=C[h]||C[p],!C&&!A)return null;const y=Boolean(C&&C[c.DictionaryPresenter.types.DEF]),R=Boolean(E.getProperty("selText")),O=[];[c.DictionaryPresenter.types.DEF,c.DictionaryPresenter.types.REGULAR].forEach(e=>{const t=C&&C[e];t&&t.length&&O.push(t)});let I,P=!1;if(O.forEach(t=>{if(P)return;I=t,S.dict.hasModernLabel=t.some(function(e){return e.new||e.tr.some(function(e){return e.new})}),S.dict.items=t.map(function(t){let s="";const i={meanings:[],definition:{},show:a<e.DICTIONARY_COUNT},r=[];return i.title={title:t.text,marks:x(t)},t.text!==o&&t.fl&&(i.title.fl=t.fl),o=t.text,t.pos&&(s=t.pos.code,i.title.partOfSpeechCode=s,i.title.tooltip=t.pos.tooltip,i.title.partOfSpeech=t.pos.text),t.ts&&(i.title.transcription=t.ts),i.title.gen=n.default.get(t,"gen.tooltip",""),i.title.fl=n.default.get(t,"fl",""),t.tr.forEach(function(t,n){const l={examples:[],hasExamples(){return Boolean(this.examples.length)},hasTranslations(){return Boolean(this.meaningTrs.length)},groupIndex:n},c=[],d=[{needSwap:R,title:o,value:t.text,marks:x(t),groupIndex:n,partOfSpeech:s}];t.def?i.definition=(e=>({imgUrl:e.img,origUrl:e.orig,textVal:e.def.split(/[<>]/).map(function(e,t){return{text:e,highlighted:t%2!=0,isSrc:Boolean(E.getProperty("selText"))}}),altText:e.text,sourceUrl:e.ref.url,sourceName:e.ref.name}))(t):(t.syn&&t.syn.forEach(function(e){d.push({needSwap:R,title:o,value:e.text,marks:x(e),groupIndex:n,partOfSpeech:s})}),t.mean&&t.mean.forEach(function(e){c.push({needSwap:!R,title:o,value:e.text,groupIndex:n,partOfSpeech:s})}),d[d.length-1].isLast=!0,c.length&&(c[c.length-1].isLast=!0),l.meaningTrs=c,l.meaningVals=d,l.show=a<e.DICTIONARY_COUNT,a++,l.show?(l.hasExamples()&&(i.title.showExampleToggle=!0),r.push({values:l.meaningVals,hasSyn:l.meaningTrs.length,syn:l.meaningTrs,groupIndex:l.groupIndex,groupIndex1:n+1})):d.forEach(function(e){f.push(e.value)}),i.meanings.push(l))}),i.show&&_.words.push({partOfSpeechCode:i.title.partOfSpeechCode,partOfSpeech:i.title.partOfSpeech,transcription:i.title.transcription,gen:i.title.gen,fl:i.title.fl,title:o,popupVals:r}),(e=>!(e.meanings.length||e.title.hasExamples||e.title.transcription||Object.keys(e.definition).length))(i)?null:(P=!0,i)});const s=a>e.DICTIONARY_COUNT;S.dict.title=e.DICT_TITLES.regular,S.dict.showToggle=s,S.dict.showToggle&&(S.dict.moreMessage=n.default.parseString(e.MORE_MESSAGE,f.length),S.dict.moreMessage+=": "+f.slice(0,2).join(", "))}),A){for(i in l)A[i]&&A[i].length&&(r={subtitle:l[i].title,tooltip:l[i].tooltip,tab:i,items:b(A[i],i)},m.push(r));m.length&&(S.syn.articles=m)}const N=S.dict.items&&S.dict.items.filter(Boolean).length,v=S.syns&&S.syns.articles&&S.syns.articles.length;if(!N&&!v)return null;if(N){const e=L();s.emit("dictRendered",{text:T.getText(),popup:g.hasState("select"),noExamples:!0,definition:y,source:e})}else S.dict.items=null,S.dict.title=null;g.hasState("select")&&(I&&(_.words=_.words.slice(0,3),_.words.forEach(function(e){e.syn&&e.syn.length&&(e.syn[e.syn.length-1].isLast=!0),e.values&&e.values.length&&(e.values[e.values.length-1].isLast=!0)}),_.hasWords=_.words.length,_.ts=I[0]&&I[0].ts,_.text=I[0]&&I[0].text||E.getProperty("selTr"),_.pos=I[0]&&I[0].pos&&I[0].pos.text),s._dictPopup=_)},T.on("valueSelected",function(e){if(g.hasState("complaint"))return;const t=e.split(":");E.setProperty("text",t[1],{type:t[0],sender:"tr"===t[0]||"mean"===t[0]?"dictionary":"synonyms"})}).on("dataSet",function(e,t){g.hasState("select")&&(t.invalid&&(s._dictPopup={}),N())}).on("langChanged",function(){const t=T.getSrcLanguage(),s=T.getDstLanguage();T.setType(c.DictionaryPresenter.types.SYN,e.DICTIONARY_LANGS[t+"-"+t]).setType(c.DictionaryPresenter.types.REGULAR,e.DICTIONARY_LANGS[t+"-"+s]).setType(c.DictionaryPresenter.types.ANT,e.ANT_LANGS[t]).setType(c.DictionaryPresenter.types.DERIV,e.DERIV_LANGS[t])}),_.trText&&T.setText(_.trText),_.srcLang&&T.setSrcLanguage(_.srcLang),_.dstLang&&T.setDstLanguage(_.dstLang),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initSpeechRecognition=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(24),o=s(224),a=s(176),l=s(225),c=s(226),d=s(227),u=s(142),h=s(228),p=s(177),g=s(174),E=s(46);t.initSpeechRecognition=function(e){let t="";const s=this,i=this.getView(),_=this.getModel(),T=new r.TemplateView({element:e.ELEMENTS.interim,template:e.TEMPLATES.measurer}),m=new o.AudioVisualizerView({colors:["#e0e0e0","#e1e1e1","#e2e2e2"],shadow:{color:"#efefef",radius:10},element:e.ELEMENTS.volume,levelPayload:19}),f=new a.SpeechRecognizerView({element:e.ELEMENTS.microphone,activateFocus:!0,ignorePreventFocus:!0}),S=new d.SpeechRecognizerPresenter({view:f,model:new l.SpeechRecognizerModel({},{validators:{lang:e=>e}})}),C=e=>{const t=this.getSpeechRecognitionChip();S.getView().setVisible(!1),t.setVisible(!0).setProperty({type:e})},A=()=>{const t=S.getModel().isValid()?e.LOCALIZATIONS.asrValidState:e.LOCALIZATIONS.asrInvalidLangState;f.setTooltipText(t)},L=e.FORCE_UNIPROXY,y=!L;return e.ENABLE_NATIVE_ASR&&!L&&p.SpeechRecognizerNative.isAvailable()&&S.addRecognizer(new p.SpeechRecognizerNative({interimResults:!0})),y&&c.SpeechKitRecognizer.isAvailable()&&S.addRecognizer(new c.SpeechKitRecognizer({speechKitTimeout:e.SPEECHKIT_TIMEOUT,speechKitApikey:e.SPEECHKIT_KEY})),h.SpeechRecognizerUniproxy.isAvailable()&&S.addRecognizer(new h.SpeechRecognizerUniproxy({uniproxy:this._uniproxy})),this.bindFocusActivation(f),i.on("stateChanged:listening",function(e){e||S.stop()}),_.onChange("srcLang",e=>{S.setLanguage(e),A()}),f.setEnabled(!1).onStateChanged(a.RECOGNIZER_STATES.INVALID,e=>{f.setEnabled(!e)}),S.on(u.RECOGNITION_EVENTS.END,function(n){s.emit("asrEnd",n,t),i.setState("listening",!1),T.setHTMLContent(""),m.setVisible(!1).stopVisualization(),t="",n&&n.error===u.RECOGNITION_ERRORS.NETWORK&&(_.setProperty("tooltip",e.TOOLTIPS.sttErrorOldBrowser),f.setEnabled(!1))}).on(u.RECOGNITION_EVENTS.START,e=>{this.getSpeechRecognitionChip().setVisible(!1),S.getView().setVisible(!0);const n=S.getVisualizer();s.emit("asrStart",e),i.setState("listening",!0),n&&(n.fftSize=256,n.smoothingTimeConstant=.9,m.setVisible(!0).setAnalyserNode(n).startVisualization()),t=e}).on(u.RECOGNITION_EVENTS.RECOGNIZE,function(e){let i=_.getProperty("text");const n=/\S/.test(i.slice(-1))?" ":"";e.final?(i+=n+e.value,_.setProperty("text",i,{sender:"microphone"}),T.setHTMLContent(""),s.emit("asrResult",e,t)):T.renderData({text:n+e.value,leftText:i}).scrollTo(T.getScrollInfo().maxTop/100*_.getProperty("textScrollY"))}).on(u.RECOGNITION_EVENTS.MIC_DISABLED,()=>{C(g.MAC_NOTIFICATION_CHIP_TYPES.DISABLED)}).on(u.RECOGNITION_EVENTS.MIC_ENABLED,()=>{this.getSpeechRecognitionChip().setVisible(!1),S.getView().setVisible(!0),S.syncView()}).on(u.RECOGNITION_EVENTS.ACTIVATING,()=>{C(g.MAC_NOTIFICATION_CHIP_TYPES.ACTIVATING)}).setLanguage(_.getProperty("srcLang")),this.on("resize",n.default.debounce(()=>{f.isVisible()||this.getSpeechRecognitionChip().closeTooltip()})).addHotKey(E.HOT_KEYS_MAP.ASR,{view:f,getActionName:()=>i.hasState("listening")?"asr_stop":"asr_start"}),A(),this}},function(e,t,s){"use strict";t.__esModule=!0,t.AudioVisualizerView=void 0;var i=s(16);class n extends i.View{static extractVolume(e){let t,s,i=0;for(t=0,s=e.length;t<s;t++)i<e[t]&&(i=e[t]);return i/255}constructor(e={}){super(e),this._colors=e.colors||[],this._levelWidth=e.levelWidth||10,this._levelPayload=e.levelPayload||10,this._shadow=e.shadow||null}draw(e){let t;const s=this.getElement(),i=s.width/2*e/2,n=s.getContext("2d");t=Math.min(this._colors.length,Math.ceil(i/this._levelWidth));const r=t;for(n.clearRect(0,0,s.width,s.height);t--;)n.beginPath(),n.fillStyle=this._colors[t],n.arc(s.width/2,s.height/2,Math.min(this._levelWidth*(t+1),i)+this._levelPayload,0,2*Math.PI,!0),n.closePath(),t===r-1&&this._shadow&&(n.strokeStyle=this._shadow.color,n.lineWidth=this._shadow.radius,n.stroke()),n.fill()}setAnalyserNode(e){return this._analyserNode=e,this}stopVisualization(){return window.cancelAnimationFrame(this._frameId),this}startVisualization(){const e=this._analyserNode,t=new Uint8Array(e.frequencyBinCount);e.getByteFrequencyData(t),this.draw(n.extractVolume(t)),this._frameId=requestAnimationFrame(this.startVisualization.bind(this))}}t.AudioVisualizerView=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerModel=void 0;var i=s(4);class n extends i.Model{getDefaults(){return{lang:"",index:0}}increaseIndex(){return this.setProperty("index",this.getProperty("index")+1)}}t.SpeechRecognizerModel=n},function(e,t,s){"use strict";t.__esModule=!0,
t.SpeechKitRecognizer=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(177),o=s(142);class a extends o.SpeechRecognizerBase{static isAvailable(){return window.ya&&window.ya.speechkit&&(window.ya.speechkit.isSupported()||window.ya.speechkit.isWebAudioSupported())&&(!n.default.iOS||n.default.iOS>=13)}constructor(e={}){super(e);const t=window.ya.speechkit;this._timer=0,this._timeout=e.speechKitTimeout||0,this._resultIndex=0,this._supportedLangs=t.isWebAudioSupported()?r.SpeechRecognizerNative.langs:a.langs,this._recognitionOptions={apikey:e.speechKitApikey,format:t.FORMAT.OPUS||t.FORMAT.PCM16,punctuation:!1,partialResults:!0,utteranceSilence:250,allowMultiUtterance:!0,EouMode:"MultiUtterance"},this._recognition=new t.SpeechRecognition}setTimeout(){return this._timeout&&(clearTimeout(this._timer),this._timer=setTimeout(this.stopListening.bind(this),this._timeout)),this}startRecognition(e){this._recognition.start({...this._recognitionOptions,lang:e,initCallback:this._onStart.bind(this),stopCallback:this._onAbort.bind(this),dataCallback:this._onResult.bind(this),errorCallback:this._onAbort.bind(this)})}stopListening(){return this._recognition.abort(),this}convertLanguage(e,t){t(this._supportedLangs[e]||"")}prepareData(e,t){return{value:n.default.trim(e.text),final:e.final,index:t,resultIndex:e.resultIndex}}getVisualizer(){const e=this._recognition.recorder;return e&&e.getAnalyserNode?e.getAnalyserNode():null}getPriority(e){return n.default.iOS>=13&&n.default.safariVersion&&n.default.isOnline()?o.RECOGNITION_PRIORITIES.HIGH:n.default.isOnline()?o.RECOGNITION_PRIORITIES.NORMAL:o.RECOGNITION_PRIORITIES.LOW}_playSound(e){const t=new Audio;try{t.src=e,t.play()}catch(e){}}_onAbort(e){return clearTimeout(this._timer),this.emit(o.RECOGNITION_EVENTS.END,e)}_onStart(e,t,s){return this._resultIndex=0,this.setTimeout(),this.emit(o.RECOGNITION_EVENTS.START,s)}_onResult(e,t){const s={text:e,final:t,resultIndex:this._resultIndex};return e&&this.setTimeout(),t&&(this._resultIndex+=1),this.emit(o.RECOGNITION_EVENTS.RECOGNIZE,s)}}t.SpeechKitRecognizer=a,a.langs={en:"en-GB",ru:"ru-RU",tr:"tr-TR",uk:"uk-UA"}},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerPresenter=void 0,s(1);var i=s(20),n=s(142),r=s(176);class o extends i.Presenter{constructor(e){super(e);const t=this.getView(),s=this.getModel();this._loadingTimeout=0,this._recognizers=[],this.micButtonChip=e.micButtonChip||null,t.onTap(()=>{t.hasState(r.RECOGNIZER_STATES.INVALID)||(this.isActive()?this.stop():(t.setState(r.RECOGNIZER_STATES.PREPARING,!0),this.start(s.getProperty("lang"))))}),s.onChange(e=>{"lang"===e&&this.stop(),this.syncView()}),this.syncView()}addRecognizer(e){this._recognizers.push(e),e.on(n.RECOGNITION_EVENTS.START,this._onStartEvent.bind(this,e)).on(n.RECOGNITION_EVENTS.RECOGNIZE,this._onRecognizeEvent.bind(this,e)).on(n.RECOGNITION_EVENTS.END,this._onEndEvent.bind(this,e)).on(n.RECOGNITION_EVENTS.MIC_DISABLED,this._onMicDisabled.bind(this,e)).on(n.RECOGNITION_EVENTS.MIC_ENABLED,this._onMicEnabled.bind(this,e)).on(n.RECOGNITION_EVENTS.ACTIVATING,this._onMicActivating.bind(this,e)),e.onAsyncReady&&e.onAsyncReady(()=>{this._updateActiveRecognizerStatus()})}start(e){return this._clearLoadingTimeout(),this._loadingTimeout=setTimeout(()=>{this.getView().setState(r.RECOGNIZER_STATES.PREPARING,!1)},2e3),this._updateActiveRecognizer(e),this.getActiveRecognizer().startListening(e),this}stop(){return this._clearLoadingTimeout(),this.isActive()&&(this.getView().setState(r.RECOGNIZER_STATES.LISTENING,!1).setState(r.RECOGNIZER_STATES.PREPARING,!1),this.getActiveRecognizer().stopListening()),this}setLanguage(e){this.getModel().setProperty("origLang",e),this.getActiveRecognizer()||this._updateActiveRecognizer(e);const t=this.getActiveRecognizer();return t&&t.convertLanguage(e,e=>{this.getModel().setProperty("lang",e||"")}),this}prepareData(e,t=this.getActiveRecognizer()){return t.prepareData(e,this.getModel().getProperty("index"))}isActive(){return this.getView().hasState(r.RECOGNIZER_STATES.PREPARING)||this.getView().hasState(r.RECOGNIZER_STATES.LISTENING)}getVisualizer(){return this.getActiveRecognizer().getVisualizer()}getActiveRecognizer(){return this._recognizer}syncView(){const e=this.getView(),t=this.getModel().isValid();e.setState(r.RECOGNIZER_STATES.INVALID,!t)}_updateActiveRecognizer(e){this._recognizer=this._recognizers.map(t=>[t.getPriority(e),t]).sort(([e],[t])=>t-e).map(([e,t])=>t)[0]}_updateActiveRecognizerStatus(){return this.setLanguage(this.getModel().getProperty("origLang"))}_onStartEvent(e,t){this._clearLoadingTimeout(),this.getView().setState(r.RECOGNIZER_STATES.LISTENING,!0).setState(r.RECOGNIZER_STATES.PREPARING,!1).setState(r.RECOGNIZER_STATES.ACTIVATING,!1),this.emit(n.RECOGNITION_EVENTS.START,t)}_onRecognizeEvent(e,t){this.emit(n.RECOGNITION_EVENTS.RECOGNIZE,this.prepareData(t,e))}_onMicDisabled(){this.getView().setEnabled(!0).setState(r.RECOGNIZER_STATES.ACTIVATING,!1),this.emit(n.RECOGNITION_EVENTS.MIC_DISABLED)}_onMicEnabled(){this.getView().setState(r.RECOGNIZER_STATES.ACTIVATING,!1),this.emit(n.RECOGNITION_EVENTS.MIC_ENABLED)}_onMicActivating(){this.getView().setState(r.RECOGNIZER_STATES.ACTIVATING),this.emit(n.RECOGNITION_EVENTS.ACTIVATING)}_onEndEvent(e,t){const s=this.getModel();this._clearLoadingTimeout(),this.isActive()&&this.getView().setState(r.RECOGNIZER_STATES.LISTENING,!1).setState(r.RECOGNIZER_STATES.PREPARING,!1),t!==n.RECOGNITION_ERRORS.ABORTED&&(this.emit(n.RECOGNITION_EVENTS.END,{error:t,index:s.getProperty("index")}),s.increaseIndex())}_clearLoadingTimeout(){clearTimeout(this._loadingTimeout),this._loadingTimeout=0}}t.SpeechRecognizerPresenter=o},function(e,t,s){"use strict";t.__esModule=!0,t.SpeechRecognizerUniproxy=t.SUPPORTED_LANGS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(10),o=s(160),a=s(229),l=s(142);const c="Recognize",d="Result",u="InternalError",h={en:"en-GB",ru:"ru-RU",tr:"tr-TR",uk:"uk-UA"};t.SUPPORTED_LANGS=h;const p={"en-GB":"dialogeneral","ru-RU":"dialogeneral","tr-TR":"dialogeneral","uk-UA":"dialogeneral"};class g extends l.SpeechRecognizerBase{static isAvailable(){return!n.default.iOS&&a.MEDIA_RECORDER_SUPPORTED||window.config.FORCE_UNIPROXY}constructor(e={}){super(e),this._streamId=null,this._recorder=null,this._currentMessageId="",this._uniproxy=e.uniproxy,this._timeout=e.timeout||7e3}_setTimeout(){return this._timeout&&(clearTimeout(this._timer),this._timer=setTimeout(this.stopListening.bind(this),this._timeout)),this}_clearTimeout(){this._timeout&&clearTimeout(this._timer)}stopListening(){if(!this._streamId||!this._currentMessageId)return;const e=o.STREAM_CONTROL_REASONS.NO_ERROR;return this._uniproxy.closeStream(this._streamId,this._currentMessageId,e),this._clean(),this._onAbort(),this}startRecognition(e){this._streamId||(this._recorder||(this._recorder=new a.AudioRecorder(this._handleMicrophoneData.bind(this))),this._recorder.start(300,()=>{this._uniproxy.on("*",this._handleUniproxyEvent,this),this._uniproxy.on(o.EVENTS.ERROR,this._handleError,this),this._streamId=this._uniproxy.startStream(),this._uniproxy.ensureConnection(()=>{if(this._currentMessageId=this._uniproxy.sendRequest("ASR",c,{lang:e,streamId:this._streamId,format:a.AUDIO_FORMAT,timeoutInMilliseconds:this._timeout,punctuation:!1,topic:p[e]}),!this._currentMessageId)return this._throwNetworkError();this._onStart()})}))}_clean(){this._recorder.stop(),this._streamId=0,this._currentMessageId="",this._uniproxy.off("*",this._handleUniproxyEvent,this),this._uniproxy.off(o.EVENTS.ERROR,this._handleError,this),this._clearTimeout()}_handleMicrophoneData(e){this._streamId&&e.size&&(this._uniproxy.sendStreamData(this._streamId,e,a.AUDIO_FORMAT)||this._throwNetworkError())}_handleUniproxyEvent(e,t){switch(e){case o.EVENTS.MESSAGE:this._handleMessage(t.data);break;case o.EVENTS.STREAM_CONTROL:this._handleTransportStreamControl(t.data);break;case o.EVENTS.CLOSE:this._throwNetworkError()}}_handleTransportStreamControl(e){e._streamId===this._streamId&&e.action===o.STREAM_CONTROL_ACTIONS.CLOSE&&(this._clean(),this.emit(l.RECOGNITION_EVENTS.END))}_handleMessage(e){if(!e)return;const{header:t}=e;if("ASR"===t.namespace)switch(t.name){case d:this._handleASRResult(e)}}_handleASRResult({header:e,payload:t}){t.responseCode!==u?this._currentMessageId&&t.recognition.length&&this._onResult(t.recognition[0].normalized,t.endOfUtt||t.earlyEndOfUtt):this._handleError({data:{header:e,payload:t},error:l.RECOGNITION_ERRORS.NETWORK})}_handleError(e){if(e&&e.data&&e.data.header){const{header:t}=e.data;t&&t.refMessageId===this._currentMessageId&&(this._throwNetworkError(),(0,r.getGlobalEmitter)().emit("uniproxyAsrError",e.error,{format:a.AUDIO_FORMAT,sampleRate:a.SAMPLE_RATE,recorderSupported:a.MEDIA_RECORDER_SUPPORTED?1:0}))}}_throwNetworkError(){this._clean(),this.emit(l.RECOGNITION_EVENTS.END,l.RECOGNITION_ERRORS.NETWORK)}_playSound(e){const t=new Audio;try{t.src=e,t.play()}catch(e){}}_onAbort(e){return this._clearTimeout(),this.emit(l.RECOGNITION_EVENTS.END,e)}_onStart(){return this._resultIndex=0,this._setTimeout(),this.emit(l.RECOGNITION_EVENTS.START,"uniproxy")}_onResult(e,t){const s={text:e,final:t,resultIndex:this._resultIndex};return e&&this._setTimeout(),t&&(this._resultIndex+=1),this.emit(l.RECOGNITION_EVENTS.RECOGNIZE,s)}convertLanguage(e,t){t(h[e]||"")}prepareData({text:e,final:t,resultIndex:s},i){return{value:n.default.trim(e),final:t,index:i,resultIndex:s}}getVisualizer(){return this._recorder&&this._recorder.getAnalyserNode()}getPriority(e){return n.default.isOnline()&&e===h.ru?l.RECOGNITION_PRIORITIES.HIGH:l.RECOGNITION_PRIORITIES.LOW}}t.SpeechRecognizerUniproxy=g},function(e,t,s){"use strict";t.__esModule=!0,t.SAMPLE_RATE=t.MEDIA_RECORDER_SUPPORTED=t.MEDIA_RECORDER_STATES=t.AudioRecorder=t.AUDIO_FORMAT=void 0;var i=s(230),n=s(178);const r={INACTIVE:"inactive",RECORDING:"recording",PAUSED:"paused"};t.MEDIA_RECORDER_STATES=r;const o=window.AudioContext||window.webkitAudioContext||null,a=Boolean(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(window.MediaRecorder||o));t.MEDIA_RECORDER_SUPPORTED=a;const l=!window.MediaRecorder;t.SAMPLE_RATE=16e3;const c=function(){if(l)return n.AUDIO_FORMATS.WAV_PCM+";rate=16000";const e=window.MediaRecorder.isTypeSupported||window.MediaRecorder.isMimeTypeSupported||window.MediaRecorder.canRecordMimeType||(()=>!1);return e(n.AUDIO_FORMATS.OGG)?n.AUDIO_FORMATS.OGG:e(n.AUDIO_FORMATS.WEBM)?n.AUDIO_FORMATS.WEBM:n.AUDIO_FORMATS.WAV_PCM}();t.AUDIO_FORMAT=c,t.AudioRecorder=class{constructor(e){this.dataHandler=e}start(e=1e3,t){navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{this.mediaRecorder=function(e){const t={mimeType:c,audioBitsPerSecond:16e3};return l?new i.MediaRecorder(e,t):new window.MediaRecorder(e,t)}(s),this.mediaRecorder.state===r.INACTIVE&&(this.mediaRecorder.addEventListener("dataavailable",this.handleDataAvailable.bind(this)),this.mediaRecorder.addEventListener("error",this.handleError.bind(this)),this.mediaRecorder.start(e)),this.stream=s,t()}).catch(e=>{this.handleError()})}stop(){this.stream&&this.stream.getTracks&&this.stream.getTracks().forEach(function(e){e.stop()}),this.mediaRecorder&&(this.mediaRecorder.removeEventListener("dataavailable",this.handleDataAvailable.bind(this)),this.mediaRecorder.removeEventListener("error",this.handleError.bind(this)),this.mediaRecorder.state!==r.INACTIVE&&this.mediaRecorder.stop(),this.mediaRecorder=null,this.stream=null)}handleDataAvailable(e){this.dataHandler(e.data)}handleError(){this.stop()}getAnalyserNode(){return o&&this.stream?(this.audiocontext||(this.audiocontext=new o),this.analyserNode&&this.analyserNode.disconnect(),this.analyserNode=this.audiocontext.createAnalyser(),this.analyserNode.fftSize=2048,this.audioInput&&this.audioInput.disconnect(),this.audioInput=this.audiocontext.createMediaStreamSource(this.stream),this.audioInput.connect(this.analyserNode),this.analyserNode):null}}},function(e,t,s){"use strict";t.__esModule=!0,t.RECORDER_STATES=t.MediaRecorder=void 0;var i=s(231);const n=window.AudioContext||window.webkitAudioContext,r={INACTIVE:"inactive",RECORDING:"recording",PAUSED:"paused"};let o;t.RECORDER_STATES=r;let a=null;t.MediaRecorder=class{static isTypeSupported(e){return/audio\/x-pcm?/.test(e)||/audio\/x-raw?/.test(e)||/audio\/wave?/.test(e)}constructor(e,t){this.state=r.INACTIVE,this.mimeType="audio/x-pcm;bit=16",this.outSampleRate=16e3,this.em=document.createDocumentFragment(),this.stream=e,this.mimeType=t&&t.mimeType||this.mimeType,this.outSampleRate=t&&t.audioBitsPerSecond||this.outSampleRate,this.encoder=a||(a=new i.PcmEncoder),this.encoder.onDataReadyCallback=this._onEncoderResult.bind(this)}start(e){this.state===r.INACTIVE&&(this.state=r.RECORDING,o||(o=new n),this._initEncoder(),this.input=o.createMediaStreamSource(this.stream),this.processor=o.createScriptProcessor(2048,2,2),this.input.connect(this.processor),this.processor.connect(o.destination),this.processor.onaudioprocess=this._onAudioProcess.bind(this),this.dispatchEvent(new Event("start")),e&&(this.slicing=window.setInterval(this._onTimeSliceInterval.bind(this),e)))}_initEncoder(){this.encoder.init&&this.encoder.init({sampleRate:o.sampleRate,outSampleRate:this.outSampleRate})}_requestData(){this.state!==r.INACTIVE&&this.encoder.requestData()}_onEncoderResult(e){const t=new Blob([e],{type:this.mimeType}),s=new MessageEvent("dataavailable",{data:t});this.dispatchEvent(s),this.state===r.INACTIVE&&this.dispatchEvent(new Event("stop"))}_onAudioProcess(e){this.state===r.RECORDING&&this.encoder.handleAudioInput(e.inputBuffer)}_onTimeSliceInterval(){this.state===r.RECORDING&&this._requestData()}stop(){this.state!==r.INACTIVE&&(this._requestData(),this.state=r.INACTIVE,clearInterval(this.slicing),this.stream.getAudioTracks().forEach(e=>{e.stop()}),this.input.disconnect(this.processor),this.processor.disconnect(o.destination),this.processor.onaudioprocess=null,delete this.processor,delete this.input)}pause(){this.state===r.RECORDING&&(this.state=r.PAUSED,this.dispatchEvent(new Event("pause")))}resume(){this.state===r.PAUSED&&(this.state=r.RECORDING,this.dispatchEvent(new Event("resume")))}addEventListener(...e){this.em.addEventListener.apply(this.em,e)}removeEventListener(...e){this.em.removeEventListener.apply(this.em,e)}dispatchEvent(...e){return this.em.dispatchEvent.apply(this.em,e)}}},function(e,t,s){"use strict";t.__esModule=!0,t.PcmEncoder=void 0;var i,n=(i=s(232))&&i.__esModule?i:{default:i};t.PcmEncoder=class{constructor(){this.worker=function(e){const t=e.toString().replace(/^function\s*\(\)\s*{/,"").replace(/}$/,""),s=new Blob([t]);return new Worker(URL.createObjectURL(s))}(n.default),this.worker.addEventListener("message",this.handleResultFromWorker.bind(this))}init(e){this.worker.postMessage(["init",{sampleRate:e.sampleRate,format:{sampleRate:e.outSampleRate,bufferSize:2048},channels:1}])}handleAudioInput(e){this.worker.postMessage(["encode",e.getChannelData(0)])}requestData(){this.worker.postMessage(["dump"])}handleResultFromWorker(e){this.onDataReadyCallback(e.data)}}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default="function() {\n    var recLength = 0;\n    var recBuffers = [];\n    var sampleRate;\n    var outSampleRate;\n    var needBufferSize = 4096;\n    var channels = 1;\n\n    function init(config) {\n        sampleRate = config.sampleRate;\n        outSampleRate = config.format.sampleRate || sampleRate;\n        needBufferSize = config.format.bufferSize || needBufferSize;\n    }\n\n    var resample = (inbuf) => {\n        var speed = Number(sampleRate) / outSampleRate;\n        var l = Math.ceil(inbuf.length / speed);\n        var result = new Float32Array(l);\n        var indexIn = 0;\n        var indexOut = 0;\n        for (indexOut = 1, indexIn = speed; indexOut < l - 1; indexIn += speed, indexOut++) {\n            var pos = Math.floor(indexIn);\n            var dt = indexIn - pos;\n            var second = (pos + 1 < inbuf.length) ? pos + 1 : inbuf.length - 1;\n            result[indexOut] = inbuf[pos] * (1 - dt) + inbuf[second] * dt;\n        }\n        result[0] = inbuf[0];\n        result[l - 1] = inbuf[inbuf.length - 1];\n        return result;\n    };\n\n    function record(inputBuffer) {\n        if (outSampleRate === sampleRate) {\n            recBuffers.push(inputBuffer);\n            recLength += inputBuffer.length;\n        } else {\n            var resin = resample(inputBuffer);\n            recBuffers.push(resin);\n            recLength += resin.length;\n        }\n    }\n\n    function exportWAV() {\n        var buffer = mergeBuffers(recBuffers, recLength);\n        var dataView = encodeWAV(buffer);\n        return dataView.buffer;\n    }\n\n    function clear() {\n        recLength = 0;\n        recBuffers = [];\n    }\n\n    function mergeBuffers(recBuffersArg, recLengthArg) {\n        var result = new Float32Array(recLengthArg);\n        var offset = 0;\n        for (var i = 0; i < recBuffersArg.length; i++) {\n            result.set(recBuffersArg[i], offset);\n            offset += recBuffersArg[i].length;\n        }\n        return result;\n    }\n\n    function floatTo16BitPCM(output, offset, input) {\n        for (var i = 0; i < input.length; i++, offset += 2) {\n            var s = Math.max(-1, Math.min(1, input[i]));\n            output.setInt16(offset, s < 0 ? s * 32768 : s * 32767, true);\n        }\n    }\n\n    function writeString(view, offset, string) {\n        for (var i = 0; i < string.length; i++) {\n            view.setUint8(offset + i, string.charCodeAt(i));\n        }\n    }\n\n    function encodeWAV(samples) {\n        var buffer = new ArrayBuffer(44 + samples.length * 2);\n        var view = new DataView(buffer);\n        /* RIFF identifier */\n        writeString(view, 0, 'RIFF');\n        /* file length */\n        view.setUint32(4, 32 + samples.length * 2, true);\n        /* RIFF type */\n        writeString(view, 8, 'WAVE');\n        /* format chunk identifier */\n        writeString(view, 12, 'fmt ');\n        /* format chunk length */\n        view.setUint32(16, 16, true);\n        /* sample format (raw) */\n        view.setUint16(20, 1, true);\n        /* channel count */\n        view.setUint16(22, channels, true);\n        /* sample rate */\n        view.setUint32(24, outSampleRate, true);\n        /* block align (channel count * bytes per sample) */\n        var blockAlign = channels * 2;\n        /* byte rate (sample rate * block align) */\n        view.setUint32(28, outSampleRate * blockAlign, true);\n        /* block align (channel count * bytes per sample) */\n        view.setUint16(32, blockAlign, true);\n        /* bits per sample */\n        view.setUint16(34, 16, true);\n        /* data chunk identifier */\n        writeString(view, 36, 'data');\n        /* data chunk length */\n        view.setUint32(40, samples.length * 2, true);\n        floatTo16BitPCM(view, 44, samples);\n        return view;\n    }\n\n    function dump() {\n        var result = exportWAV();\n        postMessage(result, [result]);\n        clear();\n    }\n\n    onmessage = (e) => {\n        var command = e.data[0];\n        var data = e.data[1];\n        switch (command) {\n            case 'init':\n                init(data);\n                break;\n            case 'encode':\n                record(data);\n                break;\n            case 'dump':\n                dump();\n                break;\n            default:\n                break;\n        }\n    };\n}"},function(e,t,s){"use strict";t.__esModule=!0,t.initPredictor=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(150),o=s(173),a=s(11),l=s(141),c=s(161);t.initPredictor=function(e){const t=this,s=this.getView(),i=this.getSettings(),d=this.getModel(),u=d.toJSON(),h=this.getMeasurerViewSrc(),p=this.getPredictorPresenter(),g=p.getView(),E=()=>{if(!g.isEnabled())return;const e=h.getContentElement("[data-measurer-target]");e&&g.setPosition(e.getBoundingClientRect(),!1,!0)};return this.on([c.TEXTAREA_APP_EVENTS.BLUR,c.TEXTAREA_APP_EVENTS.TAP],n.default.debounce(()=>{g.setEnabled(!1)},150)).on(c.TEXTAREA_APP_EVENTS.FOCUS,e=>{e&&g.setEnabled(!1)}).on("resize",n.default.debounce(E,100)).on(c.TEXTAREA_APP_EVENTS.KEYDOWN,e=>{switch(e.keyCode){case a.InputView.keys.ENTER:if(e.shiftKey)break;i.isOptionEnabled(l.AVAILABLE_OPTIONS.ENTER)||n.default.preventEvent(e),g.isEnabled()&&(n.default.preventEvent(e),p.setValue(g.getValues()[0],{enter:!0})),this.updateTrText("enter");break;default:e.keyCode===a.InputView.keys.ESCAPE&&g.isEnabled()&&this.updateTrText("escape"),g.setEnabled(!1)}}),this.on("action:toggleAuto",()=>{p.toggleAuto()}),d.on("change",(t,s,i)=>{let n,r;switch(t){case"text":if("url"===i.sender&&e.DEFAULT_SRC_LANG)return;r=this.toJSON(),n=i.caret?i.caret+s.slice(i.caret).search(/\s|$/):0,p.setText(o.PredictorModel.extractWords(s.slice(0,n),"paste"===i.reason?e.MAX_PREDICTOR_WORDS:e.MIN_PREDICTOR_WORDS),i.sender||i.reason).setIndex(n).setSrcLanguage(r.srcLang).setDstLanguage(r.dstLang);break;case"srcLang":p.setSrcLanguage(s,{reason:"lang"});break;case"dstLang":p.setDstLanguage(s);break;case"textScrollY":g.setEnabled(!1)}}),p.prepareData=(e=>({values:[{value:e[0]}],value:e[0]})),p.on("auto",e=>{s.setState("auto",e),i.setProperty("auto",e)}).on("ready",e=>{const s=d.getProperty("text");if("input"!==e.reason)return g.setEnabled(!1);const i=r.PredictorPresenter.createRange(s,e);if(!i)return g.setEnabled(!1);h.renderData({text:s.slice(i.start,i.end)||".",leftText:s.slice(0,i.start),rightText:s.slice(i.end)}).scrollTo(h.getScrollInfo().maxTop/100*d.getProperty("textScrollY")),E(),t.emit("predictorShow",e)}).on("detect",(e,s)=>{s||t.setSrcLanguage(e)}).on("predict",(e,s)=>{const i=o.PredictorModel.prepareValue(d.getProperty("text"),e);d.setProperty("text",i.text,{caret:i.caret,sender:"predictor"}),t.emit("predictorApply",e,s.enter)}).on("endOfWord",()=>{t.emit("predictorEndOfWord").updateTrText()}),u.srcLang&&p.setSrcLanguage(u.srcLang),u.dstLang&&p.setDstLanguage(u.dstLang),p.toggleAuto(!i.hasProperty("auto")||i.getProperty("auto")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initCollections=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2),o=s(32),a=s(168),l=s(146),c=s(235),d=s(140),u=s(11),h=s(152),p=s(236),g=s(135),E=s(72),_=s(237),T=s(24),m=s(179),f=s(180),S=s(181),C=s(4),A=s(182),L=s(46),y=s(183),R=s(186);t.initCollections=function(e){let t;const s=this,i=this.getView(),O=this._settings,I=this.getModel(),P=(0,y.getCollectionsEmitter)(),N=new r.TouchView({element:e.ELEMENTS.favButton}),v=new r.TouchView({element:e.ELEMENTS.collectionsView,hideAfterTransition:!0}),b=new o.ListboxView({element:e.ELEMENTS.collectionList,template:e.TEMPLATES.collections,contentElement:e.ELEMENTS.collectionListContent,debounceRendering:!0}),M=new a.CollectionModel({srv:e.SRV,uid:e.UID,url:e.COLLECTIONS_URL,limit:e.MAX_COLLECTIONS,recordsLimit:e.MAX_FAV_ITEMS2,xtoken:e.CSRF_TOKEN,shouldSyncHistory:e.ENABLE_HISTORY_SYNC},{defaultFavName:e.DEFAULT_FAV_NAME,defaultHistoryName:e.DEFAULT_HISTORY_NAME,validators:{items(){return this.getItems()},text:t=>t&&t.length<=e.MAX_FAV_TEXT_LENGTH&&!n.default.isUrl(t),srcLang:e=>e,dstLang:e=>e,translation:t=>t&&t.length<=e.MAX_FAV_TEXT_LENGTH,activeId(e){const t=this.getItems();return t&&t.filter(function(t){return t.id===e&&l.CollectionServerModel.isNotDeleted(t)&&!l.CollectionServerModel.isSubscription(t)}).length}}}),x=new c.CollectionPresenter({view:b,model:M}),D=new d.InputPresenter({view:new u.InputView({element:e.ELEMENTS.collectionSearch,activateFocus:!0,contentElement:e.ELEMENTS.collectionSearchInput}),model:new h.InputModel}),w=D.getView(),V=new u.InputView({element:e.ELEMENTS.collectionName,activateFocus:!0,contentElement:e.ELEMENTS.collectionNameInput}),k=new p.CollectionNameInputPresenter({view:V,model:new h.InputModel}),U=new r.TouchView({element:e.ELEMENTS.addCollectionButton}),H=new r.TouchView({element:e.ELEMENTS.createCollectionButton}),G=new u.InputView({element:e.ELEMENTS.collectionAddPopup,activateFocus:!0,contentElement:e.ELEMENTS.collectionNameInput2}),B=new p.CollectionNameInputPresenter({view:G,model:new h.InputModel}),F=new u.InputView({element:e.ELEMENTS.collectionsNameEditPopup,activateFocus:!0,contentElement:e.ELEMENTS.collectionNameInput3}),Y=new p.CollectionNameInputPresenter({view:F,model:new h.InputModel}),$=new o.ListboxView({element:e.ELEMENTS.topList,template:e.TEMPLATES.collections,debounceRendering:!0}),W=new g.ListboxPresenter({view:$,model:new E.ListboxModel}),K=new o.ListboxView({element:e.ELEMENTS.recordsList,template:e.TEMPLATES.records,contentElement:e.ELEMENTS.recordsListContent,debounceRendering:!0}),X=new _.ListboxMultiplePresenter({view:K,model:new E.ListboxModel}),q=new o.ListboxView({element:e.ELEMENTS.subscribeTooltip,template:e.TEMPLATES.empty}),j=new r.TouchView({element:e.ELEMENTS.collectionMenuButton,activateFocus:!0}),z=new g.ListboxPresenter({view:new o.ListboxView({element:e.ELEMENTS.collectionMenuListbox,template:e.TEMPLATES.menu,stopDefaultAction:!0}),model:new E.ListboxModel}),J=z.getView(),Q=new r.TouchView({element:e.ELEMENTS.recordMovePopup,activateFocus:!0}),Z=new o.ListboxView({element:e.ELEMENTS.recordMovePopupList,template:e.TEMPLATES.collectionsPopupList}),ee=new r.TouchView({element:e.ELEMENTS.recordCopyPopup,activateFocus:!0}),te=new o.ListboxView({element:e.ELEMENTS.recordCopyPopupList,template:e.TEMPLATES.collectionsPopupList}),se=new r.TouchView({element:e.ELEMENTS.collectionHeader,contentElement:e.ELEMENTS.collectionHeaderName}),ie=new o.ListboxView({element:e.ELEMENTS.collectionHeaderContent,template:e.TEMPLATES.collectionHeader}),ne=new r.TouchView({element:e.ELEMENTS.collectionTumbler}),re=new T.TemplateView({element:e.ELEMENTS.collectionsToast,template:e.TEMPLATES.collectionsToast}),oe=new r.TouchView({element:e.ELEMENTS.collectionNewAddPopup,activateFocus:!0}),ae=new o.ListboxView({element:e.ELEMENTS.collectionsPopupList,template:e.TEMPLATES.collectionsPopupList}),le=new r.TouchView({element:e.ELEMENTS.shareCollectionTumbler}),ce=new r.TouchView({element:e.ELEMENTS.shareCollectionInput,stopDefaultAction:!0}),de=new r.TouchView({element:e.ELEMENTS.shareCollectionCopy,activateFocus:!0}),ue=new m.SharePresenter({view:new o.ListboxView({element:e.ELEMENTS.shareCollection,template:e.TEMPLATES.listbox,contentElement:e.ELEMENTS.shareCollectionContent,stopDefaultAction:!0}),model:new f.ShareModel({url:e.SHARE_URL,title:document.title})}),he=ue.getView(),pe=new r.TouchView({element:e.ELEMENTS.selectAllButton}),ge=new S.TTSPresenter({view:new r.TouchView({stopDefaultAction:!0}),model:new C.Model}),Ee=function(){const e=this.toJSON();x.setText(e.trText).setSrcLanguage(e.srcLang).setDstLanguage(e.dstLang).setTranslation(e.translation).checkRecord(),re.setVisible(!1)},_e=function(e){let t=0;const s=X.getSelectedItems(),{recordsLimit:i}=M.getProps();return s.length?t=s.length:v.isVisible()||(t=1),{collections:e.filter(function(e){return!l.CollectionServerModel.isSubscription(e)&&l.CollectionServerModel.isNotDeleted(e)&&e.type!==l.COLLECTION_TYPES.HISTORY}).map(function(e){return{color:e.color,private:e.type!==l.COLLECTION_TYPES.FAVORITES&&!e.public,disabled:e.recordsCount+t>i,collectionId:e.id,collectionType:e.type,collectionName:e.name,collectionIcon:e.type===l.COLLECTION_TYPES.FAVORITES?"":e.name.charAt(0),collectionCount:e.recordsCount}})}},Te=function(e,t){return{collectionId:e.id,collectionType:e.type,recordsCount:e.recordsCount||e.count||0,subscribersCount:e.subscribersCount,author:e.authorName,subscribed:t}},me=function(t){const i=Date.now();v.hasState("sync")||(O.getProperty("syncedTimestamp")||0)+e.PRESYNC_TIMEOUT>i?x.getCollectionList():(e.UID&&(O.setProperty("syncedTimestamp",i),s.emit("collectionsSync",t)),v.setState("sync",!0),x.syncCollections())},fe=()=>{M.setProperty("shouldSyncHistory",e.ENABLE_HISTORY_SYNC&&I.getProperty("historyEnabled"))};return(0,R.getAvailablePlayers)(e,this._uniproxy).forEach(e=>{ge.addPlayer(e)}),N.on("tap",function(){let t,i=x.getItems().filter(function(e){return e.id===x.getActiveId()})[0];if(i.type===l.COLLECTION_TYPES.HISTORY){const e=x.getCollectionByType(l.COLLECTION_TYPES.FAVORITES);if(!e)return;x.setActiveId(e.id),i=e}this.hasState("favourite")?(re.renderData({deleted:!0,message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES.deleted,i.name)}),x.getActive(),s.emit("recordDelete",i.id)):(t=i.recordsCount>=M.getProperty("recordsLimit"),t||x.addRecords(),re.renderData({message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES[t?"limit":"added"],i.name)}),s.emit("recordAdd",t,i.id)),re.setVisible(!0),oe.setVisible(!1)}).on("stateChanged:favourite",function(t){this.getElement().setAttribute("data-tooltip",t?e.TOOLTIPS.collections2:e.TOOLTIPS.collections)}),re.on("tap",function(){this.setVisible(!1)}).on("contentChanged",function(){clearTimeout(t),t=setTimeout(function(){re.setVisible(!1)},e.POPUP_DELAY)}).on("stateChanged:hidden",function(e){e&&clearTimeout(t)}),q.on("stateChanged:hidden",function(e){e||setTimeout(function(){q.setVisible(!1)},1200)}),this.on("toggleCollections",function(e){v.setVisible(e)}).on("editorResult",function(e){x.setTranslation(e).checkRecord()}).on("action",function(t,r){let o,a,c,d,u,h;switch(t){case"toggleFav":if(i.hasState("db_inactive")){s.emit("collectionsInactiveTap"),i.setState({db_overlay:!0,db_blocked:O.getProperty("databaseBlocked")});break}v.setVisible(),s.emit("collectionsActivated",v.isVisible());break;case"closeDbOverlay":i.setState("db_overlay",!1);break;case"collectionsReturn":v.setState({add:!1,records:!1,select:!1,copy:!1}),D.setValue(""),x.setValue("").getCollectionList(),W.setValue("");break;case"closeAddPopup":G.setVisible(!1);break;case"closeRecordMovePopup":Q.setVisible(!1),ee.setVisible(!1),oe.setVisible(!1);break;case"recordsReturn":v.setState({records:!0,select:!1,copy:!1,menu:!1});break;case"addCollection":if(v.hasState("limit"))return void q.setPosition(r.getBoundingClientRect(),!0).setVisible(!0);s.emit("newCollectionTap"),k.setValue(x.getDefaultName(e.DEFAULT_COLLECTION_NAME)),V.setSelection({start:0,end:k.getValue().length}),ne.setState("active",!0),v.setState("add",!0);break;case"addCollection2":oe.setVisible(!1),ee.setVisible(!1),Q.setVisible(!1),B.setValue(""),G.setVisible(!0).setFocus(!0);break;case"createCollectionAndAdd":if(o=n.default.trim(B.getValue()),o){if(V.setFocus(!0),v.hasState("limit")){G.setState("limit",!0);break}if(a=x.getItems().filter(function(e){return e.name===o}),a.length){G.setState("alert",!0);break}x.createCollection({name:o,public:!1},!0),G.setVisible(!1),oe.setVisible(!1),v.hasState("copy")||v.hasState("select")||(re.renderData({message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES.added,o)}),re.setVisible(!0))}else G.setFocus(!0);break;case"deleteRecord":u=x.getValue(),c=x.getSelectedCollection(),r&&c&&!l.CollectionServerModel.isSubscription(c)&&(s.emit("recordDelete",u),x.deleteRecords(r.getAttribute("data-index")).setActiveId(u),c.recordsCount=c.recordsCount-1,ie.renderData(Te(c)));break;case"deleteRecords":a=X.getValue(),u=x.getValue(),s.emit("recordsDelete",{count:a.length,total:X.getItems().length}),x.deleteRecords(a).setActiveId(u),v.setState("select",!1);break;case"moveRecords":a=x.getItems(),u=x.getValue(),x.setActiveId(u),Z.renderData(_e(a)),Q.setVisible(!0);break;case"changeCollection":a=x.getItems(),ae.renderData(_e(a)),oe.setVisible(!0),re.setVisible(!1);break;case"closeCollectionPopup":re.setVisible(!1),F.setVisible(!1),he.setVisible(!1);break;case"deleteCollection":if(!window.confirm(n.default.getAttribute(r,"data-confirm")))break;c=x.getSelectedCollection(),x.deleteCollection(x.getValue()),v.setState("records",!1),l.CollectionServerModel.isSubscription(c)?s.emit("collectionUnsubscribe",l.COLLECTION_TYPES.BROKEN_SUBSCRIPTION):s.emit("collectionDeleted");break;case"clearCollection":if(!window.confirm(n.default.getAttribute(r,"data-confirm")))break;a=X.getItems().map(e=>e.id),x.deleteRecords(a),x.setValue(""),
v.setState("records",!1),s.emit("collectionCleared");break;case"disableHistory":v.setVisible(!1),s.emit("collectionsActivated",v.isVisible()),setTimeout(()=>{x.setValue(""),v.setState("records",!1),this.emit("interactiveSettingChange",{settingKey:"history",enabled:!1})},700);break;case"syncCollections":me(!0);break;case"editRecords":v.setState("select",!0);break;case"editSubscriptionRecords":v.setState("copy",!0);break;case"editCollection":o=x.getSelectedCollection().name,Y.setValue(o),F.setVisible(!0).setFocus(!0);break;case"renameCollection":if(o=n.default.trim(Y.getValue()),u=x.getValue(),o){if(a=x.getItems().filter(function(e){return e.name===o}),a.length)return void F.setState("alert",!0);F.setVisible(!1),x.updateCollection(u,{name:o}).setValue(""),v.setState("records",!1),s.emit("collectionRenamed")}else F.setFocus(!0);break;case"subscribe":if(d=n.default.getAttribute(r,"data-subscribe-type"),!e.UID)return void s.emit("collectionSubscribed",d);if(v.hasState("limit"))return q.setPosition(r.getBoundingClientRect(),!0).setVisible(!0),void s.emit("collectionSubscribed",d,!0);u=W.getValue()?W.getValue():n.default.getAttribute(r,"data-index","0"),c=W.getItems().filter(function(e){return e.id===u})[0],x.subscribeToCollection(c),v.setState("records",!1),W.setValue(""),s.emit("collectionSubscribed",d);break;case"unsubscribeFromCollection":window.confirm(n.default.getAttribute(r,"data-confirm"))&&(u=x.getValue()||n.default.getAttribute(r,"data-index","0"),u||(u=W.getValue(),u=x.getItems().filter(function(e){return e.sourceCollectionId===u})[0].id),x.deleteCollection(u).setValue(""),v.setState("records",!1),W.setValue(""),s.emit("collectionUnsubscribed",l.COLLECTION_TYPES.SUBSCRIPTION));break;case"saveCollection":x.saveCollection(),s.emit("collectionSaved");break;case"shareCollection":c=x.getSelectedCollection(),h=c&&l.CollectionServerModel.isSubscription(c),c&&!h&&le.setState("active",c.public),he.setState({top:Boolean(W.getValue()),subscription:h}).setVisible(!0);break;case"copyRecords":a=x.getItems(),te.renderData(_e(a)),ee.setVisible(!0);break;case"expandSearch":case"collapseSearch":v.setState("search"),D.setValue(""),w.setFocus("expandSearch"===t);break;case"soundCollection":ge.setText(n.default.trim(n.default.getAttribute(r,"data-text"))).setLanguage(n.default.getAttribute(r,"data-lang")).toggle();break;case"collectionMail":ue.write()}}).on(A.HISTORY_APP_EVENTS.OPEN_HISTORY,()=>{const e=x.getHistoryCollectionId();e&&(v.setState("prevent-animation",!0),x.setValue(e),v.setVisible(),s.emit("collectionsActivated",v.isVisible()),setTimeout(()=>v.setState("prevent-animation",!1),200))}).addHotKey(L.HOT_KEYS_MAP.FAV,{view:N,getActionName:()=>N.hasState("favourite")?"fav_record_delete":"fav_record_add"}).bindFocusActivation(N),i.on("stateChanged:edited",function(e){e||x.setTranslation(I.getProperty("translation"))}).on("keydown",e=>{e.keyCode===u.InputView.keys.ESCAPE&&v.isVisible()&&(v.setVisible(!1),s.emit("collectionsActivated",!1))}),I.onSet("translation",Ee).onChange("historyEnabled",e=>{x.emit("updateView"),fe(),e&&me()}),v.on("stateChanged",function(e,t){let n;switch(e){case"hidden":n=!t,i.setState("favourite",n),s.emit("collectionsOpened",n),t?(this.setState({add:!1,menu:!1,select:!1,copy:!1}),W.setValue("")):(me(),re.setVisible(!1),oe.setVisible(!1),W.getItems()||x.getTopCollectionsList());break;case"records":t||this.setState("search",!1);break;case"select":case"copy":t||(X.setValue([]),pe.setState("selected",!1))}}),x.prepareData=function(e){const t={},s={blocks:[]};let i=[];const r=e.filter(function(e){return e});if(n.default.isEmpty(r))return s;const{historyEnabled:o}=I.getProps();return s.blocks.push({header:t.collection,collections:r.filter(function(e){return!l.CollectionServerModel.isSubscription(e)&&(e.type!==l.COLLECTION_TYPES.HISTORY||o)}).map(function(e){return{color:e.color,isHistory:e.type===l.COLLECTION_TYPES.HISTORY,private:e.type!==l.COLLECTION_TYPES.FAVORITES&&e.type!==l.COLLECTION_TYPES.HISTORY&&!e.public,collectionId:e.id,collectionType:e.type,collectionName:e.name,collectionCount:e.recordsCount}})}),i=r.filter(function(e){return l.CollectionServerModel.isSubscription(e)}),i.length&&s.blocks.push({header:t.subscription,collections:i.map(function(e){return{color:e.color,collectionId:e.id,collectionName:e.name,collectionIcon:e.name.charAt(0),collectionCount:e.count||e.recordsCount,collectionAuthor:e.authorName,broken:e.type===l.COLLECTION_TYPES.BROKEN_SUBSCRIPTION}})}),s},x.on("itemsChanged",function(t,i){const n=this.getItems();!O.hasProperty("usingCollections")&&n.length>1&&O.setProperty("usingCollections",Date.now()),i||(this.initializeActiveId(O.getProperty("activeId")),window.location.pathname===e.COLLECTIONS_PATHNAME&&v.setVisible(!0),s.emit("firstCollectionsChange"))}).on("valueChanged",function(t){if(!t)return;const s=this.getSelectedCollection();if(X.setItems(""),v.setState("broken",!1),!s)return v.setState("records",!1),void x.setValue("");const i=se.getElement(),n=J.getElement();ie.renderData(Te(s)),se.setTextContent(s.name),K.getElement().setAttribute("data-collection-type",s.type),i.setAttribute("data-collection-type",s.type),i.setAttribute("data-color",s.color||""),n.setAttribute("data-collection-type",s.type),n.setAttribute("data-subscribed",""),x.getHistoryCollectionId()===s.id?z.setItems(e.HISTORY_MENU_ITEMS):l.CollectionServerModel.isSubscription(s)?s.type===l.COLLECTION_TYPES.BROKEN_SUBSCRIPTION?v.setState("broken"):z.setItems(e.SUBSCRIPTION_MENU_ITEMS):z.setItems(e.COLLECTION_MENU_ITEMS)}).on("addToNewCollection",function(e){if(v.hasState("copy")||v.hasState("select")){const t=X.getSelectedItems();s.emit(v.hasState("select")?"recordsMoved":"recordsCopy",{count:t.length,sender:"list",new:1}),v.hasState("select")?(x.moveRecords(t,e),v.setState("select",!1)):(x.addRecords(t,e).setValue(e),v.setState("copy",!1))}else x.getValue()&&v.isVisible()?(x.addRecords(X.getItems(),e).deleteCollection(x.getValue()),v.setState("records",!1)):(this.addToNewCollection(e),s.emit("recordsMoved",{count:1,sender:"toast",new:1}))}).on("collectionsSynced",function(){v.setState("sync",!1),$.renderData(W.prepareData(W.getItems())),P.emit(y.COLLECTION_EVENTS.SYNCED,x)}).on("collectionsSet",function(){P.emit(y.COLLECTION_EVENTS.COLLECTIONS_SET,x)}).on("noCollectionForActiveId",function(){s.emit("noCollectionForActiveId")}).on("activeIdChanged",function(e){O.setProperty("activeId",e)}).on("recordsReceived",function(e){X.setItems(e),v.setState("records",!0);const t=x.getSelectedCollection()||W.getItems().find(e=>e.id===W.getValue());t.recordsCount=e.length,ie.renderData(Te(t))}).on("gotTopList",function(e){W.setItems(e)}).on("checked",function(e){!function(e){N.setState("favourite",e),N.setEnabled(N.hasState("favourite")||M.isValid())}(e)}).on("checkLimit",function(e){v.setState("limit",e>=M.getProperty("limit")),U.setState("disabled",e>=M.getProperty("limit"))}).on("dbReady",function(){i.setState("db_inactive",!1),me(),P.emit(y.COLLECTION_EVENTS.DB_READY,x)}).on("resetedIds",function(){s.emit("resetedIds")}).on("checkRecordError",function(e){s.emit("checkRecordError",e)}).on("upgradeneeded",function(){O.setProperty("databaseBlocked",!1)}).on("databaseError",function(e){"blocked"===e.sender&&O.setProperty("databaseBlocked",!0),s.emit("databaseError",e)}),M.on("dbIndexNotFound",function(e){s.emit("dbIndexNotFound",e)}).onChange("syncedUid",function(e){O.setProperty("syncedUid",e)}),O.hasProperty("syncedUid")&&M.setProperty("syncedUid",O.getProperty("syncedUid")),I.hasProperty("historyEnabled")&&fe(),W.prepareData=function(t){const s={blocks:[]};let i=[];const r=x.getItems();return n.default.isEmpty(t)||(r&&(i=r.filter(function(e){return l.CollectionServerModel.isNotDeleted(e)&&e.type===l.COLLECTION_TYPES.SUBSCRIPTION})),s.blocks.push({header:e.COLLECTION_TITLES.top,collections:t.map(function(e){const t=i.filter(function(t){return t.sourceCollectionId===e.id});return{color:e.color,popular:!0,collectionId:e.id,collectionName:e.name,collectionCount:e.count,collectionAuthor:e.authorName,subscribeButton:!x.isMyCollection(e),subscribed:Boolean(t.length)}})})),s},W.on("valueChanged",function(t){let s=[];if(!t)return;const i=this.getItems().find(function(e){return e.id===t});X.setItems(""),v.setState("broken",!1);const n=se.getElement(),r=J.getElement();x.isMyCollection(i)?r.setAttribute("data-subscribed",""):(s=x.getItems().filter(function(e){return e.sourceCollectionId===t&&e.type===l.COLLECTION_TYPES.SUBSCRIPTION&&l.CollectionServerModel.isNotDeleted(e)}),K.getElement().setAttribute("data-subscribed",Boolean(s.length)),n.setAttribute("data-subscribed",Boolean(s.length)),r.setAttribute("data-subscribed",Boolean(s.length))),ie.renderData(Te(i,Boolean(s.length))),r.setAttribute("data-collection-type","popular"),x.getTopCollection(t),se.setTextContent(i.name),n.setAttribute("data-color",i.color||""),n.setAttribute("data-collection-type","popular"),K.getElement().setAttribute("data-collection-type","popular"),z.setItems(e.SUBSCRIPTION_MENU_ITEMS)}),ae.on("itemSelected",function(t){const i=s.toJSON(),r=x.getRecords(),o=x.getItems();if(!t)return;const a=o.filter(function(e){return e.id===t})[0];if(t===x.getActiveId())return void oe.setVisible(!1);const l=r.find(function(e){return i.text===e.text&&i.srcLang+"-"+i.dstLang===e.lang&&i.translation===e.translation});l?x.moveRecords(l,t):x.addRecords(null,t),s.emit("recordsMoved",{count:1,sender:"toast",new:0}),x.setActiveId(t),re.renderData({message:n.default.parseString(e.COLLECTION_TOAST_MESSAGES.added,a.name)}).setVisible(!0),oe.setVisible(!1)}),K.on("stateChanged:empty",function(e){j.setState("empty",e),w.setVisible(!e)}),X.prepareData=function(e){const t={},s=X.getValue();if(!e.length)return t;const i=e.filter(function(e){return!e.filtered});return t.empty=!i.length,t.items=i.map(function(e){const t=e.lang.split("-");return{id:e.id,collectionId:e.collectionId,srcLang:t[0],dstLang:t[1],text:e.text,translation:e.translation,selected:s.indexOf(e.id)>=0,srcDir:n.default.isRTLLang(t[0])?"rtl":"ltr",dstDir:n.default.isRTLLang(t[1])?"rtl":"ltr"}}),t},X.on("itemSelected",function(){let e;const t=this.getSelectedItems()[0];!t||v.hasState("select")||v.hasState("copy")||(e=t.lang.split("-"),x.setActiveId(t.collectionId),v.setVisible(!1),I.setProperty({text:t.text,srcLang:e[0],dstLang:e[1]},{sender:"collections"}),s.emit("recordInsert"),this.setValue([]))}),ne.on("tap",function(){this.setState("active")}),H.on("tap",function(){const e=n.default.trim(k.getValue());e?H.hasState("inactive")?V.setState(v.hasState("limit")?"limit":"alert",!0):(s.emit("collectionCreated",ne.hasState("active")),x.createCollection({name:e,public:ne.hasState("active")}),v.setState("add",!1)):V.setFocus(!0)}),k.getModel().on("change",function(e,t){switch(e){case"value":const e=n.default.trim(t).toUpperCase();if(!e||v.hasState("limit"))H.setState("inactive",!0);else{const t=x.getItems().filter(function(t){return t.name.toUpperCase()===e&&l.CollectionServerModel.isNotDeleted(t)&&!l.CollectionServerModel.isSubscription(t)});H.setState("inactive",t.length)}}}),Z.on("itemSelected",function(e){if(!e)return;if(e===x.getActiveId())return void Q.setVisible(!1);const t=X.getSelectedItems();x.moveRecords(t,e).setActiveId(e),s.emit("recordsMoved",{count:t.length,sender:"list",new:0}),v.setState("select",!1),Q.setVisible(!1)}),te.on("itemSelected",function(e){if(!e)return;const t=X.getSelectedItems();v.setState("copy",!1),x.addRecords(t,e).setValue(e).setActiveId(e),ee.setVisible(!1),s.emit("recordsCopy",{count:t.length,new:0})}),j.on("tap",function(){J.isVisible()||s.emit("collectionMenuOpen"),J.setPosition(j.getRect(),!0).setVisible(),G.setVisible(!1),F.setVisible(!1),j.setFocus(!0),J.setState("empty",!X.getItems().length)}).on("stateChanged:focused",function(e){e||J.setVisible(!1)}),z.prepareData=function(e){return e?{items:Object.keys(e).map(function(t){const s=e[t];return{text:s.title,iconType:s.icon,action:s.action,confirm:s.confirm,itemType:t}})}:{}},J.on("itemSelected",function(){this.setVisible(!1)}),pe.on("tap",function(){const e=this.hasState("selected"),t=e?[]:K.getValues();X.setValue(t),this.setState("selected",!e)}),D.on("input",function(e){const t=x.filter(e);X.setItems(t)}),w.on("stateChanged:focused",function(e){e&&s.emit("collectionSearchActivate")}),ue.prepareData=function(t){const s={};return s.items=t.map(function(t){return{value:t,title:e.SOCIAL_SERVICES[t]}}),s},ue.on("share",function(e){s.emit("collectionShareData",e)}).on("write",function(e){s.emit("collectionWriteMail",e)}),he.on("stateChanged:hidden",function(t){if(!t){const t=W.getValue()||x.getShareId();if(this.setState("links",t),!t)return;const s=x.getShareLink({utmSource:e.COLLECTION_UTM_SOURCE,collection_id:t});ce.setTextContent(s),ue.setLink(s).setDescription(s),ce.on("tap",function(){n.default.selectElement(this.getElement())})}}),de.on("tap",function(){this.hasState("copy")&&n.default.copyText(ce.getElement().textContent)&&(I.setProperty("tooltip",e.TOOLTIPS.copiedLink),s.emit("collectionLinkCopied")),n.default.selectElement(ce.getElement())}).on("stateChanged:copy",function(e){const t=this.getElement();t.setAttribute("data-tooltip-nohide",e)}).setState("copy",n.default.copySupported),le.on("tap",function(){const e=x.getSelectedCollection();le.hasState("active")&&e.serverId&&!window.confirm(n.default.getAttribute(this.getElement(),"data-confirm"))||(this.setState("active"),x.updateCollection(x.getValue(),{public:!e.public}))}).on("stateChanged:active",function(e){s.emit("collectionChanged",e),he.setState("public",e)}),this.on("collectionsOpened",function(e){e&&!O.getProperty("noCollectionAlert")&&O.setProperty("noCollectionAlert",!0)}),Ee.call(I),P.emit(y.COLLECTION_EVENTS.INIT,x),this}},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(135),o=s(146);class a extends r.ListboxPresenter{constructor(e){super(e);const t=this,s=this.getModel(),i=s._database;this.syncCollections=n.default.debounce(a.prototype.syncCollections,1e3,!0),s.on("collectionsSynced",function(){t.emit("collectionsSynced")}).on("collectionsSet",function(){t.emit("collectionsSet")}).on("dbReady",function(){t.emit("dbReady")}).on("error",function(e){const s={code:e.code,message:e.message||e.body&&e.body.error||""};t.emit("error",s)}).on("checkRecordError",function(e){t.emit("checkRecordError",e)}).on("databaseError",function(e){t.emit("databaseError",e)}).on("checked",function(e){t.emit("checked",e)}).on("addToNewCollection",function(e){t.emit("addToNewCollection",e)}).on("updateTop",function(){t.emit("updateTop")}).on("updateRecords",function(e){t.emit("updateRecords",e)}).on("synced",function(){this.setProperty("syncedUid",this.getProperty("uid")),t.emit("synced")}).on("recordsReceived",function(e,s){t.emit("someRecordsReceived",e,s),e===t.getValue()&&t.emit("recordsReceived",t.getRecords())}).on("recordUpdated",function(e=null){const s=e||t.getValue()||t.getActiveId();i.getRecordsByCollection(s)}).on("collections",function(e){t.emit("gotTopList",e)}).on("collectionData",function(e){this.setRecords(e.records),t.emit("recordsReceived",e.records,{top:!0}),t.emit("collectionReceived",e)}).on("mergeCollection",function(e){this.mergeCollection(e)}).on("processCollections",function(e){this.processCollections(e)}).on("resetedIds",function(){t.emit("resetedIds")}).on("firstCollectionSync",()=>{this.getHistoryCollection()||i.createHistoryCollection()}).on("change",function(e,s){let i;switch(e){case"items":i=this.getItems().filter(function(e){return o.CollectionServerModel.isNotDeleted(e)}),t.emit("checkLimit",i.length),t.initializeActiveId();break;case"value":const e=s.split(":");s&&-1===s.indexOf(":")?t.getCollection(s):"train"===e[0]&&t.emit("openTraining",e[1]);break;case"activeId":t.emit("activeIdChanged",s).checkRecord()}})}initializeActiveId(e){let t=e;if(!this.getActiveId()){if(!e){let e=this.getItems().filter(function(e){return o.CollectionServerModel.isNotDeleted(e)});const s=e.filter(function(e){return e.type===o.COLLECTION_TYPES.FAVORITES})[0];s?t=s.id:(e=e.filter(function(e){return!o.CollectionServerModel.isSubscription(e)}),e.length?t=e[0].id:this.emit("noCollectionForActiveId"))}this.setActiveId(t).emit("activeIdInitialized")}}isMyCollection(e){return e&&e.authorUid===this.getModel().getProperty("uid")}checkRecord(e){return this.getModel().checkRecord(e),this}syncCollections(){return this.getModel().syncCollections(),this}getCollectionList(){return this.getModel().getCollectionList(),this}getTopCollectionsList(){return this.getModel()._getCollections(),this}getTopCollection(e){return this.getModel()._getCollection(e),this}getSelectedCollection(){const e=this;return this.getItems().filter(function(t){return t.id===e.getValue()})[0]}getDefaultName(e){const t=this.getItems()||[];let s=t.filter(function(t){return-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}),i=0;for(;s.length;)if(i){i++;const n=e.toLowerCase()+" "+i;s=t.filter(function(e){return e.name.toLowerCase()===n})}else s=t.filter(function(t){return t.name.toLowerCase()===e.toLowerCase()}),s.length&&i++;return e+(i?" "+i:"")}getRecords(){return this.getModel().getRecords()}setRecords(e){return this.getModel().setRecords(e),this}getActiveId(){return this.getModel().getProperty("activeId")}setActiveId(e){return this.getModel().isValid("activeId",e)&&this.getModel().setProperty("activeId",e),this}getActive(){return this.getModel().getActive()}getCollection(e){return this.getModel().getCollection(e),this}updateCollection(e,t){return this.getModel().updateCollection(e,t),this}createCollection(e={},t){const s=this.getModel();return e.name?(t&&s.setProperty("addingRecord",!0),s.createCollection(e),this):this}saveCollection(){const e=this.getItemById(this.getValue(),!1);return this.createCollection({name:e.name,color:e.color,public:!1},!0),this}deleteCollection(e){return e&&this.getModel().deleteCollection(e),this}updateRecord(e,t){return this.getModel().updateRecord(e,t),this}moveRecords(e,t){const s=this.getItemById(t,!1),i=n.default.isArray(e)?e:[e];return this.getModel().moveRecords(i,s),this}addRecords(e,t){const s=this.getProps(),i=o.CollectionServerModel.getTimestamp(),n=t||s.activeId;let r=e;if(!r&&!s.text)return this;if(!n)return this;const a=this.getItemById(n,!1);return r||(r=[{text:s.text,lang:s.srcLang+"-"+s.dstLang,translation:s.translation}]),r=r.map(function(e){return{text:e.text,lang:e.lang,translation:e.translation,score:0,status:o.COLLECTION_STATUSES.ADDED,collectionId:a.id,creationTimestamp:i,modificationTimestamp:i}}),this.getModel().addRecords(r,a),this}addToNewCollection(e){const t=this.getProps(),s=this.getRecords().find(function(e){return t.text===e.text&&t.srcLang+"-"+t.dstLang===e.lang&&t.translation===e.translation});s?this.moveRecords(s,e):this.addRecords(null,e)}deleteRecords(e){return this.getModel().deleteRecords(e),this}subscribeToCollection(e){return this.getModel().subscribe(e),this}getHistoryRecords(){const e=this.getHistoryCollectionId();return e&&this.getCollection(e),this}addHistoryRecord(e){const t=this.getHistoryCollectionId();return t&&this.addRecords([{text:e.text,translation:e.translation,lang:e.srcLang+"-"+e.dstLang}],t),this}updateHistoryRecord(e){const t=this.getHistoryCollectionId();return t&&this.getModel().updateHistoryRecord(t,e),this}deleteHistoryRecord(e){const t=this.getHistoryCollectionId();return t&&this.getModel().deleteRecordByProps(t,e),this}deleteRecordByProps(e,t){return e&&this.getModel().deleteRecordByProps(e,t),this}setText(e){return this.getModel().setProperty("text",e),this}setSrcLanguage(e){return this.getModel().setProperty("srcLang",e),this}setDstLanguage(e){return this.getModel().setProperty("dstLang",e),this}setTranslation(e){return this.getModel().setProperty("translation",e),this}filter(e){return this.getModel().filter(e,this.getValue())}resetRecordsScore(e){return this.getModel().resetRecordsScore(e),this}getShareId(){const e=this.getItemById(this.getValue(),!1);return e?e.sourceCollectionId||e.serverId:""}getShareLink(e={}){const t={},s=window.location.protocol+"//"+window.location.host+"/subscribe";return e.collection_id&&(t.collection_id=e.collection_id),e.utmSource&&(t.utm_source=e.utmSource),s+"?"+n.default.toQueryString(t)}openRecords(e){const t=this.getItems().find(function(t){return t.serverId===e||t.sourceCollectionId===e});t?(this.setValue(t.id),this.getCollection(t.id)):this.getTopCollection(e)}getItemById(e,t=!0){return this.getItems().find(function(s){return s.id===e||t&&s.serverId&&s.serverId===e})}getCollectionByType(e){return this.getItems().find(t=>t.type===e)}getHistoryCollection(){return this.getCollectionByType(o.COLLECTION_TYPES.HISTORY)}getHistoryCollectionId(){const e=this.getHistoryCollection();return e?e.id:null}getFavoritesCollectionId(){const e=this.getCollectionByType(o.COLLECTION_TYPES.FAVORITES);return e?e.id:null}}t.CollectionPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.CollectionNameInputPresenter=void 0;var i=s(140);class n extends i.InputPresenter{constructor(e){super(e),this.getView().on("stateChanged",function(e,t){switch(e){case"alert":case"limit":this.setFocus(!0);break;case"focused":t||this.setState({alert:!1,limit:!1})}})}}t.CollectionNameInputPresenter=n},function(e,t,s){"use strict";t.__esModule=!0,t.ListboxMultiplePresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(135);class o extends r.ListboxPresenter{getValue(){const e=this.getModel().getProperty("value");return e?JSON.parse(e):[]}setValue(e,t){let s,i;return n.default.isArray(e)?s=e:(s=this.getValue(),i=s.indexOf(e),i<0?s.push(e):s.splice(i,1)),this.getModel().setProperty("value",JSON.stringify(s),t),this}getSelectedItems(){const e=this.getValue();let t=this.getItems()||[];return t=t.filter(function(t){return-1!==e.indexOf(t.id)}),t}}t.ListboxMultiplePresenter=o},function(e,t,s){"use strict";function i(e,t){return e.text.toLowerCase()===t.text.toLowerCase()&&e.translation.toLowerCase()===t.translation.toLowerCase()&&e.srcLang===t.srcLang&&e.dstLang===t.dstLang}t.__esModule=!0,t.HistoryCollection=t.HISTORY_COLLECTION_METRIKAS=t.HISTORY_COLLECTION_EVENTS=void 0,t.compareRecords=i,s(1);var n,r=(n=s(0))&&n.__esModule?n:{default:n},o=s(8),a=s(4),l=s(183),c=s(3);const d={READY:"ready",UPDATED:"updated"};t.HISTORY_COLLECTION_EVENTS=d;const u={ADD_RECORD:"addRecord",UPDATE_RECORD:"updateRecord",REMOVE_RECORD:"removeRecord"};t.HISTORY_COLLECTION_METRIKAS=u;const{$track:h}=(0,c.getTrackerByNamespace)(u);class p extends a.Model{constructor(e,t){super(e,t),this.requestCollectionRecordsAsync=r.default.debounce(p.prototype.requestCollectionRecords,200),(0,l.getCollectionsEmitter)().on(l.COLLECTION_EVENTS.INIT,e=>{this.setCollectionsPresenter(e)}).on(l.COLLECTION_EVENTS.COLLECTIONS_SET,()=>{this.requestCollectionRecordsAsync()}).on(l.COLLECTION_EVENTS.SYNCED,()=>{this.requestCollectionRecordsAsync()}),this.onChange("records",()=>{this.setProperty({ready:!0,updating:!1}),this.emit(d.UPDATED)}).onChange("ready",()=>{this.emit(d.READY)})}isReady(){return this.getProperty("ready")}isUpdating(){return this.getProperty("updating")}onceReady(e){return this.once(d.READY,e)}onceUpdated(e){return this.once(d.UPDATED,e)}getRecords(){return this.getProperty("records")}getCollectionsPresenter(){return this.getProperty("collectionsPresenter")}getRecordPosition(e){return this.getRecords().findIndex(t=>i(e,t))}isRecordValid({text:e,translation:t,srcLang:s,dstLang:i}){const{maxTextLength:n}=this.getProps();return e&&t&&s&&i&&e.length<=n}processRecord(e){const{records:t,maxRecords:s}=this.getProps();if(this.prepareRecord(e),!this.isRecordValid(e))return!1;if(!this.isReady())return this.onceReady(()=>this.processRecord(e));if(this.isUpdating())return this.onceUpdated(()=>this.processRecord(e));const i=this.getRecordPosition(e);this.setProperty("updating",!0);try{if(-1===i)return t.length>=s&&this.removeRecord(t[t.length-1]),this.addRecord(e);if(i>0)return this.touchRecord(e)}catch(e){this.setProperty("updating",!1),(0,o.logError)(e)}return!1}touchRecord(e){return h(u.UPDATE_RECORD),this.getCollectionsPresenter().updateHistoryRecord(e),!0}addRecord(e){return h(u.ADD_RECORD),this.getCollectionsPresenter().addHistoryRecord(e),!0}removeRecord(e){return h(u.REMOVE_RECORD),this.getCollectionsPresenter().deleteHistoryRecord(e),!0}setRawRecords(e){const t=e.map(({text:e,translation:t,lang:s})=>{const[i,n]=s.split("-");return{text:e,translation:t,srcLang:i,dstLang:n}});this.setProperty({records:t})}requestCollectionRecords(){const e=this.getCollectionsPresenter();return!!e&&(e.getHistoryRecords(),!0)}setCollectionsPresenter(e){e.on("someRecordsReceived",(t,s)=>{const i=e.getHistoryCollectionId();t&&t===i&&this.setRawRecords(s)}),this.setProperty({collectionsPresenter:e})}prepareRecord(e){e.text=r.default.trim(e.text),e.translation=r.default.trim(e.translation)}}t.HistoryCollection=p,p.defaults={records:[],ready:!1,updating:!1,collectionsPresenter:null,maxRecords:1e3,maxTextLength:300}},function(e,t,s){"use strict";t.__esModule=!0,t.TTSNativePlayer=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(136);class o extends r.TTSPlayer{static isAvailable(){return"speechSynthesis"in window&&"SpeechSynthesisUtterance"in window}static getVoice(e){return n.default.isNumber(e)?this.getVoiceByIndex(e):n.default.isString(e)?this.getVoiceByLanguage(e):null}static getVoiceByIndex(e){return window.speechSynthesis.getVoices()[e]||null}static getVoiceByLanguage(e){const t=this.langRegions[e];let s=[],i=window.speechSynthesis.getVoices();return i=i.filter(function(t){return 0===t.lang.indexOf(e)}),t&&(s=i.filter(function(e){const s=e.lang.replace(/_/g,"-").split("-")[1];return s&&s.toUpperCase()===t})),s[0]||i[0]||null}constructor(e={}){super();const t=this;this.on("action",function(e){t.emit("actionStarted",{action:e,playerType:o.TYPE})}),"addEventListener"in window.speechSynthesis&&window.speechSynthesis.addEventListener("voiceschanged",function(){t.emit("playerUpdated")},!1),this._rate=n.default.isNumber(e.rate)?e.rate:1,this._pitch=n.default.isNumber(e.pitch)?e.pitch:1,this._volume=n.default.isNumber(e.volume)?e.volume:1,this._maxTextLength=e.maxTextLength,this._utterances=[]}play(e,t,s,i){this.isValid(e,t,o=>{o?(this._active=!0,this.emit("action",r.PLAYER_ACTIONS.LOAD),n.default.iOS?setTimeout(()=>this._startSynthesis(t,e,s,i),100):this._startSynthesis(t,e,s,i)):i(!1)})}stop(){this.isActive()&&(window.speechSynthesis.cancel(),this._active=!1)}isActive(){return this._active}createUtterance(e,t,s){const i=new SpeechSynthesisUtterance;return i.rate=s?this._rate/2:this._rate,i.pitch=this._pitch,i.volume=this._volume,i.text=e,i.lang=t?t.lang:"",i.voice=t,i.addEventListener("end",this._onStop.bind(this)),i.addEventListener("error",this._onError.bind(this)),i.addEventListener("start",this._onStart.bind(this)),i}_startSynthesis(e,t,s,i){const n=o.getVoice(e),r=this.createUtterance(t,n,s);this._utterances.splice(0,1,r);try{window.speechSynthesis.speak(r),i(!0)}catch(e){this._onError(),i(!1)}}_onStop(){this._active=!1,this.emit("action",r.PLAYER_ACTIONS.STOP)}_onError(){this._active=!1,this.emit("action",r.PLAYER_ACTIONS.ERROR)}_onStart(){this._active=!0,this.emit("action",r.PLAYER_ACTIONS.PLAY)}isLangSupported(e,t){t(o.getVoice(e))}isTextSupported(e){return n.default.hasAlphaOrDigit(e)&&!n.default.isUrl(e)}isTextSizeBelowLimit(e){return e&&e.length<=this._maxTextLength}getPriority(){return r.PLAYER_PRIORITIES.NORMAL}}t.TTSNativePlayer=o,o.TYPE="native",o.langRegions={de:"DE",en:"GB",es:"ES",fr:"FR",it:"IT",nl:"NL",pt:"PT",ru:"RU",zh:"CN"}},function(e,t,s){"use strict";t.__esModule=!0,t.VOICES_MAP=t.TTSOnlinePlayer=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(136);const o={ru:"oksana.gpu"};document.getElementById("ttsModel").addEventListener("change",function(){var e=this.options[this.selectedIndex],t=e.value,s=e.getAttribute("lang"),i="true"===e.getAttribute("gpu");Object.keys(o).forEach(function(e){delete o[e]}),o[s]=t,i&&(o[s]+=".gpu")}),t.VOICES_MAP=o;class a extends r.TTSPlayer{static isAvailable(e){return e&&this.codecs[e.toUpperCase()]}constructor(e={}){super();const t=new window.Audio;this._audio=t,this._currentSrc="",this._url=e.speakerUrl,this._langs=e.speakerLangs,this._maxTextLength=e.maxTextLength,this._cacheEnabled=Boolean(e.cacheEnabled),this._params=e.params,this.on("action",e=>{this.emit("actionStarted",{action:e,playerType:a.TYPE})}),t.mozPreservesPitch=!0,t.webkitPreservesPitch=!0,t.preservesPitch=!0,t.addEventListener("error",()=>{this._clearLoadingTimeout(),this.emit("action",r.PLAYER_ACTIONS.ERROR)},!1),t.addEventListener("ended",()=>{this.emit("action",r.PLAYER_ACTIONS.STOP)},!1),t.addEventListener("pause",()=>{this.emit("action",r.PLAYER_ACTIONS.STOP)},!1),t.addEventListener("playing",()=>{this._clearLoadingTimeout(),this.emit("action",r.PLAYER_ACTIONS.PLAY)},!1)}getSrc(e,t){const s={...this._params,lang:this._langs[t],text:e};return t in o&&(s.voice=o[t]),this._url+"?"+n.default.toQueryString(s)}play(e,t,s,i){const n=this,o=this._audio;this.isValid(e,t,function(a){a||i(!1);const l=n.getSrc(e,t);n.emit("action",r.PLAYER_ACTIONS.LOAD),n._currentSrc===l&&n._cacheEnabled&&o.readyState?o.currentTime=0:(o.src=l,n._currentSrc=l),o.playbackRate=s?.5:1,o.play(),n._ttsLoadingTimeout=setTimeout(function(){n.emit("action",r.PLAYER_ACTIONS.ERROR)},2e3),i(!0)})}stop(){this.isActive()&&(this._clearLoadingTimeout(),this._audio.pause())}isActive(){return!this._audio.paused}isLangSupported(e,t){t(this._langs[e])}isTextSupported(e){return n.default.hasAlphaOrDigit(e)&&!n.default.isUrl(e)}isTextSizeBelowLimit(e){return e&&e.length<=this._maxTextLength}getPriority(){return n.default.isOnline()?r.PLAYER_PRIORITIES.NORMAL:r.PLAYER_PRIORITIES.LOW}_clearLoadingTimeout(){clearTimeout(this._ttsLoadingTimeout),this._ttsLoadingTimeout=0}}t.TTSOnlinePlayer=a,a.TYPE="yandex",a.backendSupportedFormats=[{format:"mp3",quality:"hi"},{format:"ogg",quality:"hi"},{format:"webm",quality:"hi"},{format:"wav",quality:"lo"}],a.codecs=function(){const e=/^no$/,t=document.createElement("audio");return t.canPlayType?{AAC:t.canPlayType("audio/aac").replace(e,""),MP3:t.canPlayType("audio/mpeg").replace(e,""),WAV:t.canPlayType('audio/wav; codecs="1"').replace(e,""),OGG:t.canPlayType('audio/ogg; codecs="vorbis"').replace(e,""),WEBM:t.canPlayType('audio/webm; codecs="opus"').replace(e,"")}:{}}()},function(e,t,s){"use strict";function i(e){return h.OggOpusStream.isOggOpus(e.format)?new h.OggOpusStream(e):p.PcmStream.isPCM(e.format)?new p.PcmStream(e):void 0}function n(e,t){localStorage.setItem(e,t)}function r(e,t){return localStorage.getItem(e)||t}function o(){const e=document.getElementById("ttsModel"),t=e.options[e.selectedIndex],s=t.value;f=t.getAttribute("lang");const i="true"===t.getAttribute("gpu");m[f]=s,i&&(m[f]+=".gpu")}t.__esModule=!0,t.StreamPlayer=t.AUDIO_FORMATS=void 0,t.UNIPROXY_VOICES=t.TTS_AUDIO_FORMAT=t.TTSUniproxyPlayer=t.PLAYER_TYPE=t.PLAYER_ERRORS=void 0,t.AUDIO_FORMATS={WEBM:"audio/webm;codecs=opus",OGG:"audio/ogg;codecs=opus",WAV:"audio/x-wav;bit=16",WAV_PCM:"audio/x-pcm;bit=16",RAW:"audio/x-raw"};var a,l=(a=s(0))&&a.__esModule?a:{default:a},c=s(10),d=s(136),u=s(178),h=s(242),p=s(244),g=s(160);const E="Generate",_="Speak",T=[u.AUDIO_FORMATS.MP3,u.AUDIO_FORMATS.OGG,u.AUDIO_FORMATS.WEBM,u.AUDIO_FORMATS.WAV_PCM,u.AUDIO_FORMATS.WAV].filter(e=>(new Audio).canPlayType(e))[0];t.TTS_AUDIO_FORMAT=T,t.PLAYER_TYPE="Uniproxy";const m={ru:"tatyana_shitova.gpu"};let f=r("ttsModelLang","ru-RU"),S=parseFloat(r("ttsSpeed",1)),C=r("ttsEmotion","neutral");window.onload=function(){const e=document.getElementById("ttsModel"),t=r("ttsModel","tatyana_shitova");e.value=t,o();const s=document.getElementById("ttsSpeed");s.value=S;const i=document.getElementById("ttsEmotion");i.value=C},document.getElementById("ttsModel").addEventListener("change",function(){n("ttsModel",this.value),n("ttsModelLang",this.options[this.selectedIndex].getAttribute("lang")),o()}),
document.getElementById("ttsSpeed").addEventListener("change",function(){var e=this.value;S=parseFloat(e),n("ttsSpeed",S)}),document.getElementById("ttsEmotion").addEventListener("change",function(){var e=this.value;C=e,n("ttsEmotion",C)}),t.UNIPROXY_VOICES=m;const A={STREAM_ID_EMPTY:"stream_id_empty",SERVER_ERROR:"server_error",PLAYER_ERROR:"player_error"};t.PLAYER_ERRORS=A;const L=["ru","tr","uk","en","de"];class y extends d.TTSPlayer{static isAvailable(){const e=!l.default.iOS&&l.default.safariVersion;return Boolean(T)&&!e&&(!l.default.chromeVersion||l.default.chromeVersion>60)&&(window.AudioContext||window.webkitAudioContext)}constructor(e={}){super(),this.stream=null,this.activeSource=null,this.activeBufferIndex=0,this.stopped=!0,this.format="",this.streamFactory=e,this.audioContext=null,this._player=new u.StreamPlayer(i),this._currentMessageId="",this._currentStreamId=-1,this._uniproxy=e.uniproxy,this._maxTextLength=e.maxTextLength,this._uniproxy.on("*",(e,t)=>{switch(e){case g.EVENTS.ERROR:this._handleUniproxyError(t.data,t.error);break;case g.EVENTS.MESSAGE:this._handleMessage(t.data);break;case g.EVENTS.STREAM:this._handleStream(t);break;case g.EVENTS.STREAM_CONTROL:this._handleStreamControl(t.data)}}),this.on("action",e=>{this.emit("actionStarted",{action:e,playerType:"Uniproxy"})})}isValid(e,t,s){d.TTSPlayer.prototype.isValid.call(this,e,t,e=>{if(!e)return s(e);this._uniproxy.ensureConnection(()=>{s(!0)})})}_freeAudioContext(){this._audioContext&&this._audioContext.close&&this._audioContext.state&&("closed"!==this._audioContext.state&&this._audioContext.close(),this._audioContext=null)}play(e,t,s,i){this._freeAudioContext(),this._audioContext=this._audioContext||new(window.AudioContext||window.webkitAudioContext),this._audioContext.createScriptProcessor(256,1,1).disconnect(),this.isValid(e,t,t=>{t||i(!1);const s=e,n=m[f],r=T===u.AUDIO_FORMATS.OGG?u.AUDIO_FORMATS.WEBM:T;this.emit("action",d.PLAYER_ACTIONS.LOAD),this._player.setAudioContext(this._audioContext),this._currentMessageId=this._uniproxy.sendRequest("tts",E,{text:s,lang:f,voice:n,speed:S,emotion:C,format:r}),i(!0)})}stop(e){this.isActive()&&(this._freeAudioContext(),-1!==this._currentStreamId&&this._uniproxy.closeStream(this._currentStreamId,this._currentMessageId),this._currentStreamId=-1,this._currentMessageId="",this._player.stop())}isActive(){return!this._player.stopped}isLangSupported(e,t){t(m[e])}isTextSupported(e){return l.default.hasAlphaOrDigit(e)&&!l.default.isUrl(e)}isTextSizeBelowLimit(e){return e&&e.length<=this._maxTextLength}getPriority(e,t){return!l.default.isOnline()||l.default.iOS>=14?d.PLAYER_PRIORITIES.LOW:L.includes(t)||l.default.isLinux?d.PLAYER_PRIORITIES.HIGH:d.PLAYER_PRIORITIES.NORMAL}_handleStream(e){this._currentStreamId===e.streamId&&this._player.onPackage(e.data)}_handleStreamControl({action:e,streamId:t}){e===g.STREAM_CONTROL_ACTIONS.CLOSE&&t===this._currentStreamId&&(this._player.onStreamFinished(),this._currentStreamId=-1,this._currentMessageId="")}_handleUniproxyError({header:e,payload:t},s=null){if(e&&e.refMessageId===this._currentMessageId){const e=t&&t.error&&t.error.message;this._handleError(s||A.SERVER_ERROR,e)}}_handleError(e,t=null){this.stop(),this.emit("action",d.PLAYER_ACTIONS.ERROR),(0,c.getGlobalEmitter)().emit("uniproxyTtsError",e,t,{format:T,lang:this._lang})}_handleStart(){this.emit("action",d.PLAYER_ACTIONS.PLAY)}_handleFinished(){this.emit("action",d.PLAYER_ACTIONS.STOP)}_handleSpeak({header:e,payload:t}){void 0!==e.streamId?e.refMessageId===this._currentMessageId&&(this._currentStreamId=e.streamId,this._player.start({onStart:this._handleStart.bind(this),onError:this._handleError.bind(this),onFinished:this._handleFinished.bind(this),format:t.format})):this._handleError(A.STREAM_ID_EMPTY)}_handleMessage(e){const{header:t}=e;if(t&&"TTS"===t.namespace)switch(t.name){case _:this._handleSpeak(e)}}_clearLoadingTimeout(){clearTimeout(this._ttsLoadingTimeout),this._ttsLoadingTimeout=0}}t.TTSUniproxyPlayer=y,y.TYPE="Uniproxy"},function(e,t,s){"use strict";function i(e,t){const s=new Uint8Array(e.byteLength+t.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(t),e.byteLength),s.buffer}function n(e){const t=[];let s=0;const i=new DataView(e);for(;s<e.byteLength;){const n=s;if(1332176723!==i.getUint32(s))break;const o=i.getUint8(s+26);let a=s+26+1;const l=a+o;s+=26+o+1;const c=[];for(;a<l;a++){const t=i.getUint8(a);c.push(r(e,s,t)),s+=t}t.push({offset:n,size:s-n,segments:c})}return t}function r(e,t,s){const i=e.slice(t,t+s),n=new DataView(i);let r="data";return i.byteLength>=4&&1332770163===n.getUint32(0)&&(1214603620===n.getUint32(4)?r="head":1415669619===n.getUint32(4)&&(r="tag")),{offset:t,type:r,size:s}}t.__esModule=!0,t.OggOpusStream=void 0,t.parseStreamPackage=n,s(1);var o=s(187);class a extends o.AbstractStream{static isOggOpus(e=""){return"audio/opus"===e}constructor(e){super(e),this.currentHeader=null,this.preloadBufferSize=2e4,this.bufferSize=4e4}add(e){const t=n(e);let s=-1,r=-1;for(const n of t){const{segments:t,size:o,offset:a}=n;t.length&&("head"===t[0].type?(-1!==s&&this.currentHeader?(this.insert(e.slice(s,r),this.currentHeader),s=-1,r=-1):this.pendingBuffer&&this.pendingBuffer.offset&&this.ready(),this.currentHeader=e.slice(a,o+a)):"tag"===t[0].type?this.currentHeader&&(this.currentHeader=i(this.currentHeader,e.slice(a,o+a))):-1===s?(s=a,r=a+o):r+=o)}-1!==s&&this.currentHeader&&this.insert(e.slice(s,r),this.currentHeader)}getChunk(e){return e}}t.OggOpusStream=a},function(e,t,s){"use strict";t.__esModule=!0,t.PackageBuffer=void 0,t.PackageBuffer=class{constructor(e){this.offset=0,this.buffer=new ArrayBuffer(e)}add(e,t){const s=t?t.byteLength:0,i=0===this.offset;if(e.byteLength+(i?s:0)+this.offset>this.buffer.byteLength)return!1;const n=new Uint8Array(this.buffer);return 0===this.offset&&t&&(n.set(new Uint8Array(t),this.offset),this.offset+=t.byteLength),n.set(new Uint8Array(e),this.offset),this.offset+=e.byteLength,!0}relax(){return this.buffer=this.buffer.slice(0,this.offset)}}},function(e,t,s){"use strict";t.__esModule=!0,t.PcmStream=void 0,s(1);var i=s(187);const n=/audio\/x-pcm;bit=(\d*);rate=(\d*)/;class r extends i.AbstractStream{static isPCM(e=""){return n.test(e)}constructor(e){super(e),this.preloadBufferSize=2e4,this.bufferSize=4e4,this.bit=15,this.rate=16e3,this.channelCount=1;const[,t="",s=""]=(e.format||"").match(n)||[],i=parseInt(t,10),r=parseInt(s,10);this.bit=isNaN(i)?void 0:i,this.rate=isNaN(r)?void 0:r}add(e){this.insert(e)}getChunk(e){return function(e,t=1,s=15,i=16e3){const n=e.byteLength,r=new Uint8Array(44+n),o=new DataView(r.buffer);let a=0;return r.set(new Uint8Array(e),44),o.setInt32(a,1380533830),a+=4,o.setInt32(a,n+36,!0),a+=4,o.setInt32(a,1463899717),a+=4,o.setInt32(a,1718449184),a+=4,o.setInt32(a,16,!0),a+=4,o.setInt16(a,1,!0),a+=2,o.setInt16(a,t,!0),a+=2,o.setInt32(a,i,!0),a+=4,o.setInt32(a,i*t*s/8,!0),a+=4,o.setInt16(a,t*s/8,!0),a+=2,o.setInt16(a,s,!0),a+=2,o.setInt32(a,1684108385),a+=4,o.setInt32(a,n,!0),o.buffer}(e,this.channelCount,this.bit,this.rate)}}t.PcmStream=r},function(e,t,s){"use strict";t.__esModule=!0,t.initCopying=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(2),a=s(46);const l={id:"copyDstButton"},c="text_copy",d="text_select",u="text_copy_src",h="text_select_src",p="text_download",g="text_download_src";t.initCopying=function(e){const t=this,s=this.getModel();let i="",E="";const _=new o.TouchView({element:e.ELEMENTS.copyDstButton}),T=new o.TouchView({element:e.ELEMENTS.copySrcButton});return s.on("change",function(e,t){switch(e){case"dstLang":_.setState("download",n.default.isElvishLanguage(t)&&_.hasState("copy"));break;case"srcLang":T.setState("download",n.default.isElvishLanguage(t)&&T.hasState("copy"));break;case"text":E=t,T.setEnabled(t);break;case"translation":case"userTranslation":i=t,_.setEnabled(t)}}),[_,T].forEach(o=>{o.on("tap",function(){const a=t.getProps();let _;const T=o.getId()===l.id;let m=E,f={src_length:a.text.length,dst_length:a.translation.length};if(T&&(m=i),this.hasState("download"))return T?r.$tracker.sendMetric(p,f):r.$tracker.sendMetric(g,f),t;if(this.hasState("copy")&&n.default.copyText(m)){const t=T?e.TOOLTIPS.translationCopied:e.TOOLTIPS.textCopied;_=!0,s.setProperty("tooltip",t,{view:o})}return T?_?r.$tracker.sendMetric(c,f):r.$tracker.sendMetric(d,f):_?r.$tracker.sendMetric(u,f):r.$tracker.sendMetric(h,f),t}).on("stateChanged",function(t,s){const i=this.getElement();switch(t){case"copy":i.setAttribute("data-tooltip-nohide",s);break;case"download":i.setAttribute("data-tooltip",s?e.TOOLTIPS.download:e.TOOLTIPS.copy)}}).setState("copy",n.default.copySupported)}),this.addHotKey(a.HOT_KEYS_MAP.COPY,{view:_,getActionName:()=>"copy_translation"}).bindFocusActivation(_),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initAlignment=void 0;var i=s(24);t.initAlignment=function(e){const t=this,s=this.getModel(),n=this.getView(),r=new i.TemplateView({element:e.ELEMENTS.alignment,template:e.TEMPLATES.alignment});return this.on("trAlign",function(e,i={}){if(n.hasState("editing")&&"editor"!==i.sender)return;if(!e)return r.setVisible(!1);const o=s.getProperty("text"),a=function(e){const i=s.getProperty("spellerData");return i?(JSON.parse(i).forEach(function(s){if(!s.s.length||t.hasSpellerSavedWord(s.word))return;const i=s.s[0].length,n=s.len-i;e.forEach(function(t,r){r%2==0&&(s.pos+s.len<=t?(e[r]+=n,e[r+1]+=n):s.pos<=e[r+1]&&(i!==e[r+1]-t?(e[r]=s.pos,e[r+1]=s.pos+s.len):e[r+1]+=n))})}),e):e}(e);let l=a.map(function(e,t){if(t%2==0)return{text:o.slice(e,a[t+1]),gap:o.slice(a[t+1],a[t+2])}});l=l.filter(function(e){return e}),r.renderData({items:l,leftText:o.slice(0,a[0]),rightText:o.slice(a[a.length-1])}).setVisible(!0).scrollTo(r.getScrollInfo().maxTop/100*s.getProperty("textScrollY"))}),s.on("change",function(e){switch(e){case"text":case"textScrollY":case"translation":r.setVisible(!1)}}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initAlternatives=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(11),o=s(32),a=s(248),l=s(249),c=s(148),d=s(15);t.initAlternatives=function(e){const t=this.getView(),s=this.getModel(),i=new o.ListboxView({element:e.ELEMENTS.alternativesListbox,template:e.TEMPLATES.listbox,partials:{extras:(0,d.getIcnHtml)("enter",16)},stopDefaultAction:!0}),u=new a.TranslationAlternativesPresenter({view:i,model:new l.TranslationAlternativesModel({srv:e.SRV,url:e.ALTERNATIVES_URL},{validators:{word(e){return e&&1===n.default.getValueTokens(e).length&&!n.default.isElvishLanguage(this.getProperty("dstLang"))&&!n.default.isUrl(n.default.trim(e))},translation:t=>t.length<e.MAX_PREDICTOR_QUERY,text:t=>t.length<e.MAX_PREDICTOR_QUERY,srcLang(t){const s=this.getProperty("dstLang");return t&&t!==s&&n.default.hasProperty(e.ALTERNATIVES_LANGS,t+"-"+s)},dstLang(t){const s=this.getProperty("srcLang");return t&&s!==t&&n.default.hasProperty(e.ALTERNATIVES_LANGS,s+"-"+t)}}})}),h=new o.ListboxView({element:e.ELEMENTS.alternativesTooltip,template:e.TEMPLATES.predictor});let p;return this.on("trTextInput",()=>{i.setState("waiting",!1)}).on("trTextMouseDown",()=>{i.setVisible(!1).setState("waiting",!1)}).on("trTextClick",(e,t,r)=>{if(e===t.length||s.getProperty("complaint"))return i.setVisible(!1);const o=s.getProperty("activeSentenceAlign"),a=t.lastIndexOf(" ",e)<0?0:t.lastIndexOf(" ",e-1)+1;let l=r.target.textContent,c=s.getProperty("text");u.setWord(""),i.setVisible(!1).setState("waiting",!0),n.default.hasAlphaOrDigit(l[l.length-1])||(l=l.slice(0,-1));let d=t.slice(0,a);o&&o[1]&&(d=d.slice(o[1][0])),o&&o[0]&&(c=c.slice(o[0][0],o[0][0]+o[0][1])),u.setText(c).setTranslation(n.default.trim(d)).setWord(l)}).on("trTextFocus",e=>{e||i.setVisible(!1)}).on("trTextKeydown",e=>{if(!i.isVisible())return;let t=s.getProperty("chosenAlternative");switch(e.keyCode){case r.KEYBOARD_KEYS.UP:const s=i.getElement().lastElementChild;if(n.default.preventEvent(e),t)for(;t&&(t=t.previousElementSibling||s,!n.default.getDataAttr(t,"value")););else t=s;i.emit("itemHovered",t);break;case r.KEYBOARD_KEYS.DOWN:const o=i.getElement().firstElementChild;if(n.default.preventEvent(e),t)for(;t&&(t=t.nextElementSibling||o,!n.default.getDataAttr(t,"value")););else t=o;i.emit("itemHovered",t);break;case r.KEYBOARD_KEYS.ENTER:i.emit("itemSelected",n.default.getDataAttr(t,"value"));break;default:return i.setVisible(!1)}}).on("showTooltip",e=>{i.isVisible()&&h.renderData({value:e,values:[{value:e}]}).setEnabled(!0).setVisible(!0)}).on("hideAlternatives",()=>i.setVisible(!1)),s.on("change",(e,t)=>{switch(e){case"srcLang":u.setSrcLanguage(t);break;case"dstLang":u.setDstLanguage(t);break;case"translation":s.setProperty("userTranslation","",{silent:!0})}}),window.addEventListener("scroll",function(){i.isVisible()&&i.setVisible(!1)}),u.prepareData=(e=>{const s={},i=u.getWord();return t.hasState("select")||e&&(e.filter(e=>e.toUpperCase()!==i.toUpperCase()),s.items=e.map(function(e){return{text:e,value:e}})),s}),u.on("ready",()=>{if(t.hasState("editing")&&i.hasState("waiting")){const e=window.getSelection();if(e&&e.focusNode&&!e.toString()){let t=e.focusNode.parentNode;t=n.default.trim(t.textContent)?t:t.nextSibling,t&&i.setPosition(t.getBoundingClientRect(),!0,!0)}i.setVisible(!0).setEnabled(!0)}}).on("itemSelected",e=>{this.emit(c.IDIOMS_EVENTS.CLEAR_IDIOMS),clearTimeout(p),this.emit("alternativeChosen",e,u.getTranslation())}),i.on("stateChanged:hidden",e=>{e&&h.setVisible(!1)}).on("itemHovered",e=>{clearTimeout(p),h.setVisible(!1),n.default.toggleClass(e,"state-selected"),s.getProperty("chosenAlternative")&&n.default.toggleClass(s.getProperty("chosenAlternative"),"state-selected"),s.setProperty("chosenAlternative",e),p=setTimeout(()=>{const t=n.default.getDataAttr(e,"value");h.setPosition(e.getBoundingClientRect(),!1,!0),i.isVisible()&&h.renderData({spinner:!0}).setEnabled(!0).setVisible(!0),this.emit("requestAlternative",t,u.getTranslation())},200)}).on("alternativesMouseOut",()=>h.setVisible(!1)),this}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationAlternativesPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2),o=s(20),a=s(150);class l extends o.Presenter{constructor(e){super(e);const t=this.getView(),s=this.getModel(),i=()=>{t.setVisible(!1).setEnabled(!1)};this.requestSuggestion=n.default.debounce(a.PredictorPresenter.prototype.requestSuggestion,200),s.on("error",i).on("invalid",()=>s.setProperty("data","",{invalid:!0})).on("set:items",e=>{if(!e)return i();const n=s.toJSON();n.items=s.getItems()||[],t.renderData(this.prepareData(n.items)),this.emit("ready",n)}).on("change",(e,i,n)=>{switch(e){case"srcLang":case"dstLang":case"word":return t.setEnabled(!1),n.reason&&s.setProperty("reason",n.reason),this.requestSuggestion()}}),t.on("tap",n.default.preventEvent).on("itemSelected",e=>{e&&this.setValue(e).emit("itemSelected",this.getValue()),t.setVisible(!1)}).on(r.TouchView.eventTypes.OUT,e=>{n.default.preventEvent(e),t.emit("alternativesMouseOut")}).bindDOMEvents([r.TouchView.eventTypes.OVER,r.TouchView.eventTypes.OUT])}setText(e,t){return this.getModel().setProperty("text",e,{reason:t}),this}setTranslation(e,t){return this.getModel().setProperty("translation",e,t),this}getTranslation(){return this.getModel().getProperty("translation")}setWord(e,t){return this.getModel().setProperty("word",e,t),this}getWord(){return this.getModel().getProperty("word")}setValue(e,t){return this.getModel().setProperty("value",e,t),this}getValue(){return this.getModel().getProperty("value")}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}requestSuggestion(){return this.getModel().requestSuggestion(),this}}t.TranslationAlternativesPresenter=l},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationAlternativesModel=void 0;var i=s(45),n=s(72),r=s(65),o=s(17);class a extends n.ListboxModel{constructor(e,t){super(e,t),this.on("invalid",this.abort)}abort(){r.SyncModel.prototype.abort.call(this)}setRequest(e){r.SyncModel.prototype.setRequest.call(this,e)}getData(){const e=this.getProps();return{word:e.word,src:e.text,dst:e.translation}}getParams(){const e=this.getProps();return{id:[e.sid,e.counter,0].join("-"),srv:e.srv,lang:e.srcLang+"-"+e.dstLang}}getDefaults(){return{srv:"",url:"/",word:"",src:"",dst:"",srcLang:"",dstLang:"",index:0,sid:this.getId()}}runRequest(){const e=new o.HTTPRequest(this.getProperty("url"));if(this.abort(),!this.isValid())return this;const t=this.getData(),s=this.getParams();return this.emit("query",s),this._isCachedArrayValid(t.word,t.dst)?(this.handleResponse(this._cachedResponseArray),this):this.setRequest(e.setType(o.HTTPRequest.types.FORM).setData(t).setParams(s).setMethod(o.HTTPRequest.methods.POST).send((e,s)=>{if(e)return this.emit("error",e);this._cachedDst=t.dst,this._cachedWord=t.word,this._cachedResponseArray=s.body.alternatives,this.handleResponse(this._cachedResponseArray)}))}requestSuggestion(){return i.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runRequest()}),this}handleResponse(e){e&&0!==e.length&&this.setItems(e)}_isCachedArrayValid(e,t){return this._cachedWord&&this._cachedResponseArray&&this._cachedDst===t&&this._cachedWord===e}}t.TranslationAlternativesModel=a},function(e,t,s){"use strict";t.__esModule=!0,t.initSourceTranslit=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(188),a=s(189);t.initSourceTranslit=function(e){const t=this,s=this.getView(),i=this.getModel(),l=new o.TranslitModel({srv:e.SRV,url:e.TRANSLIT_URL},{validators:{lang:t=>n.default.hasProperty(e.TRANSLIT_LANGS,t),text:t=>t&&t.length<=e.MAX_TRANSLIT_TEXTLENGTH}}),c=new a.TranslitPresenter({model:l});return s.onStateChanged("translit_source",function(){t.emit("containerHeightChanged"),c.setLang(i.getProperty("srcLang")).setText(i.getProperty("text"))}).setState("translit_source",!0),i.onChange("srcLang",function(e){s.hasState("translit_source")&&c.setLang(e).setText("")}).onSet("translation",function(){s.hasState("translit_source")?c.setLang(this.getProperty("srcLang")).setText(this.getProperty("text")):c.setText("")}),c.on("error",function(){t.emit("translitError","source")}).on("result",e=>{i.setProperty("sourceTranslit",e),e&&r.$tracker.sendMetric("translit_show",{type:"src",lang:c.getLang(),text:c.getText(),translit:e})}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslitApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Translit Api Error"}}t.TranslitApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.initTargetTranslit=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(188),a=s(189);t.initTargetTranslit=function(e){const t=this,s=this.getView(),i=this.getModel(),l=new o.TranslitModel({srv:e.SRV,url:e.TRANSLIT_URL},{validators:{lang:t=>n.default.hasProperty(e.TRANSLIT_LANGS,t),text:t=>t&&t.length<=e.MAX_TRANSLIT_TEXTLENGTH}}),c=new a.TranslitPresenter({model:l});return s.onStateChanged("translit_target",function(){t.emit("containerHeightChanged"),c.setLang(i.getProperty("dstLang")).setText(i.getProperty("translation"))}).setState("translit_target",!0),i.onChange("dstLang",function(e){s.hasState("translit_target")&&c.setLang(e).setText("")}).onSet("translation",function(e){s.hasState("translit_target")?c.setLang(this.getProperty("dstLang")).setText(e):c.setText("")}),c.on("error",function(){t.emit("translitError","target")}).on("result",e=>{i.setProperty("targetTranslit",e),e&&r.$tracker.sendMetric("translit_show",{type:"dst",lang:c.getLang(),text:c.getText(),translit:e})}),this}},function(e,t,s){"use strict";function i(e){const t=e.indexOf("â€")<0?e.replace(/\ufe0f/g,""):e;return r.default.getEmojiCodes(t).join("-")}t.__esModule=!0,t.initTranslator=void 0,s(1);var n,r=(n=s(0))&&n.__esModule?n:{default:n},o=s(32),a=s(254),l=s(255),c=s(256),d=s(11),u=s(2),h=s(148),p=s(46),g=s(141),E=s(3);t.initTranslator=function(e){const t=this;let s,n,_=0;const T=this.getView(),m=this.getModel();if(e.ENABLE_SEO_SSR){const e=(t,s)=>{"url"===s.sender&&(E.$tracker.sendMetric("seo_dump_used",{src:t}),m.offChange("text",e))};return m.onChange("text",e),this}const f=this._settings,S=m.toJSON(),C=new o.ListboxView({element:e.ELEMENTS.selectTooltip,template:e.TEMPLATES.empty}),A=this.getTranslatorView(),L=this.getTranslatorModel(),y=new a.TranslatorPresenter({view:A,model:L}),R=this.getMeasurerViewDst(),O=new o.ListboxView({element:e.ELEMENTS.predictorDst,template:e.TEMPLATES.predictor}),I=new c.TranslationPredictorModel({srv:e.SRV,url:e.TRANSLATE_PREDICTOR_URL,options:c.TranslationPredictorModel.options.ALIGN},{validators:{text(t){return t&&t.length<=e.MAX_PREDICTOR_QUERY&&!r.default.isElvishLanguage(this.getProperty("srcLang"))&&!r.default.isUrl(r.default.trim(t))},prefix:t=>t&&t.length<=e.MAX_PREDICTOR_QUERY,srcLang(e){return e&&e!==this.getProperty("dstLang")},dstLang(e){return e&&e!==this.getProperty("srcLang")}}}),P=new l.TranslationPredictorPresenter({view:O,model:I}),N=new u.TouchView({element:e.ELEMENTS.targetTranslit}),v=new u.TouchView({element:e.ELEMENTS.translation}),b=new u.TouchView({element:e.ELEMENTS.swapButton});return v.on("mousedown",e=>{2!==e.button&&A.getContentElement().setSelectionRange(0,0)}).bindDOMEvents("mousedown"),N.onTap(e=>{e.stopImmediatePropagation()}),e.DISABLE_DST_PREDICTOR&&(O.setState({disabled:!0}),O.onStateChanged("disabled",e=>{e||O.setState({disabled:!0})})),this.on("trTextTap",function(){T.hasState("editing")&&O.setEnabled(!1)}).on("trTextClick",(e,t)=>{T.hasState("editing")&&(P.prepareActiveSentence(e,L.getProperty("sentencesAlign")),m.setProperty("userTranslation",t),I.setProperty("caret",e))}).on("trTextFocus",r.default.debounce(()=>{O.setEnabled(!1)},250)).on("textFocus",function(e){e&&T.hasState("allowed_editing")&&t.emit("action","saveEditing")}).on("trTextKeydown",function(e,s){switch(e.keyCode){case d.InputView.keys.ENTER:if(e.shiftKey)break;if(f.isOptionEnabled(g.AVAILABLE_OPTIONS.ENTER)||r.default.preventEvent(e),O.isEnabled())r.default.preventEvent(e),P.setValue(O.getValues()[0],{enter:!0});else if(e.ctrlKey&&s.sender){const e=s.sender.getSelection().start,t=s.sender.getValue().slice(0,e);P.setFullword(0).setPrefix(t,"predictor").setIndex(e)}break;default:t.emit(h.IDIOMS_EVENTS.CLEAR_IDIOMS),O.setEnabled(!1)}}).on("trTextKeyup",function(e,t){switch(e.keyCode){case d.InputView.keys.UP:case d.InputView.keys.DOWN:case d.InputView.keys.LEFT:case d.InputView.keys.RIGHT:P.prepareActiveSentence(t.caret,L.getProperty("sentencesAlign"))}}).on("trTextInput",function(e,t){let s={},i=L.getProperty("sentencesAlign");const n=I.getProperty("sentenceIndex");if("predictor"===t.sender||r.default.isEmpty(i)||r.default.isEmpty(i[n]))return;s.total=e.length-t.oldValue.length;const o=i[n][1];s.total<0&&Math.abs(s.total)>o[1]+o[0]-t.caret&&(s=l.TranslationPredictorPresenter.calculateDifference(s,n,i,t.caret));const a=l.TranslationPredictorPresenter.updateAlign("",L.getProperty("align"),s,n);L.setProperty("align",a),i=l.TranslationPredictorPresenter.getSentenceAlignFromAlign(a),L.setProperty("sentencesAlign",i)}).on("editorToggle",function(){O.setEnabled(!1)}).on("requestAlternative",(e,t)=>{const s=r.default.trim(t+" "+e);if(I.wasRequested(s))return;const i=m.getProperty("activeSentenceAlign");let n=m.getProperty("text"),o=s.length;i&&i[0]&&(n=n.slice(i[0][0],i[0][0]+i[0][1])),i&&i[1]&&(o+=i[1][0]),I.setProperty("alternative",e),P.setText(n).setFullword(1).setIndex(o).setPrefix(s,"alternatives")}).on("alternativeChosen",(e,t)=>{const i=(t?t+" ":"")+e;if(I.isCachedPrefixValid(i)){const t=m.getProperty("activeSentenceAlign");let s=i.length;t&&t[1]&&(s+=t[1][0]),P.setIndex(s),I.setProperty("pos",e.length).showCashedResult(i),P.setValue(I.getCashedResult(i))}else{I.wasRequested(i)||this.emit("requestAlternative",e,t);const n=m.getProperty("userTranslation")||m.getProperty("translation"),r=I.getProperty("caret");let o=n.slice(0,r);o=o.slice(0,o.lastIndexOf(" ")+1),o+=e,A.renderData(y.prepareData(o,{noAlign:!0})),clearTimeout(s),s=setTimeout(()=>P.emit("error"),8e3),I.setProperty("alternative",e),A.setState("waitingAlternative",!0)}}).addHotKey(p.HOT_KEYS_MAP.SWAP_LANGS,{view:b,getActionName:()=>"swap_langs"}),this.on("action:retry",()=>y.requestTranslation()),m.on("change",function(s,i,n){const{srcLang:o,dstLang:a}=m.getProps();switch(s){case"srcLang":m.setProperty("supportExamples",e.EXAMPLE_LANGS[o+"-"+a]),P.setSrcLanguage(i,{reason:"lang"}),y.setSrcLanguage(i),L.setProperty("align","");break;case"dstLang":m.setProperty("supportExamples",e.EXAMPLE_LANGS[o+"-"+a]),P.setDstLanguage(i,{reason:"lang"}),y.setDstLanguage(i),A.setLanguage(i),L.setProperty("align",""),N.setState("chinese","zh"===i);break;case"text":P.setPrefix("").setText(i);break;case"leadSpacingsCount":L.getProperty("align")&&A.renderData(y.prepareData(L.getProperty("translation"),{align:L.getProperty("align")}));break;case"textScrollY":O.setEnabled(!1),n.userScroll&&A.scrollTo(A.getScrollInfo().maxTop/100*i);break;case"trText":const s=e.TRANSLATION;L.setProperty("align",""),L.setProperty("sentencesAlign",""),y.setText(r.default.truncateText(i,e.MAX_TRANSLATOR_QUERY),n.reason,s);break;case"targetTranslit":N.setTextContent(i),t.emit("containerHeightChanged");break;case"complaint":const l=this.getProperty("selText"),c=!l||l===this.getProperty("trText");A.setState("complaint",i&&c),A.getContentElement("[data-complaint-target]").setAttribute("data-complaint-target",c);break;case"translation":T.setState("has_translation",Boolean(i))}}).on("set",function(t,s,i){let n,o,a,c,d=m.getProperty("translation"),u=m.getProperty("text"),h=0;const p=I.getProperty("sentenceIndex");switch(t){case"userTranslation":if(!T.hasState("editing"))return;if(a=L.getProperty("sentencesAlign"),a){if(a=a[p],c=l.TranslationPredictorPresenter.getSentenceAlignFromAlign(L.getProperty("oldAlign"))[p],!c)return;if(d=d.slice(c[1][0],c[1][0]+c[1][1]),s.slice(a[1][0],a[1][0]+a[1][1])===d)return;o=this.toJSON(),n=i.caret||0,a&&(h=a[1][0],u=u.slice(a[0][0],a[0][0]+a[0][1])),P.setFullword(0).setPrefix(s.slice(h,n),i.sender||i.reason).setText(u).setIndex(n).setSrcLanguage(o.srcLang).setDstLanguage(o.dstLang)}break;case"trText":"enter"===i.reason&&y.setText(r.default.truncateText(s,e.MAX_TRANSLATOR_QUERY),i.reason)}}),y.on("error",function(e){t.emit("translationError",e),t.toggleTranslatorExpandState(!0)}).on("query",function(){const{id:e}=L.getParams();t.emit("translateQuery",e),t.toggleTranslatorExpandState(!0)}).on("result",function(e){m.setProperty("translation",e),t.emit("changeEditorValue",e)}).on("expired",function(e){t.emit("refreshAlertShow",e)}),y.prepareData=function(e,t={}){const s=[],n={},o=[],a=m.getProperty("leadSpacingsCount")||0,l=L.getProperty("sentencesAlign");let c=t.align||L.getProperty("align");!t.noAlign&&c||(c=""),c.split(";").forEach(function(e,t){if(!e||e.length<2)return;let s=e.split(",")[0].split("-").map(function(e){return e.split(":").map(Number)});1===s.length&&l&&(s=l[t]),o.push(s),e.split(",").slice(1).forEach(function(e){const t=e.split("-"),s=t[0].split(":").map(Number),i=t[1];s[0]+=a,r.default.hasProperty(n,i)?n[i].push(s):n[i]=[s]})}),!t.noAlign&&c&&L.setProperty({sentencesAlign:o.length?o:"",align:c,oldAlign:c});const d=Object.keys(n).map(e=>e.split(":").map(Number));let u=0,h=0;return e.split(/\r?\n/).forEach(function(e,t,o){const a=[];(function(e){let t=0;const s=[];return r.default.getEmoji(e).forEach(function(n){t!==n.index&&s.push({value:e.slice(t,n.index)}),t=n.index+n.value.length,s.push({value:n.value,emojiCode:i(n.value)})},this),t<e.length&&r.default.getValueTokens(e.slice(t)).forEach((e,t,i)=>{s.push({value:e+(t!==i.length-1?" ":"")})}),s})(e).forEach((e,t,s)=>{let i;for(;d[h]&&u>=d[h][0];){if(u===d[h][0]){const e=d[h].join(":");n[e].forEach(function(e){i=i?[i,e[0],e[0]+e[1]].join(":"):[e[0],e[0]+e[1]].join(":")})}h++}a.push({value:r.default.trim(e.value),align:i||""}),s.length-1!==t&&a.push({value:" "}),u+=r.default.trim(e.value).length+1}),s.push({values:a,needLineBreak:null!=o[t+1]})}),{chunks:s}},L.on("change:sentencesAlign",e=>{const t=I.getProperty("sentenceIndex"),s=e&&e[t];m.setProperty("activeSentenceAlign",s)}),A.on("tap",function(e){(!e.target||e.target.className&&e.target.className.indexOf&&-1===e.target.className.indexOf("idiom"))&&C.setState("visible",!1)}).on("scroll",function(e){if(e.target!==this.getContentElement())return;const t=this.getScrollInfo();m.setProperty("translationScrollY",100/t.maxTop*t.top,{userScroll:this.userScroll}),this.userScroll||(this.userScroll=!0)}).on("keydown",function(e){const t=this.getContentElement();r.default.hasCtrlKey(e)&&e.target===t&&e.keyCode===d.InputView.keys.A&&(r.default.preventEvent(e),r.default.selectElement(t))}).on("contentChanged",function(){this.scrollTo(this.getScrollInfo().maxTop/100*m.getProperty("textScrollY"))}).on(u.TouchView.eventTypes.START,function(e){(!e.target||e.target.className&&e.target.className.indexOf&&-1===e.target.className.indexOf("idioms-info"))&&T.setState("manualselect",e.pressure&&!T.hasState("editing"))}).on(u.TouchView.eventTypes.OUT,function(){t.emit("trAlign",null),t.emit("trSelect",null),clearTimeout(n),C.setState("visible",!1)}).on(u.TouchView.eventTypes.OVER,function(e){const s=this.getClosest(e.target,function(e){return e.hasAttribute("data-align")},!0);T.setState("manualselect",e.pressure&&!T.hasState("editing"));const i=s&&s.getAttribute("data-align");i&&!this.hasState("complaint")&&(t.emit("trAlign",i.split(":").map(Number)),!t._showedExamples&&_<2&&m.getProperty("supportExamples")&&!T.hasState("editing")&&(C.setPosition(e.target.getBoundingClientRect(),!0,!0),n=setTimeout(function(){t.emit("selectTooltipShown"),_++,C.setState("visible",!0)},50)))}).bindDOMEvents("scroll",!0).bindDOMEvents(["keydown",u.TouchView.eventTypes.OUT,u.TouchView.eventTypes.OVER,u.TouchView.eventTypes.START]),P.prepareData=function(e){const t=P.toJSON(),s=t.index+t.pos,i=L.getProperty("sentencesAlign"),n=i[t.sentenceIndex]&&i[t.sentenceIndex][1];let o=m.getProperty("translation"),a=o.length;return r.default.isEmpty(n)||(a=n[1]+n[0]+1),o=o.slice(s,a),{values:l.TranslationPredictorPresenter.compareTranslations(o,e[0]).map(function(e,t){return{value:e,highlighted:t%2!=0}}),value:e[0]}},P.on("sentenceAlign",(e,t)=>this.emit("trAlign",e,t)).on("activeSentenceChanged",e=>{const t=L.getProperty("sentencesAlign"),s=t&&t[e];m.setProperty("activeSentenceAlign",s)}).on("error",()=>{A.hasState("waitingAlternative")&&(A.renderData(y.prepareData(m.getProperty("userTranslation"),{align:L.getProperty("align")})),A.setState({waitingAlternative:!1,alternative_error:!0}),this.emit("hideAlternatives"),setTimeout(()=>A.setState("alternative_error",!1),4e3))}).on("alternativesEndingReady",e=>{const t=I.getProperty("alternative"),s=r.default.getValueTokens(e[0])[0];!r.default.startsWith(s,t)||s.length>t.length&&r.default.isAlphaOrDigit(s[t.length])||(A.hasState("waitingAlternative")?(A.setState("waitingAlternative",!1),P.setValue(e[0])):this.emit("showTooltip",e[0]))}).on("ready",e=>{const t=m.getProperty("userTranslation");if("input"!==e.reason&&"predictor"!==e.reason)return O.setEnabled(!1);const s=l.TranslationPredictorPresenter.createRange(t,e);if(!s)return O.setEnabled(!1);R.renderData({text:t.slice(s.start,s.end)||".",leftText:t.slice(0,s.start),rightText:t.slice(s.end)}).scrollTo(R.getScrollInfo().maxTop/100*m.getProperty("textScrollY"));const i=R.getContentElement("[data-measurer-target]");i&&O.setPosition(i.getBoundingClientRect(),!1,!0),this.emit("dstPredictorShow",e)}).on("predictDst",(e,t)=>{const s=I.getProperty("sentenceIndex"),i=m.getProperty("userTranslation")||m.getProperty("translation");e.oldAlign=L.getProperty("sentencesAlign");const n=l.TranslationPredictorPresenter.prepareValue(e,i);let r=l.TranslationPredictorPresenter.updateAlign(n.modifiedAlign,L.getProperty("align"),{total:n.alignDifference},s);n.align[s+1]&&0===n.align[s+1][1][1]&&(r=l.TranslationPredictorPresenter.updateAlign("",r,{total:1},s+1),
n.text=n.text.slice(0,n.caret)+" "+n.text.slice(n.caret),n.align=l.TranslationPredictorPresenter.getSentenceAlignFromAlign(r),n.caret++,P.prepareActiveSentence(n.caret,n.align)),L.setProperty("align",r),A.renderData(y.prepareData(n.text)),m.setProperty("translation",n.text),L.setProperty("sentencesAlign",n.align),O.setEnabled(!1),e.caret=n.caret,this.emit("dstPredictorApply",e,t.enter)}),S.trText&&y.setText(r.default.truncateText(S.trText,e.MAX_TRANSLATOR_QUERY),"auto"),e.TRANSLATION&&L.setProperty("translation",e.TRANSLATION,{align:e.ALIGN}),S.srcLang&&(y.setSrcLanguage(S.srcLang),P.setSrcLanguage(S.srcLang)),S.dstLang&&(y.setDstLanguage(S.dstLang),A.setLanguage(S.dstLang),P.setDstLanguage(S.dstLang)),this}},function(e,t,s){"use strict";t.__esModule=!0,t.TranslatorPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(10),o=s(20);class a extends o.Presenter{constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel();this.requestTranslation=n.default.debounce(a.prototype.requestTranslation),this.requestTranslationNow=this.requestTranslation.callNow,i.on("error",function(e){const i=e.body&&e.body.code;if(s.setState("fetching",!1),i===this.constructor.errorMap.INVALID_SESSION||i===this.constructor.errorMap.EXPIRED_SESSION)return t.emit("expired",i);s.setState("offline",!n.default.isOnline()).setState("error",!0).setVisible(!1),t.emit("error",e)}).on("query",function(e){s.setState("fetching",!0),t.emit("query",e)}).onChange(["text","srcLang","dstLang"],(e,t,s)=>{s.reason&&i.setProperty("reason",s.reason),"text"===e&&"paste"===s.reason?this.requestTranslationNow():this.requestTranslation()}).onInvalid("text",function(){this.reset().setProperty("translation","")}).onSet("translation",function(e,i){if(s.setState({error:!1,fetching:!1,offline:!1}),t.emit("result",e),!e)return s.setVisible(!1);s.renderData(t.prepareData(e,{align:i.align||""})).setVisible(!0),(0,r.getGlobalEmitter)().emit("translationRendered")})}setText(e,t,s){let i=e;return i&&!n.default.isArray(i)&&(i=[i]),this.getModel().setText(i,{reason:t,silent:s}),this}setFormat(e){return this.getModel().setProperty("format",e),this}setSrcLanguage(e){return this.getModel().setProperty("srcLang",e),this}setDstLanguage(e){return this.getView().setLanguage(e),this.getModel().setProperty("dstLang",e),this}requestTranslation(){return this.getModel().requestTranslation(),this}}t.TranslatorPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationPredictorPresenter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(20),o=s(150);class a extends r.Presenter{static createRange(e,t){const s={};return s.end=t.index,s.start=s.end+t.pos,s}static getSentenceIndex(e,t){let s=e.length-1;return 0===t?s=0:e&&e.forEach(function(e,i){const n=e[1][0],r=e[1][0]+e[1][1];t>=n&&t<=r&&(s=i)}),s}static getSentenceAlignFromAlign(e){if(e)return e.split(";").map(function(e){return e.split(",")[0].split("-").map(function(e){return e.split(":").map(function(e){return Number(e)})})})}static calculateDifference(e,t,s,i){let r,o,a=t+1;const l=s[t][1];let c=i-l[0],d=e.total-c+l[1];for(e[t]=c-l[1];d<0&&!n.default.isEmpty(s[a]);){const t=s[a-1][1];o=s[a][1],r=o[0]-(t[1]+t[0]),d+=r,c=Math.abs(d)>o[1]?0:o[1]+d,d+=o[1]-c,e[a]={},e[a].difference=c-o[1],e[a].gap=r,a++}return e}static compareTranslations(e,t){const s=[];let i,n=[];const r=e.split(" "),o=t.split(" ");for(let e=0;e<o.length;e++){const t=o[e];r.indexOf(t)<0?(i||(s.push(n.join(" ")+" "),n=[]),n.push(t),i=!0):(i&&(s.push(n.join(" ")+" "),n=[]),n.push(t),i=!1)}return n.length&&s.push(n.join(" ")),s}static updateAlign(e,t,s,i){const n=[];let r,o=e;return t.split(";").forEach(function(e,t){let a;if(t===i){if(r=s[t]||s.total,!o){if(e.length<2)return;o=e.split(",")[0].split("-"),o[1]=o[1].split(":"),o[1][1]=Number(o[1][1])+r,o[1][1]<0&&(o[1][1]=0),o[1]=o[1].join(":"),o=o.join("-")}n.push(o)}else t>i?(a=e.split(","),s[t]?(a=a[0].split("-"),a[1]=a[1].split(":"),a[1][0]=Number(a[1][0])+r,a[1][1]=Number(a[1][1])+s[t].difference,a[1]=a[1].join(":"),n.push(a.join("-")),r+=s[t].difference-s[t].gap):(a=a.map(function(e){const t=e.split("-");return t[1]=t[1].split(":"),t[1][0]=Number(t[1][0])+r,t[1]=t[1].join(":"),t.join("-")}),n.push(a.join(",")))):n.push(e)}),n.join(";")}static prepareValue(e,t){const s=e.pos;let i=e.value;const r=e.sentenceIndex,o=e.oldAlign||[],a=o[r],l=a&&a[1][0]+a[1][1];let c=e.index,d=e.align.split(",");const u=d[0].split("-").map(function(e){return e.split(":").map(Number)});s<0?c+=s:i=new Array(s+1).join(" ")+i;const h=a&&a[1][1],p=u[1][1]-h;return o.forEach(function(e,t){t>r?e[1][0]+=p:t===r&&(e[1][1]+=p,0!==r&&(d=d.map(function(t){let s=t.split("-");return s=s.map(function(t,s){const i=t.split(":");return i[0]=Number(i[0])+e[s][0],i.join(":")}),s.join("-")})))}),{text:t.slice(0,c)+i+t.slice(l),caret:c+i.length,start:c+n.default.getValueTokens(i)[0].length,alignDifference:p,modifiedAlign:d.join(","),align:e.oldAlign}}constructor(e){super(e);const t=this,s=this.getView(),i=this.getModel(),r=function(){s.setVisible(!1).setEnabled(!1)};this.requestSuggestion=n.default.debounce(o.PredictorPresenter.prototype.requestSuggestion,200),s.on("tap",n.default.preventEvent).on("itemSelected",function(e){e&&t.setValue(e)}),i.on("set",function(e,i,n){let o;switch(e){case"items":return i?(o=this.toJSON(),o.items=this.getItems()||[],"alternatives"===o.reason?t.emit("alternativesEndingReady",o.items):(s.renderData(t.prepareData(o.items)).setEnabled(!0).setVisible(!0),t.emit("ready",o))):r();case"value":if(!i)return;return o=this.toJSON(),o.items=this.getItems()||[],o.align=this.getProperty("align"),t.emit("predictDst",o,n);case"prefix":if(s.setEnabled(!1),n.reason&&this.setProperty("reason",n.reason),this.isValid()&&this.isCachedPrefixValid())return this.showCashedResult()}}).on("error",()=>{r(),this.emit("error")}).on("change",function(e,i,n){switch(e){case"text":case"limit":case"prefix":case"srcLang":case"dstLang":s.setEnabled(!1),n.reason&&this.setProperty("reason",n.reason),"prefix"!==e&&this.clearCash(),this.isCachedPrefixValid()?s.setEnabled(!0):t.requestSuggestion();break;case"sentenceIndex":t.emit("activeSentenceChanged",i),this.clearCash()}}).on("invalid",r)}prepareActiveSentence(e,t){const s=[];if(!t||!t.length)return;const i=a.getSentenceIndex(t,e);this.getModel().setProperty("sentenceIndex",i),s.push(t[i][0][0]),s.push(t[i][0][1]+t[i][0][0]),this.emit("sentenceAlign",s,{sender:"editor"})}setText(e,t){return this.getModel().setProperty("text",e,{reason:t}),this}setPrefix(e,t){return this.getModel().setProperty("prefix",e,{reason:t}),this}setIndex(e){return this.getModel().setProperty("index",e),this}setValue(e,t){return this.getModel().setProperty("value",e,t),this}setFullword(e,t){return this.getModel().setProperty("fullwordPrefix",e,t),this}setSrcLanguage(e,t){return this.getModel().setProperty("srcLang",e,t),this}setDstLanguage(e,t){return this.getModel().setProperty("dstLang",e,t),this}requestSuggestion(){return this.getModel().requestSuggestion(),this}}t.TranslationPredictorPresenter=a},function(e,t,s){"use strict";t.__esModule=!0,t.TranslationPredictorModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(45),o=s(72),a=s(65),l=s(17);class c extends o.ListboxModel{constructor(e,t){super(e,t),this.on("invalid",this.abort),this._cashedResults={},this._requestedPrefix=[]}abort(){"alternatives"!==this.getProperty("reason")&&a.SyncModel.prototype.abort.call(this)}setRequest(e){a.SyncModel.prototype.setRequest.call(this,e)}incrementCounter(){return this.setProperty("counter",this.getProperty("counter")+1)}getData(){const e=this.toJSON();return{text:e.text,prefix:e.prefix,options:e.options}}getParams(){const e=this.toJSON();return{id:[e.sid,e.counter,0].join("-"),srv:e.srv,lang:e.srcLang+"-"+e.dstLang,fullword_prefix:e.fullwordPrefix}}getDefaults(){return{pos:0,srv:"",url:"/",text:"",prefix:"",reason:"",srcLang:"",dstLang:"",align:"",index:0,counter:0,options:0,sentenceIndex:0,fullwordPrefix:0,sid:this.getId()}}runRequest(){const e=this,t=new l.HTTPRequest(this.getProperty("url"));if(this.abort(),!this.isValid())return this;const s=this.getData(),i=this.getParams();return this.incrementCounter(),this._requestedPrefix.push(s.prefix),this.emit("query",i),this.setRequest(t.setType(l.HTTPRequest.types.FORM).setData(s).setParams(i).setMethod(l.HTTPRequest.methods.POST).send(function(t,i){const n=e._requestedPrefix.indexOf(s.prefix);if(n>=0&&e._requestedPrefix.splice(n,1),t)return e.emit("error",t);e._cashResult(s.prefix,i.body.text[0],i.body.align[0]),e.setProperty("align",i.body.align[0]),e.handleResponse(i.body.text[0],s.prefix)}))}requestSuggestion(){r.sessionManager.getSid().then(e=>{this.setProperty({sid:e}).runRequest()})}handleResponse(e,t){const s=n.default.getValueTokens(t),i=t.trim().length-s[s.length-1].length,r=t.length-t.trim().length,o=e.slice(i);!o||t===e&&"alternatives"!==this.getProperty("reason")||this.setProperty({pos:-s[s.length-1].length-r}).setItems([o])}clearCash(){this._cashedResults={}}showCashedResult(e=this.getProperty("prefix")){const t=this._cashedResults[e];this.setProperty("align",t.align),this.handleResponse(t.text,e)}getCashedResult(e=this.getProperty("prefix")){const t=this._cashedResults[e],s=n.default.getValueTokens(e),i=e.trim().length-s[s.length-1].length;return this.setProperty("align",t.align),t.text.slice(i)}isCachedPrefixValid(e=this.getProperty("prefix")){const t=this._cashedResults[e]&&this._cashedResults[e].text;return t&&n.default.startsWith(t,e)}wasRequested(e=this.getProperty("prefix")){return this._requestedPrefix.includes(e)}_cashResult(e,t,s){this._cashedResults[e]={text:t,align:s}}}t.TranslationPredictorModel=c,c.options={ALIGN:4}},function(e,t,s){"use strict";t.__esModule=!0,t.initComplaintPopup=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(32),a=s(140),l=s(11),c=s(152),d=s(2),u=s(147);const h="complaint",p="error",g="success",{$track:E}=(0,r.getTrackerByNamespace)(u.RELATED_WORDS_METRIKAS);t.initComplaintPopup=function(e){const t=this,s=t.getView(),i=t.getModel(),r=new d.TouchView({element:e.ELEMENTS.complaintInfoPopup,hideAfterTransition:!0}),_=new o.ListboxView({element:e.ELEMENTS.complaintPopup,template:e.TEMPLATES.empty,contentElement:e.ELEMENTS.dropContent,hideAfterTransition:!0}),T={isInitial:!0,top:0,left:0};let m;const f=this.getComplaintCommentInput(),S=new a.InputPresenter({view:new l.InputView({element:e.ELEMENTS.complaintPopupProposal,activateFocus:!0,contentElement:e.ELEMENTS.complaintPopupProposalInput}),model:new c.InputModel});let C;const A=e=>{_.getElement().setAttribute("data-status",e)},L=()=>{m&&m.removeAttribute("data-highlighted")},y=()=>{_.setVisible(!1)},R=()=>{const e={type:n.default.getAttribute(m,"data-complaint-type"),name:n.default.getAttribute(m,"data-dict-type"),title:(n.default.getAttribute(m,"data-title")||"").replace("\n","").trim(),value:(m.textContent||"").trim(),comment:f.getValue(),proposal:S.getView().getValue()},t=n.default.getAttribute(m,"data-group-index","0");t&&(e.groupIndex=Number(t)+1);const s=n.default.getAttribute(m,"data-part-of-speech");return s&&(e.partOfSpeech=s),this.emit("dictComplaint",e)},O=()=>{this.emit("exampleComplaint",{id:n.default.getDataAttr(m,"id"),text:n.default.getDataAttr(m,"text"),translation:n.default.getDataAttr(m,"translation"),src:i.getProperty("text"),comment:f.getValue(),isIdiom:"idiom"===n.default.getDataAttr(m.querySelector(".example_ref"),"type")}),this.emit("complaintStatus")},I=()=>{E(u.RELATED_WORDS_METRIKAS.WORDS_COMPLAINT_SEND,{comment:f.getValue(),dir:this.getLangsPair(),src:i.getProperty("text"),wordType:n.default.getDataAttr(m,"word-type"),wordValue:n.default.getDataAttr(m,"value")}),this.emit("complaintStatus")},P=()=>{if(_.setState("error",!1),i.getProperty("complaint"))switch(n.default.getDataAttr(m,"complaint-type")){case"example":O();break;case"relatedWord":I();break;case"declensions":this.emit("complaintStatus");break;default:R()}},N=function(e,r){if(i.getProperty("complaint"))if(r&&r===m)m=null,t.setComplaintTarget(null),i.setProperty("complaint",!1),s.setState("complaint",!1);else if(r!==m){const e=_.getElement(),t=e.style,s=n.default.getAttribute(m,"data-complaint-type"),i=n.default.toObject(m.getBoundingClientRect()),r=()=>{("fullTextTranslation"===s?S:f).getView().setFocus(!0)};m.setAttribute("data-highlighted",!0),e.setAttribute("data-complaint-type",s),clearTimeout(C),_.on("stateSet:transitionEnded",e=>{e&&r()}).setPosition(i,!1,!0).setVisible(!0),(({top:e,left:t})=>T.top!==e||T.left!==t)(t)&&((({top:e,left:t})=>{T.isInitial=!1,T.top=e,T.left=t})(t),T.isInitial||r())}};return t.on("showComplaintPopup",function(e,t){A(t),clearTimeout(C),setTimeout(()=>{_.setVisible(!0).setPosition(e.getBoundingClientRect(),!1,!0)},0)}).on("closeComplaintPopup",function(){y()}).on("complaintStatus",function(e){C=setTimeout(()=>{y(),L()},4e3),A(e?p:g)}).on("action",function(e){switch(e){case"sendComplaint":case"retryComplaint":P();break;case"cancelComplaintMode":case"toggleComplaintMode":(()=>{const e=s.hasState("complaint");i.setProperty("complaint",!e,{type:"auto",sender:"dict"}),s.setState("complaint",!e)})()}}),_.onVisibilityChanged(function(e){const s=e?"once":"off";t[s]("resize",y),t[s]("dictScrolled",y)}),s.onStateChanged("complaint",e=>{r.setVisible(e)}).on("tap",function(e,s=null){if(!i.getProperty("complaint")&&!_.isVisible())return;const r=s||e.target;if(!((e,t=null)=>{const i=t||e.target,n=_.getElement().contains(i);return!n&&!s})(e,s))return;L();const o=m;m=this.getClosest(r,function(e){return"true"===n.default.getDataAttr(e,"complaint-target")||e.hasAttribute("data-complaint-type")}),t.setComplaintTarget(m),m&&n.default.getDataAttr(m,"complaint-type")?(A(h),N(0,o)):y()}),i.on("change",function(e,t){switch(e){case"trText":case"selText":case"srcLang":case"dstLang":this.getProperty("complaint")&&this.setProperty("complaint",!1,{type:"change"});break;case"complaint":t||y()}}),_.on("stateChanged:hidden",function(e){e?(L(),m=null,t.setComplaintTarget(null),i.setProperty("complaint",!1),s.setState("complaint",!1)):(r.setVisible(!1),f.setValue(""),S.setValue(""))}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initShareButton=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2),o=s(179),a=s(32),l=s(180);t.initShareButton=function(e){const t=this,s=this.getModel(),i=new r.TouchView({element:e.ELEMENTS.shareInput,stopDefaultAction:!0}),c=new r.TouchView({element:e.ELEMENTS.shareButton,activateFocus:!0,ignorePreventFocus:!0}),d=new r.TouchView({element:e.ELEMENTS.shareCopyLink,stopDefaultAction:!0}),u=new o.SharePresenter({view:new a.ListboxView({element:e.ELEMENTS.share,template:e.TEMPLATES.listbox,contentElement:e.ELEMENTS.shareContent,stopDefaultAction:!0,ignoreSelection:!0,hideAfterTransition:!0}),model:new l.ShareModel({url:e.SHARE_URL,title:document.title})}),h=u.getView(),p=function(s){if(c.setEnabled(s&&s.length<=e.MAX_SHARE_TEXT_LENGTH),!s)return;const n=t.getLink({absolute:!0});i.setTextContent(n),u.setLink(n).setDescription(s)};return this.on("action",function(t){switch(t){case"mailTo":u.write();break;case"openSearch":this.emit("textSearch"),window.open(e.SEARCH_URL+"?"+n.default.toQueryString({text:'"'+s.getProperty("translation")+'"'}))}}).bindFocusActivation(c),s.on("set:translation",p),i.on("tap",function(){n.default.selectElement(this.getElement()),c.setFocus(!0),t.emit("shareInputClick")}),c.on("tap",function(){c.setFocus(!0),t.emit("sharingOpen"),h.setVisible()}).on("stateChanged:focused",function(e){e||h.setVisible(!1)}),u.prepareData=function(t){const s={};return s.items=t.map(function(t){return{value:t,title:e.SOCIAL_SERVICES[t]}}),s},u.on("share",function(e){t.emit("shareData",e)}).on("write",function(e){t.emit("writeMail",e)}),d.on("tap",function(){this.hasState("copy")&&n.default.copyText(t.getLink({absolute:!0}))&&s.setProperty("tooltip",e.TOOLTIPS.copiedLink),n.default.selectElement(i.getElement()),c.setFocus(!0),t.emit("shareButtonClick")}).on("stateChanged:copy",function(e){const t=this.getElement();t.setAttribute("data-tooltip-nohide",e)}).setState("copy",n.default.copySupported),h.on("stateChanged:hidden",function(e){e||this.setPosition(c.getRect(),!0,!0)}),p(s.getProperty("translation")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initExternalView=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(24);t.initExternalView=function(e){const t=this.getModel(),s=new r.TemplateView({element:e.ELEMENTS.external,template:e.TEMPLATES.external,contentElement:e.ELEMENTS.externalContent}),i=function(t){let i;t&&(i=this.toJSON(),s.renderData({items:Object.keys(e.EXTERNAL_SERVICES).map(function(t){const s={},r=e.EXTERNAL_SERVICES[t];return s[r.textParam]=i.trText,s[r.srcLangParam]=i.srcLang,s[r.dstLangParam]=n.default.normalizeExternalLang(i.dstLang,r),{text:t,name:t,href:r.href+"?"+n.default.toQueryString(s)}})})),s.setVisible(t&&t.length<=e.MAX_SHARE_TEXT_LENGTH)};return t.on("set:translation",i),i.call(t,t.getProperty("translation")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initTranslationVote=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2),o=s(11),a=s(140),l=s(152);const c="feedback",d="success_like",u="success_dislike";t.initTranslationVote=function(e){const t=this,s=this.getView(),i=this.getModel(),h=new r.TouchView({element:e.ELEMENTS.goodVoteButton}),p=new r.TouchView({element:e.ELEMENTS.badVoteButton}),g=new o.InputView({element:o.InputView.makeFakeArea(e.ELEMENTS.translation),activateFocus:!0}),E=new a.InputPresenter({view:g,model:new l.InputModel}),_=E.getModel(),T=new r.TouchView({element:e.ELEMENTS.feedbackPopup,hideAfterTransition:!0}),m=new a.InputPresenter({view:new o.InputView({element:e.ELEMENTS.feedbackInput,activateFocus:!0}),model:new l.InputModel});let f=!1;const S=e=>{setTimeout(()=>{f=!0,T.getElement().setAttribute("data-status",e),T.setVisible(!0)},0)},C=()=>{f=!1,T.setVisible(!1)};let A;return s.on("tap",function(t){f&&(e.ELEMENTS.keyboard.contains(t.target)||n.default.getClosest(t.target,e=>e===T.getElement())||C())}),this.on("action",e=>{if("saveEditing"===e){const e=n.default.trim(g.getValue()),t=i.getProperty("translation");e!==t&&(this.emit("editorResult",e,t),s.setState({edited:!0,editing:!1}))}else if("sendFeedback"===e){const e=i.getProperty("translation");this.emit("editorResult",m.getValue(),e),S(u)}else"cancelFeedback"===e&&C()}),this.on("changeEditorValue",function(e){_.setProperty("value",e)}).on("dstPredictorApply",e=>{_.setProperty("value",g.getValue(),{silent:!0}),E.setCaret(e.caret)}).bindFocusActivation(h).bindFocusActivation(p),s.on("stateChanged",function(e,s){switch(e){case"editing":s||t.emit("trAlign",null),t.emit("containerHeightChanged")}}),i.on("change",function(i,r,o){switch(i){case"trText":case"srcLang":case"dstLang":s.hasState("editing")&&t.emit("editorToggle",{type:"change",value:g.getValue()}),s.setState({edited:!1,editing:!1});break;case"translation":r&&t.toggleTranslatorExpandState(!0);const i=r&&r.length<=e.MAX_EDITOR_TEXTLENGTH&&!n.default.isUrl(r);p.setState("voted",!1).setEnabled(i),h.setState("voted",!1).setEnabled(i);break;case"userTranslation":g.setValue(r,o),o.caret&&E.setCaret(o.caret)}}),g.on("tap",()=>{this.emit("trTextTap")}).on("click",e=>{-1===e.target.className.indexOf("translit")&&this.emit("trTextClick",g.getSelection().start,g.getValue(),e)}).on("mousedown",()=>{this.emit("trTextMouseDown")}).on("keydown",e=>{this.emit("trTextKeydown",e,{sender:g})}).on("keyup",e=>{this.emit("trTextKeyup",e,{caret:g.getSelection().start})}).on("enterPressed",()=>{this.getSettings().isOptionEnabled("enter")&&this.emit("input")}).on("stateChanged:focused",e=>{this.emit("trTextFocus",e),e||this.emit("action","saveEditing"),s.setState("editing",e)}).bindDOMEvents("click mousedown keydown keyup enterPressed"),p.on("tap",()=>{s.hasState("complaint")&&this.emit("action","toggleComplaintMode"),C(),A&&clearTimeout(A),p.hasState("voted")?(p.setState("voted",!1),h.setEnabled(!0)):(p.setState("voted",!0),h.setEnabled(!1),t.emit("translationVoted",i.getProperty("translation")),m.setValue(""),S(c))}),h.on("tap",()=>{s.hasState("complaint")&&this.emit("action","toggleComplaintMode"),C(),A&&clearTimeout(A),h.hasState("voted")?(h.setState("voted",!1),p.setEnabled(!0)):(h.setState("voted",!0),p.setEnabled(!1),t.emit("translationVoted",i.getProperty("translation"),!0),S(d),A=setTimeout(C,5e3))}),E.on("input",function(e,n={}){s.hasState("editing")&&(n.caret=n.caret||this.getCaret(),n.reason=n.reason||"input",t.emit("trTextInput",e,n),i.setProperty("userTranslation",e,n))}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initTextCounter=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(2);t.initTextCounter=function(e){const t=this.getModel(),s=new r.TouchView({element:e.ELEMENTS.textCounter,contentElement:e.ELEMENTS.textCounterContent}),i=new r.TouchView({element:e.ELEMENTS.textCounter,contentElement:e.ELEMENTS.textCounterLimit}),o=()=>{const{srcLang:r,text:o}=t.getProps(),a="emj"===r,l=a?(()=>{const{text:e}=t.getProps(),s=n.default.getEmoji(e),i=s.reduce((e,{value:t})=>t.length+e,0);return s.length+e.length-i})():o.length,c=a?500:e.MAX_TRANSLATOR_QUERY;s.setState("warning",l>c).setTextContent(l),i.setTextContent(c)};return t.onChange("text",()=>{o()}).onChange("srcLang",()=>{o()}),o(t.getProperty("text")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initDescription=void 0;var i=s(2);t.initDescription=function(e){const t=this.getView(),s=this.getModel(),n=new i.TouchView({element:e.ELEMENTS.serviceDescription});return s.on("change",function(e,s,i){switch(e){case"trText":s&&n.setVisible(!1);break;case"srcLang":case"dstLang":i.oldValue&&t.setState("hidden_service-description",!0)}}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initDescriptionDict=void 0;var i=s(2);t.initDescriptionDict=function(e){const t=this.getView(),s=this.getModel(),n=new i.TouchView({element:e.ELEMENTS.serviceDescription});return s.on("change",function(e,s,i){switch(e){case"trText":case"srcLang":case"dstLang":i.oldValue&&(t.setState("hidden_service-description",!0),n.setVisible(!1))}}),this}},function(e,t,s){"use strict";var i;t.__esModule=!0,t.initMetrikas=void 0,(i=s(0))&&i.__esModule,s(10),s(2),s(17),s(23),s(3),s(147),s(149),s(137),s(134),s(190),s(191),t.initMetrikas=function(e){return!1}},function(e,t,s){"use strict";t.__esModule=!0,t.initUniproxy=void 0;var i=s(160);t.initUniproxy=function(e){return this._uniproxy=new i.Uniproxy({apiKey:e.SPEECHKIT_KEY,url:e.UNIPROXY_URL}),this}},function(e,t,s){"use strict";t.__esModule=!0,t.initDistBanner=void 0;var i=s(267);t.initDistBanner=i.initDistBanner},function(e,t,s){"use strict";t.__esModule=!0,t.initDistBanner=function(e){if(e.DISABLE_DIST_BANNER)return this;const t=this.getView(),s=this.getModel(),o=new n.View({element:e.ELEMENTS.distContainer}),a=()=>{(()=>{const e=o.getElement().querySelector("div");return e&&e.childNodes.length&&o.isVisible()})()&&o.setVisible(!1)};return t.onStateChanged("training",e=>{e&&o.isVisible()&&o.setVisible(!1)}),e.SRV===i.TOUCH?s.onChange("textAreaFocused",e=>{e&&a()}):s.onChange("text",(e,t)=>{"input"===t.reason&&a()}),o.onHide(()=>r.$tracker.sendMetric("dist_banner_hide")),this};var i=s(19),n=s(16),r=s(3)},function(e,t,s){"use strict";function i(){const e=window.config.SUGGESTIONS_CONF||{},t=e.ruOverride||e,s=(e,t,s=0)=>t in e?e[t]:s;return{limitPredict:s(e,"predicts"),limitSuggest:s(e,"suggests"),limitOnlyPredict:s(e,"fallbackPredicts",s(e,"predicts")),ruOverride:{limitPredict:s(t,"predicts"),limitSuggest:s(t,"suggests"),limitOnlyPredict:s(t,"fallbackPredicts",s(t,"predicts"))}}}t.__esModule=!0,t.initSuggestions=void 0;var n,r=(n=s(0))&&n.__esModule?n:{default:n},o=s(269),a=s(11),l=s(270),c=s(141),d=s(190);t.initSuggestions=function(e){const t=this.getView(),s=this.getSettings(),n=this.getModel(),{srcLang:u,dstLang:h}=n.getProps(),p=this.getMeasurerViewSrc(),g=new o.SuggestionsModel({...i(),srcLang:u,dstLang:h,srv:e.SRV,detectOptions:l.DETECTING_OPTIONS.KBD,enableRuOverriding:"ru"===e.UI_LANG},{url:e.SUGGESTIONS_URL,detectUrl:e.DETECTOR_URL,validators:{text(e){return e&&!r.default.isUrl(r.default.trim(e))&&!r.default.isElvishLanguage(this.getProperty("srcLang"))},srcLang:t=>r.default.hasProperty(e.PREDICTOR_LANGS,t)}}),E=new d.Suggestions({model:g},{container:e.ELEMENTS.suggestions}),_=()=>{const{textScrollY:e}=n.getProps();p.scrollTo(p.getScrollInfo().maxTop/100*e)},T=()=>{E.handlePosition(p.getContentElement("[data-measurer-target]").getBoundingClientRect())};return this.on("textTap",(e,t)=>{t&&t.target&&r.default.getClosest(t.target,e=>e===E.getContainer())||E.setVisible(!1)}).on("textFocus",e=>{t.hasState("select")||E.setEnabled(e),e||E.setVisible(!1)}).on("resize",()=>{E.setVisible(!1)}).on("textKeydown",e=>{if(e.keyCode===a.KEYBOARD_KEYS.ENTER&&!s.isOptionEnabled(c.AVAILABLE_OPTIONS.ENTER)){if(e.shiftKey)return void E.setVisible(!1);r.default.preventEvent(e)}if(E.isVisible()&&E.isEnabled())switch(e.keyCode){case a.KEYBOARD_KEYS.ENTER:if(e.shiftKey)break;r.default.preventEvent(e),E.applyActiveItem(d.SUGGESTIONS_APPLYING_SOURCES.ENTER),E.setVisible(!1),this.updateTrText("enter");break;case a.KEYBOARD_KEYS.TAB:r.default.preventEvent(e),E.applyActiveItem(d.SUGGESTIONS_APPLYING_SOURCES.TAB),E.setVisible(!1);break;case a.KEYBOARD_KEYS.UP:r.default.preventEvent(e),E.updateActiveIndex(-1);break;case a.KEYBOARD_KEYS.DOWN:r.default.preventEvent(e),E.updateActiveIndex(1);break;case a.KEYBOARD_KEYS.LEFT:case a.KEYBOARD_KEYS.RIGHT:E.setEnabled(!1);break;case a.KEYBOARD_KEYS.ESCAPE:E.isEnabled()&&this.updateTrText("escape"),E.setEnabled(!1)}}).onAction("toggleAuto",()=>{g.toggleAuto()}),n.onChange("text",(t,s)=>{if(!r.default.trim(t))return g.setText("",s.sender||s.reason),E.setVisible(!1);if("url"===s.sender&&e.DEFAULT_SRC_LANG)return;const{srcLang:i,dstLang:n}=this.getProps(),o=s.caret?s.caret+t.slice(s.caret).search(/\s|$/):0,a=(0,l.extractTextWords)(t.slice(0,o),20);g.setText(a,s.sender||s.reason).setProperty({index:o,srcLang:i,dstLang:n})}).onChange(["srcLang","dstLang"],(e,t)=>{E.setEnabled(!1),g.setProperty(e,t)}).onChange("textScrollY",()=>{E.setEnabled(!1)}),g.on("detect",(e,t)=>{t||this.setSrcLanguage(e)}).on("auto",e=>{t.setState({auto:e}),s.setProperty({auto:e})}).on(["error","invalid"],()=>{E.setEnabled(!1)}).on("endOfWord",()=>{this.emit("predictorEndOfWord").updateTrText()}),E.on(d.SUGGESTIONS_EVENTS.ITEMS_UPDATED,()=>{const{reason:e}=g.getProps();let{text:s}=n.getProps();if(!["input","predictor"].includes(e)||t.hasState("select"))return E.setEnabled(!1);E.setVisible(!0),E.setEnabled(!0);const i=(0,l.createInsertingRange)(s,g.getIndex(),g.getPos());if(!i)return E.setEnabled(!1);i.appendSpace&&(s+=" "),p.renderData({text:s.slice(i.start,i.end)||".",leftText:s.slice(0,i.start),rightText:s.slice(i.end)}),_();const r=p.getScrollInfo();if(r.maxTop){const e=(e=>{const t=p.getContentElement("[data-measurer-target]").getBoundingClientRect(),s=p.getContentElement().getBoundingClientRect(),i=t.top-s.top-e.clientHeight;return i>0?e.top+i+t.height:null})(r);if(e)return n.emit("translationViewScrollY",e),void setTimeout(()=>{E.setEnabled(!0),_(),T()},100)}T()}).on(d.SUGGESTIONS_EVENTS.APPLY,(e,t)=>{const{text:s}=n.getProps(),i=g.getIndex(),r=t===d.SUGGESTIONS_TYPES.SUGGEST?g.getSuggestionsPos():g.getPredictionsPos(),o=(0,l.insertTextFragment)(s,e.src,i,r);n.setProperty("text",o.text,{caret:o.caret,sender:"predictor",suggestType:t}),setTimeout(()=>n.emit("moveTextAreaCaret",o.caret),30)}),t.onStateChanged("select",e=>{e&&(E.setEnabled(!1),E.setVisible(!1))}).onStateChanged("empty",e=>{e&&(E.setEnabled(!1),E.setVisible(!1))}),g.toggleAuto(!s.hasProperty("auto")||s.getProperty("auto")),this}},function(e,t,s){"use strict";t.__esModule=!0,t.SuggestionsModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(130),o=s(43),a=s(17),l=s(29);class c extends o.SessionModel{constructor(e,t={}){super(e,t),this._url=t.url,this._counter=0,this._detectUrl=t.detectUrl,this._detectCounter=0,this._currentLimitPredict=this.getLimitParams().limitPredict,this.onChange("auto",e=>{this.detectLanguage(),this.emit("auto",e)}).onChange("text",(e,t)=>{t.reason&&this.setProperty("reason",t.reason),this.requestSuggestion(),this.detectLanguage()}).onChange("srcLang",(e,t)=>{t.detected&&this.emit("detect",e,t.kbd),this.requestSuggestion()}).onChange("suggestions",e=>{const{limitPredict:t,limitOnlyPredict:s}=this.getLimitParams();let i;i=e&&e.predictions&&e.predictions.length?t:s,i!==this._currentLimitPredict&&(this._currentLimitPredict=i,this.requestSuggestion())}).onChange("predictions",e=>{e&&e.endOfWord&&this.emit("endOfWord")})}getLimitParams(){const e=this.getProps(),t={limitPredict:e.limitPredict,limitSuggest:e.limitSuggest,limitOnlyPredict:e.limitOnlyPredict};return"ru"===e.srcLang&&e.enableRuOverriding&&e.ruOverride||t}getParams(){const e=this.getProps(),{limitSuggest:t}=this.getLimitParams();return{q:e.text,srv:e.srv,sid:e.sid,lang:this.getLangPair(),limitPredict:this._currentLimitPredict,limitSuggest:t}}getDefaults(){return{auto:!1,srv:"",text:"",limitPredict:3,limitSuggest:2,srcLang:"",dstLang:"",reason:"",sid:this.getId(),predictions:[],suggestions:[],enableRuOverriding:!1}}getLangPair(){const{srcLang:e,dstLang:t}=this.getProps();return e+"-"+t}getPredictionsPos(){const{predictions:e}=this.getProps();return e&&e.predictions.length?e.pos:null}getSuggestionsPos(){const{suggestions:e}=this.getProps();return e&&e.predictions.length?e.pos:null}getPos(){return Math.min.apply(Math,[this.getPredictionsPos(),this.getSuggestionsPos()].filter(e=>null!==e))}arePosesEqual(){return this.getPredictionsPos()===this.getSuggestionsPos()}getIndex(){return this.getProperty("index")}setText(e,t){return this.setProperty("text",e,{reason:t})}isAuto(){return this.getProperty("auto")}toggleAuto(e=null){return this.setProperty("auto",null!==e?Boolean(e):!this.isAuto())}getDetectParams(){const e=this.getProps();return{sid:e.sid,srv:e.srv,text:n.default.trim(e.text),hint:[e.srcLang,e.dstLang].join(","),options:e.detectOptions}}canDetectLanguage(){return this.isValid("text")}canRequestSuggestion(){return this.isValid()}runDetectRequest(){const e=this.getDetectParams(),t=++this._detectCounter;a.HTTPRequest.get(this._detectUrl,e,(s,i)=>{if(t!==this._detectCounter||JSON.stringify(e)!==JSON.stringify(this.getDetectParams()))return;const n=i&&a.HTTPRequest.isSuccessCode(i.code),o=(0,r.getLogErrorCode)({response:i,error:s});if(!n)return this.emit("detectError",s||new l.HTTPError(o,i.body.message));i.body.lang&&this.setProperty("srcLang",i.body.lang,{kbd:Boolean(i.body.kbd),detected:!0})})}detectLanguage(){return this.canDetectLanguage()&&this.getProperty("auto")?(this.getSid().then(()=>this.runDetectRequest()),this):this}runRequest(){const e=this.getParams(),t=++this._counter;this.emit("query",e),a.HTTPRequest.get(this._url,e,(s,i)=>{if(t===this._counter&&JSON.stringify(e)===JSON.stringify(this.getParams()))return s?this.emit("error",s):void("endOfWord"in i.body&&!("predictions"in i.body)?i.body.text?this.setProperty({suggestions:null,predictions:{endOfWord:i.body.endOfWord,pos:i.body.pos,predictions:i.body.text.map(e=>({src:e}))}}):i.body.endOfWord&&this.emit("endOfWord"):this.setProperty({predictions:i.body.predict,suggestions:i.body.suggest}))})}requestSuggestion(){return this.canRequestSuggestion()?(this.getSid().then(()=>this.runRequest()),this):this}}t.SuggestionsModel=c},function(e,t,s){"use strict";t.__esModule=!0,t.DETECTING_OPTIONS=void 0,t.createInsertingRange=function(e,t,s){const i={};if(s<0)i.end=t,i.start=t+s;else if(1===s&&t===e.length)i.appendSpace=!0,i.end=t+s,i.start=t+s;else{if(t!==e.length||" "!==e.charAt(t-1))return null;i.end=t,i.start=t}return i},t.extractTextWords=function(e,t){if(!n.default.trim(e))return"";const s=e.match(/(\S+\s*)/g),i=t?-t:0;return s?s.slice(i).join(""):""},t.insertTextFragment=function(e,t,s,i){let n=s,r=t;return i<0?n+=i:r=new Array(i+1).join(" ")+t,{text:e.slice(0,n)+r+e.slice(s),caret:n+r.length}};var i,n=(i=s(0))&&i.__esModule?i:{
default:i};t.DETECTING_OPTIONS={KBD:1}},function(e,t,s){"use strict";t.__esModule=!0,t.TooltipModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(131);class o extends r.TooltipModule{constructor(e,t){super(e,t),this.app.on("bodyScroll",n.default.throttle(()=>{this.tooltipView.setVisible(!1)},500))}}t.TooltipModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.HistoryModule=void 0;var i=s(182),n=s(136),r=s(161),o=s(192),a=s(191);class l extends i.AbstractHistoryModule{constructor(e,t){super(e,t),this.listenSettings(),(this.appConfig.LANDING_TYPE||this.appConfig.DEFAULT_TEXT)&&this.history.setVisible(!1)}makeHistoryComponent(){return new a.History({storageModel:this.historyCache},{container:this.appConfig.ELEMENTS.historyRecent})}listenSettings(){this.appSettings.onChange(()=>this.updateHistorySettingState())}listenAppModel(){super.listenAppModel();let e=!1;this.appModel.onChange("historyEnabled",(e,{oldValue:t})=>{"boolean"==typeof t&&this.app.emit("historySettingToggle",e)}).onChange("selText",t=>{e=t===this.appModel.getProperty("text")}).onBeforeSet("text",t=>{!t&&e&&this.updateHistory(),e=!1})}listenApp(){super.listenApp(),this.app.on(r.TEXTAREA_APP_EVENTS.CLEAR,()=>{this.updateHistory()}).on(o.TTS_APP_EVENTS.SPEAKER_ACTION,({action:e=null})=>{e===n.PLAYER_ACTIONS.PLAY&&this.updateHistory()}).on(["synRendered","dictRendered","examplesRendered"],()=>{this.appModel.getProperty("translation")&&this.history.setVisible(!1)}).on("exampleTabTap",()=>{this.updateHistory()}).on("rubberScrolled",()=>{this.updateHistoryAsync()})}listenHistoryComponent(){super.listenHistoryComponent(),this.history.on(a.HISTORY_EVENTS.APPLY_ITEM,()=>{this.history.setVisible(!1)})}}t.HistoryModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.CardsCarouselModule=t.APP_EVENTS=void 0;var i=s(274),n=s(162),r=s(275);t.APP_EVENTS={};class o extends i.AbstractCardsCarouselModule{constructor(e,t){super(e,t),this.app.on("resize",()=>{this.cardsCarousel.updateCarouselPosition()}).on(n.CARDS_CAROUSEL_EVENTS.APPLY_ACTIVE_PHRASE,()=>{this.cardsCarousel.applyActiveItem()}),this.appView.onStateChanged("translatorExpanded",e=>{this.appConfig.ELEMENTS.cardsCarousel.tabIndex=e?-1:0,this.cardsCarousel.setAccessibility(!e)}),this.cardsCarousel.setAccessibility(!this.appView.hasState("translatorExpanded"))}makeCarousel(){const e=this.appConfig.DAILY_PHRASES||[];return new r.CardsCarousel({phrases:this.appConfig.ENABLE_STORIES?e.slice(0,1):e,stories:this.appConfig.ENABLE_STORIES?this.appConfig.stories:[]},{container:document.getElementById("cardsCarousel")})}}t.CardsCarouselModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractCardsCarouselModule=void 0;var i=s(5),n=s(162);class r extends i.AppModule{constructor(e,t){super(e,t),this.moduleName="cardsCarousel",this.cardsCarousel=this.makeCarousel(),this.cardsCarousel.on(n.CARDS_CAROUSEL_EVENTS.OPEN_STORY,e=>{this.app.emit("stories:open",e)}).on(n.CARDS_CAROUSEL_EVENTS.APPLY_PHRASE,e=>{this.appModel.setProperty({srcLang:e.lang,text:e.text},{sender:"dailyPhrase"})})}makeCarousel(){}}t.AbstractCardsCarouselModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.CardsCarousel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(162),a=s(15),l=s(30);class c extends o.AbstractCardsCarousel{constructor(e,t){super(e,t),this.onChange("activeCard",()=>{this.updateCarouselPosition()}),this.updateCarouselPosition()}updateActiveClass(){const{activeCard:e}=this.getProps(),t=this.getRef(this.refs.carousel),s=t.querySelector(".state-active-bg"),i=t.children[e];s&&n.default.activateClass(s,"state-active-bg",!1),i&&n.default.activateClass(i,"state-active-bg",!0)}moveCarousel(e){const{activeCard:t,stories:s}=this.getProps(),i=t+e;i>this.getCardsCount()||i<0||(i<s.length&&r.$tracker.sendMetric("stories_desktop_preview_move",{index:i,preview:s[i].id}),this.setProperty("activeCard",i))}setAccessibility(e){const t=this.getRef(this.refs.backButton),s=this.getRef(this.refs.forwardButton);if(t&&s){const i=e?0:-1;t.tabIndex=i,s.tabIndex=i}}applyActiveItem(){const{activeCard:e,phrases:t}=this.getProps(),s=t[e];s&&this.applyPhrase(s)}updateCarouselPosition(){return!1}template({html:e,cn:t}){const s=t("cardsCarousel");return e`
            <button
                class=${s("button",{prev:!0})}
                @click=${this.moveCarousel.bind(this,-1)}
                tabIndex="0"
                data-default-enter-action="true"
                role="button"
                aria-label=${l.locales.cardsCarousel.previousDailyCardPhrase}
            >
                ${(0,a.icn)("arrow-short-back")}
            </button>
            <button
                class=${s("button",{next:!0})}
                @click=${this.moveCarousel.bind(this,1)}
                tabIndex="0"
                data-default-enter-action="true"
                role="button"
                aria-label=${l.locales.cardsCarousel.nextDailyCardPhrase}
            >
                ${(0,a.icn)("arrow-short-forward")}
            </button>
            <div class=${s("carousel")} data-ref-id=${this.refs.carousel}>
                ${this.itemsTemplate()}
            </div>
        `}}t.CardsCarousel=c},function(e,t,s){"use strict";t.__esModule=!0,t.DictionaryModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(277);class o extends r.AbstractDictionaryModule{constructor(e,t){super(e,t),this.app.onAction("enableCustomMode",()=>this.enableCustomMode()).onAction("disableCustomMode",()=>this.disableCustomMode())}enableCustomMode(){const{selTr:e,selText:t,srcLang:s,dstLang:i}=this.appModel.getProps(),r=t||e;this.dictionaryModel.setProperty("text",n.default.trim(r),{silent:!0}),e?this.dictionaryModel.setProperty({dirReversed:!0,srcLang:i,dstLang:s},{silent:!0}):this.dictionaryModel.setProperty({dirReversed:!1,srcLang:s,dstLang:i},{silent:!0}),this.updateDictionaryModel(this.dictionaryModel.getProps()),this.dictionaryModel.requestData()}disableCustomMode(){this.setupDictionaryModel(),this.dictionary.reset(),this.dictionaryModel.setProperty({data:"",dirReversed:!1},{silent:!0}).requestData()}makeDictionaryComponent(){const e={reset(){},setEnabled(){},setVisible(){},hasItems(){},setItems:()=>e,setSourceText:()=>e,onVisibilityChanged:()=>e,on:()=>e};return e}}t.DictionaryModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDictionaryModule=t.APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(3),a=s(149),l=s(278);const{$track:c}=(0,o.getTrackerByNamespace)(a.DICTIONARY_METRIKAS);t.APP_EVENTS={};class d extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="dict",this.dictionaryModel=this.app.getDictionaryModel(),this.dictionary=this.makeDictionaryComponent(),this.listenApp(),this.listenAppModel(),this.listenDictionary(),this.listenDictionaryModel(),this.setupDictionaryModel(),this.dictionary.setEnabled(!0)}setupDictionaryModel(){(0,l.setupDictionaryModel)(this.dictionaryModel,this.appModel.getProps(),this.appConfig),this.updateDictionaryModel()}updateDictionaryModel(e=null){(0,l.updateDictionaryModel)(this.dictionaryModel,e||this.appModel.getProps(),this.appConfig)}onDictionaryItemApply(){}listenDictionaryModel(){this.dictionaryModel.on(a.DICTIONARY_EVENTS.DICT_FETCHED,e=>{this.dictionary.setSourceText(this.appModel.getProperty("text")).setItems(e).setVisible(e&&e.length)}).on("error",()=>this.dictionary.reset())}listenDictionary(){this.dictionary.onVisibilityChanged(e=>{this.appView.setState("has_dict",e)}).on(a.DICTIONARY_EVENTS.APPLY_ITEM,(e,t)=>{this.appView.hasState("complaint")||(this.appModel.setProperty("text",e,{type:t,sender:"dictionary"}),c(a.DICTIONARY_METRIKAS.DICT_LINK_CLICK))}).on(a.DICTIONARY_EVENTS.SEND_METRIC,(e,t={})=>{const{text:s}=this.appModel.getProps();c(e,{text:s,dir:this.app.getLangsPair(),hasExamples:this.appView.hasState("has_examples")?1:0,...t})})}listenAppModel(){const e=n.default.debounce(()=>{this.updateDictionaryModel(),this.dictionary.setVisible(this.dictionaryModel.isValid()&&this.dictionary.hasItems()),this.dictionaryModel.requestData()}),t=(t,s)=>{this.dictionaryModel.setProperty(t,s),e()};this.appModel.onChange("trText",e=>{e||this.dictionary.setItems([]),t("text",e)}).onChange(["srcLang","dstLang"],(e,s)=>{t(e,s)})}listenApp(){this.app.onAction("retry",()=>{this.dictionaryModel.requestData()}).on("translationError",()=>this.dictionary.reset())}makeDictionaryComponent(){}}t.AbstractDictionaryModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.updateDictionaryModel=t.setupDictionaryModel=void 0;var i=s(70);t.setupDictionaryModel=((e,t,s)=>{const{trText:n,srcLang:r,dstLang:o}=t;n&&e.setProperty("text",n),r&&e.setProperty({srcLang:r}),o&&e.setProperty({dstLang:o}),e.setFlag(i.DICT_FLAGS.MORPHO,!0).setFlag(i.DICT_FLAGS.FAMILY,s.FAMILY).setFlag(i.DICT_FLAGS.SHORT_POS,!0).setFlag(i.DICT_FLAGS.TOOLTIPS,!0).setFlag(i.DICT_FLAGS.IDIOMS,!0).setFlag(i.DICT_FLAGS.ABBR,!0).setFlag(i.DICT_FLAGS.DICT_AND_DEF,!0).setFlag(i.DICT_FLAGS.NEW_DECLENSIONS,!0)}),t.updateDictionaryModel=((e,t,s)=>{const{srcLang:n,dstLang:r}=t,o=`${n}-${r}`,a=`${n}-${n}`;e.setType(i.DICT_TYPES.REGULAR,s.DICTIONARY_LANGS[o]).setFlag(i.DICT_FLAGS.DEFINITIONS,r===s.UI_LANG).setFlag(i.DICT_FLAGS.DECLENSIONS,s.DECLENSIONS_LANGS[n]).setType(i.DICT_TYPES.SYN,s.DICTIONARY_LANGS[a]).setType(i.DICT_TYPES.ANT,s.ANT_LANGS[n]).setType(i.DICT_TYPES.DERIV,s.DERIV_LANGS[n])})},function(e,t,s){"use strict";t.__esModule=!0,t.ExamplesModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(280),o=s(137),a=s(163),l=s(282);class c extends r.AbstractExamplesModule{constructor(e,t){super(e,t),this.examplesComponent.setProperty("bannedExamples",this.app.getBannedExamplesStorage().getProperty("ids")),this.app.getContainerView().onStateChanged("rightEmpty",e=>{this.examplesComponent.setProperty("twoColumnsRender",e).updateAsync()}),this.appView.onStateChanged("rightEmpty",e=>{this.examplesComponent.setProperty("twoColumnsRender",e).updateAsync()}),this.app.onAction("enableCustomMode",()=>this.enableCustomMode()).onAction("disableCustomMode",()=>this.disableCustomMode()),this.tooltip=this.makeTooltipComponent(),this.tooltipHideTimeoutId=null}listenApp(){super.listenApp(),this.app.getBannedExamplesStorage().onChange("ids",e=>{this.examplesComponent.setProperty("bannedExamples",e).update()})}listenExamplesComponent(){super.listenExamplesComponent(),this.examplesComponent.on(o.EXAMPLES_EVENTS.WORD_SELECTED,()=>this.app.swapDirection())}enableCustomMode(){const{selTr:e,selText:t,srcLang:s,dstLang:i}=this.appModel.getProps(),r=t||e;this.examplesModel.setProperty("text",n.default.trim(r),{silent:!0}),e?this.examplesModel.setProperty("srcLang",i,{silent:!0}).setProperty("dstLang",s,{silent:!0}):this.examplesModel.setProperty("srcLang",s,{silent:!0}).setProperty("dstLang",i,{silent:!0}),this.examplesModel.requestData()}disableCustomMode(){this.examplesComponent.reset(),this.setupExamplesModel(),this.examplesModel.requestData()}clearTooltipHideTimeout(){this.tooltipHideTimeoutId&&(clearTimeout(this.tooltipHideTimeoutId),this.tooltipHideTimeoutId=null)}showTooltip({example:e,content:t}){this.clearTooltipHideTimeout();const s=document.querySelector(`[data-tooltip-id="${e.id}"]`);this.tooltip.setProperty({content:t}),this.tooltip.show(s)}hideTooltip(){this.clearTooltipHideTimeout(),this.tooltipHideTimeoutId=setTimeout(()=>{this.tooltip.rootElement.matches(":hover")||this.tooltip.hide()},300)}makeExamplesComponent(){return new l.ExamplesComponent({showTooltip:({example:e,content:t})=>this.showTooltip({example:e,content:t}),hideTooltip:()=>this.hideTooltip(),areNewExamplesEnabled:this.appConfig.ENABLE_NEW_EXAMPLES},{container:this.appConfig.ELEMENTS.examples,hideAfterTransition:!0,skipFadeoutTransition:!0})}makeTooltipComponent(){return new a.Tooltip({position:"top-right",sticky:!0,shouldAutoHide:!0})}}t.ExamplesModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractExamplesModule=t.$track=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(3),o=s(5),a=s(137),l=s(281);const{$track:c}=(0,r.getTrackerByNamespace)(a.EXAMPLE_METRIKAS);t.$track=c;class d extends o.AppModule{constructor(e,t){super(e,t),this.moduleName="examples",this.examplesModel=this.app.getExamplesModel(),this.examplesComponent=this.makeExamplesComponent(),this.listenExamplesComponent(),this.listenAppModel(),this.listenApp(),this.setupExamplesModel(),this.listenExamplesModel()}listenExamplesComponent(){this.examplesComponent.on(a.EXAMPLES_EVENTS.WORD_SELECTED,e=>{if(this.appView.hasState("complaint"))return;const t=e.split(":");this.examplesComponent.setProperty("ignoreNextEmptyResponse",!0),this.appModel.setProperty("text",t[1],{type:t[0],sender:"example"})}).on(a.EXAMPLES_EVENTS.SEND_METRIC,(e,t)=>this.sendMetric(e,t)).on(a.EXAMPLES_EVENTS.OPEN_IDIOM_POPUP,(e,t,s)=>this.app.emit(a.EXAMPLES_EVENTS.OPEN_IDIOM_POPUP,e,t,s)).onVisibilityChanged(e=>{this.appView.setState("has_examples",e)})}listenAppModel(){const e=n.default.debounce(()=>{this.examplesModel.requestData()}),t=(t,s)=>{this.examplesModel.setProperty(t,s),e()};this.appModel.onChange("text",e=>{e||this.examplesComponent.setVisible(!1)}).onChange("trText",e=>t("text",e)).onChange(["srcLang","dstLang"],(e,s)=>t(e,s))}listenApp(){this.app.on("action:retry",()=>{this.examplesModel.requestData()}).on("translationError",()=>this.examplesComponent.reset())}listenExamplesModel(){this.examplesModel.onSet("data",(e,t)=>this.handleFetchedData(e,t)).on(["error","invalid"],()=>this.examplesComponent.reset())}handleFetchedData(e,t={}){if("selection"===t.reason)return;const{exampleTabs:s,allExamples:i}=this.examplesModel.prepareExamples(e),n=i.length>0,{ignoreNextEmptyResponse:r}=this.examplesModel.getProps();return n?(n&&this.sendMetric(a.EXAMPLE_METRIKAS.EXAMPLES_RENDERED,{items:s.map(({examples:e})=>({ids:(e||[]).map(({id:e})=>e)}))}),this.examplesComponent.setProperty("currentExamples",i).setProperty("allExamples",i).setProperty("exampleTabs",s).setProperty("activeTabIndex",null).setProperty("currentMaxExamplesCount",this.examplesComponent.defaultExampleCount).setProperty("amountOfExpands",0).setProperty("text",this.examplesModel.getProperty("text")).setVisible(n),this.examplesComponent.onceRendered(()=>this.examplesComponent.resetWordCarouselScroll()),this.examplesComponent.updateAsync(),n):r?this.examplesComponent.setProperty("ignoreNextEmptyResponse",!1):this.examplesComponent.reset()}sendMetric(e,t={}){const{text:s}=this.appModel.getProps(),i={text:s,hasDict:this.appView.hasState("has_dict")?1:0,dir:this.app.getLangsPair(),...t};c(e,i)}setupExamplesModel(){(0,l.setupExamplesModel)(this.examplesModel,this.appModel.getProps(),this.appConfig)}makeExamplesComponent(){return{}}}t.AbstractExamplesModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.setupExamplesModel=void 0;var i=s(70),n=s(157);t.setupExamplesModel=((e,t,s)=>{e.setFlag(i.DictionaryPresenter.flags.MORPHO,!0).setFlag(i.DictionaryPresenter.flags.FAMILY,s.FAMILY).setFlag(i.DictionaryPresenter.flags.SHORT_POS,!0).setFlag(i.DictionaryPresenter.flags.IDIOMS,!0).setFlag(i.DictionaryPresenter.flags.TOOLTIPS,!0),s.ENABLE_NEW_EXAMPLES&&e.setOption(n.EXAMPLES_OPTIONS.CHUNKS,!0).setOption(n.EXAMPLES_OPTIONS.MONOLING,!0).setOption(n.EXAMPLES_OPTIONS.STACKOVERFLOW,!0).setOption(n.EXAMPLES_OPTIONS.SITES,!0),t.trText&&e.setProperty("text",t.trText),t.srcLang&&e.setProperty("srcLang",t.srcLang),t.dstLang&&e.setProperty("dstLang",t.dstLang)})},function(e,t,s){"use strict";function i(e,t,s){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(s):r.value}})(e,t,s||e)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.__esModule=!0,t.ExamplesComponent=void 0;var r,o=(r=s(0))&&r.__esModule?r:{default:r},a=s(15),l=s(175),c=s(137),d=s(283),u=s(164);class h extends d.AbstractExamplesComponent{constructor(e,t){super(e,t),this.expandStep=12,this.scrollStep=300,this.defaultExampleCount=10,this.onRendered(()=>{const e=this.getRef(this.refs.wordsCarousel);e&&(e.onscroll=o.default.throttleWithCallGuarantee(()=>{this.updateCarouselControls()},100),this.updateCarouselControls())}).onceRendered(()=>{const e=this.getRef(this.refs.wordsCarousel);e&&(e.scrollLeft=0)}).onSet("twoColumnsRender",e=>{this.defaultExampleCount=e?16:10})}getLocalizations(){return{i18n:{...u.i18n,EXAMPLE_TABS:u.EXAMPLE_TABS}}}updateCarouselControls(){const e=this.getRef(this.refs.wordsCarousel);if(!e)return;const t=e.scrollWidth-e.clientWidth;this.setScrollControlVisibility(e.scrollLeft>0,"left"),this.setScrollControlVisibility(e.scrollLeft<t,"right")}setScrollControlVisibility(e,t="right"){const s=this.getRef(this.refs[t+"ScrollControl"]);s&&(s.style.display=e?"block":"none")}onRightScrollClick(){this.scrollWordsCarousel(this.scrollStep)}onLeftScrollClick(){this.scrollWordsCarousel(-this.scrollStep)}scrollWordsCarousel(e){const t=this.getRef(this.refs.wordsCarousel);t&&(o.default.smoothScrollTo(t,0,t.scrollLeft+e),this.emit(c.EXAMPLES_EVENTS.SEND_METRIC,c.EXAMPLE_METRIKAS.EXAMPLE_SCROLL_CONTROL_CLICK))}handleMouseOut(){const{hideTooltip:e}=this.getProps();e&&e()}getExampleTooltipCn(){const{cn:e}=this.getRenderHelpers();return e("exampleTooltip")}filterExamples(e){const{bannedExamples:t=[]}=this.getProps();return!t.includes(e.id)}renderWordsCarousel(){const{html:e,cn:t,nothing:s}=this.getRenderHelpers(),{exampleTabs:i,activeTabIndex:n}=this.getProps();if(!i.length)return s;const r=t("tabs"),o=t("tab"),l=t("button")({view:"clear",size:"l",icn:!0,round:!0}),{i18n:c}=this.getLocalizations(),d=(t,s,i)=>e`
            <div class=${r("control",{direction:t})} data-ref-id=${s}>
                <button tabindex="-1" class=${r("controlButton",[l])} @click=${i}>
                    ${(0,a.icn)("left"===t?"arrow-short-back":"arrow-short-forward")}
                </button>
                <div class=${r("controlShadow")}></div>
            </div>
        `;return e`
            <div class=${r({view:"primary"})}>
                <div class=${r("container")}
                     data-ref-id=${this.refs.wordsCarousel}>
                    ${d("left",this.refs.leftScrollControl,()=>this.onLeftScrollClick())}

                    <button
                        class=${o({type:"common",selected:this.isTabWithAllExamplesActive()})}
                        @click=${()=>this.setActiveTab(null)}
                        tabindex="0"
                        data-default-enter-action="true">
                        ${c.EXAMPLE_TABS.all}
                    </button>

                    ${i.map((t,i)=>t&&!t.translation.hide?e`
                        <button
                            class=${o({selected:i===n})}
                            @click=${()=>this.setActiveTab(i)}
                            tabindex="0"
                            data-default-enter-action="true">
                            ${this.getTabTranslation(t)}
                        </button>
                    `:s)}

                    ${d("right",this.refs.rightScrollControl,()=>this.onRightScrollClick())}
                </div>
            </div>
        `}renderTooltipContent(e){const{html:t}=this.getRenderHelpers();return t`
            <div class=${this.getExampleTooltipCn()("content")}>
                ${this.renderTooltipInfo(e)}
            </div>
        `}renderDefaultTooltipInfo(e){const{html:t}=this.getRenderHelpers();return t`
            <p class=${this.getExampleTooltipCn()("title",{size:"big"})}>
                ${l.DictionaryPresenter2.getTooltipMessage(e)}
            </p>
            `}renderITNewsTooltipInfo(e){const{html:t,nothing:s,cn:i}=this.getRenderHelpers(),n=i("button")({view:"primary",size:"m"}),r=this.getExampleTooltipCn();return t`
                <p class=${r("title")}>${e.ref}</p>
                <p class=${r("info",{spacing:"big"})}>
                    ${(0,a.icn)("expl-robot")}&nbsp;&mdash;&nbsp;${window.locales.labels.news}
                </p>
                ${e.refUrl?t`
                    <a class=${r("button",[n])} href=${e.refUrl} target="_blank">
                        ${u.i18n.exampleRefSourceLink}
                    </a>
                `:s}
            `}renderSitesTooltipInfo(e){const{html:t,nothing:s,cn:i}=this.getRenderHelpers(),n=i("button")({view:"primary",size:"m"}),r=this.getExampleTooltipCn();return t`
                <p class=${r("title")}>${u.i18n.exampleRefSiteTitle}&nbsp;${e.ref}</p>
                ${e.refUrl?t`
                        <a class=${r("button",[n])} href=${e.refUrl} target="_blank">
                            ${u.i18n.exampleRefSiteLink}
                        </a>
                        `:s}
                    `}renderIdiomTooltipInfo(){const{html:e}=this.getRenderHelpers();return e`
                <p class=${this.getExampleTooltipCn()("title",{size:"big"})}>
                    ${u.i18n.idiomExampleExplanation}
                </p>
                `}renderTooltipInfo(e){switch(!0){case e.isNews:case e.isIT:return this.renderITNewsTooltipInfo(e);case e.isSites:return this.renderSitesTooltipInfo(e);case e.isIdiom:return this.renderIdiomTooltipInfo();default:return this.renderDefaultTooltipInfo(e)}}renderExpExampleMetaContent(e){const{html:t}=this.getRenderHelpers(),{showTooltip:s}=this.getProps(),i=this.renderTooltipContent(e);return t`
            <div class="example_meta">
                <div class="example_ref_wrapper"
                    data-tracking-data='{"id": "example/ref"}'
                    tabindex="0"
                    aria-label="${i}"
                >
                    <div class="example_ref"
                        data-type="${e.refType}"
                        data-tooltip-id="${e.id}"
                        @mouseover=${()=>s({example:e,content:i})}
                        @mouseout=${()=>this.handleMouseOut()}
                    >
                        ${this.renderExampleIcon(e.refType)}
                    </div>
                </div>
            </div>
        `}renderDefaultExampleMetaContent(e){const{html:t}=this.getRenderHelpers(),s=l.DictionaryPresenter2.getTooltipMessage(e),i=e.refType;return t`
            <div class="example_meta">
                <div class="example_ref_wrapper"
                    data-tooltip-onclick="true"
                    data-tooltip-position="top-right"
                    data-tooltip="${s}"
                    data-tracking-data='{"id": "example/ref"}'
                    tabindex="0"
                    aria-label="${s}"
                >
                    <div
                        class="example_ref"
                        data-type="${i}"
                    >
                        ${this.renderExampleIcon(i)}
                    </div>
                </div>
            </div>
        `}renderExampleMeta(e){const{areNewExamplesEnabled:t}=this.getProps();return t?this.renderExpExampleMetaContent(e):this.renderDefaultExampleMetaContent(e)}renderExpIdiomContent(e){const{html:t}=this.getRenderHelpers(),{showTooltip:s}=this.getProps(),i=this.renderTooltipContent(e);return t`
            <div
                class="example_item example_item_type_${e.refType}"
                data-tracking-data='{"id": "example", "exampleId": "${e.id}"}'
                data-complaint-type="example"
                data-id="${e.id}"
                data-text="${e.originalVal}"
                data-translation="${e.originalTrs}">
                <div class="example_meta">
                    <div class="example_ref_wrapper"
                        data-tooltip-id="${e.id}"
                        @mouseover=${()=>s({example:e,content:i})}
                        @mouseout=${()=>this.handleMouseOut()}
                        tabindex="0"
                        aria-label="${i}"
                        >
                        ${this.renderExampleIcon("idiom")}
                    </div>
                </div>
                <div class="example_wrapper" tabindex="0">
                    <div class="example_source">
                        ${this.getIdiomTitle(e)}
                    </div>
                    <div class="example_target">
                        ${e.originalTrs}
                    </div>
                </div>
            </div>
      `}rendetDefaultIdiomContent(e){const{html:t}=this.getRenderHelpers(),{i18n:s}=this.getLocalizations();return t`
            <div
                class="example_item example_item_type_${e.refType}"
                data-tracking-data='{"id": "example", "exampleId": "${e.id}"}'
                data-complaint-type="example"
                data-id="${e.id}"
                data-text="${e.originalVal}"
                data-translation="${e.originalTrs}">
                <div class="example_meta">
                    <div class="example_ref_wrapper"
                         data-tooltip-onclick="true"
                         data-tooltip-position="top-right"
                         data-tooltip="${s.idiomExampleExplanation}"
                         tabindex="0"
                         aria-label="${s.idiomExampleExplanation}"
                         >
                        ${this.renderExampleIcon("idiom")}
                    </div>
                </div>
                <div class="example_wrapper" tabindex="0">
                    <div class="example_source">
                        ${this.getIdiomTitle(e)}
                    </div>
                    <div class="example_target">
                        ${e.originalTrs}
                    </div>
                </div>
            </div>
      `}renderIdiomExample(e){const{areNewExamplesEnabled:t}=this.getProps();return t?this.renderExpIdiomContent(e):this.rendetDefaultIdiomContent(e)}}t.ExamplesComponent=h,h.defaults={...i(n(h),"defaults",h),twoColumnsRender:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractExamplesComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(15),o=s(6),a=s(32),l=s(137);class c extends o.Component{constructor(...e){super(...e),this.refs={wordsCarousel:"examplesWordCarousel",leftScrollControl:"leftScrollControl",rightScrollControl:"rightScrollControl"},this.expandStep=24,this.defaultExampleCount=12}reset(){this.setVisible(!1).setProperty("currentExamples",[]).setProperty("allExamples",[]).setProperty("exampleTabs",[]).setProperty("currentMaxExamplesCount",this.defaultExampleCount).setProperty("activeTabIndex",null).setProperty("amountOfExpands",0).setProperty("ignoreNextEmptyResponse",!1)}resetWordCarouselScroll(){const e=this.getRef(this.refs.wordsCarousel);e&&e.scrollLeft&&setTimeout(()=>e.scrollLeft=0,100)}expandExamples(){this.emit(l.EXAMPLES_EVENTS.SEND_METRIC,l.EXAMPLE_METRIKAS.EXPAND_EXAMPLES,{amountOfExpands:this.amountOfExpands});const{currentMaxExamplesCount:e}=this.getProps();this.setProperty("currentMaxExamplesCount",e+this.expandStep).updateNow()}setActiveTab(e){const{exampleTabs:t,allExamples:s}=this.getProps(),i=!n.default.isNumber(e),r=i?s:t[e].examples,o=i?null:this.getTabTranslation(t[e]);this.setProperty("currentExamples",r).setProperty("activeTabIndex",e).setProperty("currentMaxExamplesCount",this.defaultExampleCount).setProperty("amountOfExpands",0).updateNow(),this.emit(l.EXAMPLES_EVENTS.SEND_METRIC,l.EXAMPLE_METRIKAS.TAB_WORD_CLICK,{value:o})}onHighlightedTextClick(e){const t=n.default.getClosest(e.target,e=>e.hasAttribute(a.VALUE_ATTR),!0);if(t){const s=t.getAttribute(a.VALUE_ATTR);this.emit(l.EXAMPLES_EVENTS.SEND_METRIC,l.EXAMPLE_METRIKAS.HIGHLIGHTED_CLICK,{value:s}),n.default.preventEvent(e),this.emit(l.EXAMPLES_EVENTS.WORD_SELECTED,s,t)}}onInfoClick(e,t){const s=e.target;s&&this.emit(l.EXAMPLES_EVENTS.OPEN_IDIOM_POPUP,s.getBoundingClientRect(),s.getAttribute("data-example-id"),t)}onLeftScrollClick(){}onRightScrollClick(){}handleCarouselScroll(){}getLocalizations(){return{}}getIdiomTitle(e){const{html:t,cn:s,nothing:i}=this.getRenderHelpers(),r=n.default.isArray(e.exampleVal)&&e.exampleVal[0]&&e.exampleVal[0].text;if(!r)return i;const{text:o}=this.getProps(),a=o.length,l=r.toLowerCase().indexOf(o.toLowerCase());if(-1===l)return r;const c=s("idiom"),d=r.slice(0,l),u=r.slice(l,l+a),h=r.slice(l+a);return t`${d}<span class="${c("highlighted")}">${u}</span>${h}`}filterExamples(e){return Boolean(e)}getExampleGroups(){const{currentExamples:e,twoColumnsRender:t,currentMaxExamplesCount:s}=this.getProps(),i=(e||[]).filter(e=>this.filterExamples(e)).slice(0,s);if(!t)return[i];const n=[],r=[];return i.forEach((e,t)=>{t%2?r.push(e):n.push(e)}),[n,r]}renderIdiomExample(e,t){return this.getRenderHelpers().nothing}renderExampleIcon(e){return(0,r.icn)("expl-"+e)}onRefMouseOver(e){const{onRefMouseOver:t}=this.getProps();t&&t(e)}onRefMouseOut(e){const{onRefMouseOut:t}=this.getProps();t&&t(e)}getTabTranslation(e){const{i18n:t}=this.getLocalizations();let s=e.translation.text;return e.translation.other?s=t.EXAMPLE_TABS.other:e.translation.idiom&&(s=t.EXAMPLE_TABS.idioms),s}isTabWithAllExamplesActive(){const{activeTabIndex:e}=this.getProps();return!n.default.isNumber(e)}renderWordsCarousel(){const{html:e,cn:t,nothing:s}=this.getRenderHelpers(),{exampleTabs:i,activeTabIndex:r}=this.getProps();if(!((i||[]).length>1))return s;const{i18n:o}=this.getLocalizations(),a=t("examples"),l=t("examples-category-word"),c=t("examples__carousel");return e`
            <div class=${a("words-list")}>
                <div
                    class="${c("control",{direction:"left"})}"
                    data-ref-id="${this.refs.leftScrollControl}"
                >
                    <div
                        class="${c("button")}"
                        @click=${()=>this.onLeftScrollClick()}
                    ></div>
                    <div class="${c("shadow")}"></div>
                </div>
                <div class="${c({type:"words"})} invisible-horizontal-scrollbar" data-ref-id="${this.refs.wordsCarousel}">
                    <span
                        class=${l({type:"source",selected:this.isTabWithAllExamplesActive()})}
                        @click=${n.default.debounce(()=>this.setActiveTab(null),100)}>
                        ${o.EXAMPLE_TABS.all}
                    </span>
                    ${i.map((t,i)=>t&&!t.translation.hide?e`
                        <span
                            class=${l({type:"target",selected:i===r})}
                            @click=${n.default.debounce(()=>this.setActiveTab(i),100)}>
                            ${this.getTabTranslation(t)}
                        </span>
                    `:s)}
                </div>
                <div
                    class="${c("control",{direction:"right"})}"
                    data-ref-id="${this.refs.rightScrollControl}"
                >
                    <div class="${c("shadow")}"></div>
                    <div
                        class="${c("button")}"
                        @click=${()=>this.onRightScrollClick()}
                    ></div>
                </div>
            </div>
        `}renderExampleMeta(e,t){const{html:s}=this.getRenderHelpers();return s`
            <div class="example_meta">
                <div class="example_ref_wrapper"
                     data-type="${e.refType}"
                     data-ref="${e.ref}"
                     data-message="${e.message}"
                     @mouseover=${e=>this.onRefMouseOver(e)}
                     @mouseout=${e=>this.onRefMouseOut(e)}>
                    <div class="example_ref"
                         data-type="${e.refType}"
                         data-message="${e.message}"
                         data-tracking-data='{"id": "example/ref"}'>
                        ${this.renderExampleIcon(e.refType)}
                    </div>
                </div>
                <div class="example_ref-info">
                    <div class="example_name">${e.ref}</div>
                    <div class=${t("author")}>${e.message}</div>
                </div>
            </div>
        `}renderExampleContent(e,t){const{html:s}=this.getRenderHelpers();return s`
            <div class="example_source">
                ${e.exampleVal&&e.exampleVal.map(({highlighted:e,text:i})=>e?s`
                        <span class=${t("highlighted")}>${i}</span>`:i)}
            </div>

            <div class="example_target">
                ${e.exampleTrs&&e.exampleTrs.map(({highlighted:e,text:i})=>e?s`
                        <span
                            @click=${e=>this.onHighlightedTextClick(e)}
                            data-value=${"tr:"+i}
                            data-active-target="true"
                            role="button"
                            tabindex="0"
                            area-label=${i}
                            class=${t("highlighted")}>${i}</span>`:i)}
            </div>
        `}renderExample(e){const{html:t,cn:s}=this.getRenderHelpers(),i=s("example");return t`
            <div
                class="example_item example_item_type_${e.refType}"
                data-tracking-data='{"id": "example", "exampleId": "${e.id}"}'
                data-complaint-type="example"
                data-complaint-target="true"
                data-id=${e.id}
                data-text=${e.originalVal}
                data-translation=${e.originalTrs}
            >
                ${this.renderExampleMeta(e,i)}
                <div class="example_wrapper" data-tracking-data='{"id": "example/src"}' tabindex="0">
                    ${this.renderExampleContent(e,i)}
                </div>
            </div>
        `}template({html:e,nothing:t,cn:s}){const{currentExamples:i,exampleTabs:n,currentMaxExamplesCount:r}=this.getProps(),o=(n||[]).length>1,a=(i||[]).length>r,l=s("block-separator"),c=s("button-items-expand"),d=s("block-label"),{i18n:u}=this.getLocalizations(),h=this.getExampleGroups();return e`
            <div class=${l()}></div>
            <h2 class=${d({target:"examples"})} tabindex="0">${u.examples}</h2>
            ${this.renderWordsCarousel()}
            <div class=${"example_list "+(o?"example_list_wordsCarousel":"")}>
                ${h.map(t=>e`
                    <div class="example_group">
                        ${t.map((e,t)=>e.isIdiom?this.renderIdiomExample(e,t):this.renderExample(e))}
                    </div>
                `)}
            </div>
            ${a?e`
                <div
                    class=${c()}
                    @click=${()=>this.expandExamples()}
                    tabindex="0"
                    data-default-enter-action="true"
                    role="button"
                >
                    ${u.expandExamples}
                </div>
            `:t}
        `}}t.AbstractExamplesComponent=c,c.defaults={currentExamples:[],allExamples:[],exampleTabs:[],currentMaxExamplesCount:12,activeTabIndex:null,amountOfExpands:0,ignoreNextEmptyResponse:!1,bannedExamples:[],twoColumnsRender:!1,onRefMouseOver:()=>{},onRefMouseOut:()=>{}}},function(e,t,s){"use strict";t.__esModule=!0,t.DefinitionModule=void 0;var i=s(285),n=s(286);class r extends i.AbstractDefinitionModule{constructor(e,t){super(e,t),this.app.onAction("enableCustomMode",()=>this.enableCustomMode()).onAction("disableCustomMode",()=>this.disableCustomMode())}enableCustomMode(){const{selTr:e,selText:t}=this.appModel.getProps(),s=t||e;this.definitionComponent.setProperty({selectedText:s},{silent:!0})}disableCustomMode(){this.definitionComponent.setProperty({selectedText:""},{silent:!0})}makeDefinitionComponent(){return new n.DefinitionComponent({onCardClick:e=>this.onCardClick(e)},{container:this.appConfig.ELEMENTS.definition,hideAfterTransition:!0,skipFadeoutTransition:!0})}}t.DefinitionModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDefinitionModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(3),a=s(134),l=s(193);const{$track:c}=(0,o.getTrackerByNamespace)(a.DEFINITION_METRIKAS);class d extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="definitions",this.definitionComponent=this.makeDefinitionComponent(),this.dictModel=this.app.getDictionaryModel(),this.definitionComponent.setEnabled(!0),this.meaningText="",this.cardType=null,this.listenDictModel(),this.listenAppModel(),this.listenApp()}reset(){this.definitionComponent.setProperty({def:null,abbreviations:[],activeAbbrIndex:0,text:"",selectedText:""}).setVisible(!1).updateAsync()}onCardClick(e){this.app.isComplaintModeEnabled()&&(this.meaningText=e)}listenApp(){this.app.on("translationError",()=>this.reset()).onComplaintSend(()=>{const e=this.app.getComplaintTarget(),t="abbreviation"===n.default.getAttribute(e,"data-complaint-type"),s=this.app.getComplaintCommentInput().getView();t&&o.$tracker.sendMetric("definition_complaint_send",{text:this.meaningText,src:this.appModel.getProperty("text"),comment:s.getValue(),lang:this.app.getLangsPair(),type:this.cardType})})}listenDictModel(){this.dictModel.on(a.DEFINITION_EVENTS.DEF_FETCHED,({definition:e,abbreviations:t})=>{const{hasDefinition:s,hasAbbreviations:i,hasDefinitionOrAbbreviations:n}=(0,l.getDefinitionAndAbbreviationsInfo)({definition:e,abbreviations:t});let r=this.definitionComponent.getProperty("selectedText");r||(r=e?e.origText:this.appModel.getProperty("trText")),this.definitionComponent.setProperty({def:e,abbreviations:t,activeAbbrIndex:0,text:r}).updateAsync().setVisible(n),s&&(this.cardType="definition",c(a.DEFINITION_METRIKAS.DEF_RENDERED)),i&&(this.cardType="abbreviation",c(a.DEFINITION_METRIKAS.ABBR_RENDERED))}).onChange(n.default.debounce(()=>{this.dictModel.isValid()||this.reset()}))}listenAppModel(){this.appModel.onChange("text",e=>{e||this.reset()})}makeDefinitionComponent(){return{}}}t.AbstractDefinitionModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.DefinitionComponent=void 0;var i=s(15),n=s(287),r=s(193),o=s(3),a=s(134),l=s(164);class c extends n.AbstractDefinitionComponent{getLocalizations(){return{i18n:l.i18n}}switchAbbreviation(e){const{abbreviations:t,activeAbbrIndex:s,text:i}=this.getProps(),n=t.length;if(!n)return;let r=s+e;-1===e&&0===s?r=n-1:1===e&&s===n-1&&(r=0),o.$tracker.sendMetric(a.DEFINITION_METRIKAS.ABBR_SWITCHED,{text:i,prev:t[s].abbrText,current:t[r].abbrText}),this.setProperty("activeAbbrIndex",r).updateAsync()}trackSourceLinkClick(e,t,s){o.$tracker.sendMetric(a.DEFINITION_METRIKAS.DEFINITION_SOURCE_CLICK,{type:e?a.DEFINITION_TYPES.ABBR:a.DEFINITION_TYPES.WIKI,text:t,source:s})}template({html:e,cn:t,nothing:s}){const{def:n,abbreviations:o,activeAbbrIndex:a,text:l,onCardClick:c}=this.getProps(),{hasAbbreviations:d,hasDefinitionOrAbbreviations:u}=(0,r.getDefinitionAndAbbreviationsInfo)({definition:n,abbreviations:o});if(!u)return s;const h=t("definition"),p=t("button")({view:"clear",size:"m",icn:!0,round:!0}),g=d&&o.length>1,E=d?o[a]:n,{i18n:_}=this.getLocalizations(),T=E.isAbbreviation?`${l.toUpperCase()} â€” ${E.abbrText}`:l,m=E.textVal.reduce((e,{text:t})=>e+t,""),f=Boolean(E.imgUrl),S=_[E.isAbbreviation?"definitionAbbrLabel":"definitionLabel"],C=E.sourceUrl?e`
            <a class="${h("sourceLink")}"
               href=${E.sourceUrl}
               @click=${()=>this.trackSourceLinkClick(d,l,E.sourceUrl)}
               rel="nofollow"
               target="_blank">
                ${_.definitionSourceWiki}
            </a>
        `:_.definitionSourceRobot,A=g?e`
            <div class="${h("switcher")}">
                <button class="${p}" @click=${()=>this.switchAbbreviation(-1)}>
                    ${(0,i.icn)("arrow-left",16)}
                </button>

                <span class="${h("switcherCurrentDefinition")}">${a+1} / ${o.length}</span>

                <button class="${p}" @click=${()=>this.switchAbbreviation(1)}>
                    ${(0,i.icn)("arrow-right",16)}
                </button>
            </div>
        `:s;return e`
            <div class="${h()}">
                ${A}
                <div
                    class=${h("card")}
                    data-title="${m}"
                    data-complaint-type="abbreviation"
                    data-complaint-target="true"
                    @click=${()=>c(m)}
                >
                    ${f?e`
                        <a
                            class=${h("img")}
                            style="background-image: url('${E.imgUrl}')"
                            href=${E.origUrl}
                            rel="nofollow"
                            target="_blank"></a>
                    `:s}
                    <div class=${h("content",{"has-img":f})}>
                        <p class=${h("label")}>${S}</p>
                        <p class=${h("text")}>${T}</p>
                        <p class=${h("source")}>${C}</p>
                        <p class=${h("meaning")}>${m}</p>
                    </div>
                </div>
            </div>
        `}}t.DefinitionComponent=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDefinitionComponent=void 0;var i=s(6);class n extends i.Component{getLocalizations(){return{}}}t.AbstractDefinitionComponent=n,n.defaults={def:null,abbreviations:[],activeAbbrIndex:0,text:"",selectedText:""}},function(e,t,s){"use strict";t.__esModule=!0,t.DeclensionsModule=void 0;var i=s(289),n=s(290);class r extends i.AbstractDeclensionsModule{constructor(e,t){super(e,t),this.listenAppView(),this.listenAppModel()}listenAppView(){this.appView.onStateChanged("select",e=>{this.ignoreDict=e})}listenAppModel(){this.appModel.onChange("text",e=>{e||this.reset()})}makeDeclensionsComponent(){return new n.DeclensionsComponent({},{container:this.appConfig.ELEMENTS.declensions,hideAfterTransition:!0,skipFadeoutTransition:!0})}parseDeclensionTable(e,t=[]){return t.map(e=>({title:e[0],values:e.slice(1)}))}}t.DeclensionsModule=r},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDeclensionsModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(3),a=s(70),l=s(138);class c extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="declensions",this.declensionsComponent=this.makeDeclensionsComponent(),this.declensionsComponent.setEnabled(!0),this.listenApp(),this.listenDictModel(),this.listenDeclensionsComponent()}reset(){this.declensionsComponent.setVisible(!1).setProperty("declensions",[]).setProperty("activeTabIndexes",[]).updateAsync()}parseDeclensionsData(e){const t=[];return e.forEach(e=>{e.data&&e.data.forEach(({tables:s})=>{s&&s.forEach(({headers:s,rows:i})=>{t.push({word:e.text,ts:e.ts,headers:s?s.slice(1):[],partOfSpeech:e.partOfSpeech,wordDeclensions:this.parseDeclensionTable(s,i)})})})}),t}parseDeclensionTable(e,t){if(!e)return(t||[]).map(e=>({title:e[0],value:e[1]}));const s=[];for(let i=1;i<e.length;i+=1){const n=e[i];for(const e of t)s.push({title:`${n}, ${e[0]}`,value:e[i]})}return s}handleFetchedDeclensions(e){const t=e.length,s=t>0,i=e.map(({partOfSpeech:e})=>e===a.POS.VERB?1:0);s&&(o.$tracker.sendMetric(l.DECLENSIONS_METRIKAS.RENDER,{src:this.appModel.getProperty("text"),items:[t]}),this.app.emit(l.DECLENSIONS_METRIKAS.RENDER)),this.declensionsComponent.setProperty({declensions:e,activeTabIndexes:i}).updateAsync().setVisible(s)}listenApp(){this.app.on("translationError",()=>this.reset()).onComplaintSend(()=>{const e=this.app.getComplaintTarget(),t="declensions"===n.default.getAttribute(e,"data-complaint-type"),s=this.app.getComplaintCommentInput().getView();t&&o.$tracker.sendMetric("declensions_complaint_send",{src:this.appModel.getProperty("text"),comment:s.getValue(),lang:this.app.getLangsPair(),dir:this.app.getLangsPair(),wordValue:n.default.getDataAttr(e,"value"),partOfSpeech:n.default.getDataAttr(e,"part-of-speech")})})}listenDictModel(){this.app.getDictionaryModel().on(l.DECLENSIONS_EVENTS.DECLENSIONS_FETCHED,e=>this.handleFetchedDeclensions(e)).onInvalid(()=>this.reset())}listenDeclensionsComponent(){this.declensionsComponent.on(l.DECLENSIONS_EVENTS.WORD_CLICK,({wordValue:e})=>{this.appView.hasState("complaint")||this.appModel.setProperty("text",e,{type:"mean",sender:"declensions"})})}makeDeclensionsComponent(){return{}}}t.AbstractDeclensionsModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.DeclensionsComponent=void 0;var i=s(15),n=s(291),r=s(3),o=s(26),a=s(138);const{$track:l}=(0,r.getTrackerByNamespace)(a.DECLENSIONS_METRIKAS);class c extends n.AbstractDeclensionsComponent{onExpandClick(){this.setProperty("expanded",!0).updateAsync(),l(a.DECLENSIONS_METRIKAS.EXPAND)}getExpandButton(){const{html:e,nothing:t,cn:s}=this.getRenderHelpers(),{expanded:i}=this.getProps(),n=s("button-items-expand");return i?t:e`
            <div
                 class="${n()}"
                 @click=${()=>this.onExpandClick()}
            >${o.desktopLocales.labels.expandDictionary}</div>`}getDeclensionRow(e,t,s){const{html:i,cn:n}=this.getRenderHelpers(),r=n("declensions");return i`
            <div class="${r("row")}">
                <div class="${r("title")}">${e}</div>

                ${t.map(e=>i`
                    <div class="${r("value")}">
                        <a data-value="${e}"
                           data-part-of-speech="${s}"
                           data-complaint-type="declensions"
                           data-complaint-target="true"
                           data-default-enter-action="true"
                           tabindex="0"
                           @click=${e=>this.onDeclensionWordClick(e)}>${e}</a>
                    </div>
                `)}
            </div>
        `}switchAbbreviation(e){const{declensions:t,activeCardIndex:s}=this.getProps(),i=t.length;if(!i)return;let n=s+e;-1===e&&0===s?n=i-1:1===e&&s===i-1&&(n=0);const r=this.getRef(this.refs.list);r.scrollLeft=Math.abs(n*r.querySelector(".declension").offsetWidth*e)}renderHeader({shouldRenderSwitcher:e}){const{activeCardIndex:t,declensions:s}=this.getProps(),{html:n,cn:r,nothing:o}=this.getRenderHelpers(),a=r("declensionHeader"),l=r("button")({view:"clear",size:"m",icn:!0,round:!0}),c=e?n`
            <div class="${a("switcher")}">
                <button class="${l}" @click=${()=>this.switchAbbreviation(-1)}>
                    ${(0,i.icn)("arrow-left",16)}
                </button>

                <span class="${a("switcherCurrentDefinition")}">
                    <span class="${a("current")}">${t+1}</span>
                    <span>&nbsp;/&nbsp;</span>
                    <span class="${a("total")}">${s.length}</span>
                </span>

                <button class="${l}" @click=${()=>this.switchAbbreviation(1)}>
                    ${(0,i.icn)("arrow-right",16)}
                </button>
            </div>`:o;return n`<div class=${a()}>
            <div class=${a("title")}></div>
            ${c}
        </div>`}}t.DeclensionsComponent=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractDeclensionsComponent=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(6),o=s(70),a=s(30),l=s(3),c=s(138);class d extends r.Component{constructor(...e){super(...e),this.refs={list:"list"}}onDeclensionWordClick(e){const t=e.target.getAttribute("data-value"),s=e.target.getAttribute("data-part-of-speech");l.$tracker.sendMetric(c.DECLENSIONS_METRIKAS.CLICK,{wordValue:t,wordPartOfSpeech:s}),this.emit(c.DECLENSIONS_EVENTS.WORD_CLICK,{wordValue:t})}onTabClick({declensionIndex:e,activeTabIndex:t,text:s,header:i}){const{activeTabIndexes:n}=this.getProps();l.$tracker.sendMetric(c.DECLENSIONS_METRIKAS.TAB_CLICK,{src:s,tab:i}),n[e]!==t&&(n[e]=t,this.setProperty({activeTabIndexes:n}).updateAsync())}renderTimeline({ticks:e=[],highlight:t}){const{html:s,cn:i,nothing:n}=this.getRenderHelpers(),r=i("declensionTimeline");return s`<div class="${r()}">
            <div class="${r("axis")}"></div>
            <div class="${r("arrow")}"></div>
            ${e.map(({text:e,left:t})=>s`
                <div class="${r("tick")}" style="left: ${t};"></div>
                <div class="${r("text")}" style="left: ${t};">${e}</div>
            `)}
            ${t?s`<div class="${r("highlight")}" style="left: ${t.left}; width: ${t.width};"></div>`:n}
        </div>`}renderTablesInActiveTab({tables:e,partOfSpeech:t,isEnglish:s}){const{html:i,cn:n,nothing:r}=this.getRenderHelpers(),a=n("declension"),l=n("declensionTable"),c=s&&t===o.POS.ADJECTIVE;return i`<ul class="${a("tables")}">${e.map(({header:e,comment:n,cells:a,timeline:d})=>{const u={isEnglish:s},h=!s&&t===o.POS.VERB&&a.length>1,p={comparativeAdjective:c,hasManyVerbs:h};return i`<li class="${l("",{withoutHeader:!e})}">
                ${e?i`<p class="${l("header")}">${e}</p>`:r}
                ${n?i`<p class="${l("comment",u)}">${n}</p>`:r}
                <ul class="${l("cells",p)}">${a.map(({value:e,comment:s})=>{const n={};return!h&&!c&&a.length>1&&(n.multiple=!0),i`<li class="${l("cell",n)}">
                        <p class="${l("cellValue")}">
                            ${e.optional?i`<span class="${l("cellValueOptional")}">${e.optional}</span>`:r}
                            <span
                                class="${l("cellValueMain")}"
                                data-value="${e.main}"
                                data-part-of-speech="${t}"
                                data-complaint-type="declensions"
                                @click=${e=>this.onDeclensionWordClick(e)}
                            >${e.main}</span>
                        </p>
                        ${s?i`<p class="${l("cellComment")}">${s}</p>`:r}
                    </li>`})}
                </ul>
                ${d?this.renderTimeline(d):r}
            </li>`})}</ul>`}renderTabs({text:e,declensionIndex:t,activeTabIndex:s,tabs:i}){const{html:n,cn:r,nothing:o}=this.getRenderHelpers();if(!i)return o;if(i.length<2)return o;const a=r("declension");return n`<ul class="${a("tabs")}">${i.map(({header:i},r)=>n`
            <li class="${a("tab",{active:r===s})}"
                @click=${()=>this.onTabClick({declensionIndex:t,activeTabIndex:r,text:e,header:i})}>${i}</li>
        `)}</ul>`}renderHeader(){const{nothing:e}=this.getRenderHelpers();return e}onListScroll(){const{declensions:e,activeCardIndex:t}=this.getProps(),s=this.getRef(this.refs.list),i=s.querySelector(".declension"),n=Math.floor(s.scrollLeft/i.offsetWidth),r=e[t],o=e[n];r&&o&&l.$tracker.sendMetric(c.DECLENSIONS_METRIKAS.LIST_SCROLL,{prev:{text:r.text,partOfSpeech:r.partOfSpeech},current:{text:o.text,partOfSpeech:o.partOfSpeech}}),this.setProperty("activeCardIndex",n).updateAsync()}template({html:e,cn:t}){const{declensions:s,activeTabIndexes:i}=this.getProps(),r=t("scrollableCards"),o=t("scrollableCard"),l=t("declensions"),c=t("declension"),d=s.length>1;return e`
            ${this.renderHeader({shouldRenderSwitcher:s.length>1})}
            <ul class="${l()} ${r("",{multiple:d})}" data-ref-id="${this.refs.list}" @scroll=${n.default.debounce(this.onListScroll.bind(this),50)}>
                ${s.map(({isEnglish:t,text:s,partOfSpeech:n,tabs:r},l)=>{const d=a.locales.declensions.labels[t?n:n+"_forms"];return e`<li class="${c()} ${o()}">
                        <p class="${c("label")}">${d}</p>
                        ${this.renderTabs({text:s,declensionIndex:l,activeTabIndex:i[l],tabs:r})}
                        ${this.renderTablesInActiveTab({tables:r[i[l]].tables,isEnglish:t,partOfSpeech:n})}
                    </li>`})}
            </ul>
        `}}t.AbstractDeclensionsComponent=d,d.defaults={declensions:[],activeCardIndex:0,activeTabIndexes:[],expanded:!0}},function(e,t,s){"use strict";t.__esModule=!0,t.RelatedContentWithMiniNavModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(147),a=s(149),l=s(134),c=s(3),d=(s(138),s(137),s(16)),u=s(2),h=s(293);class p extends r.AppModule{constructor(e,t){super(e,t),this.relatedContentView=new d.View({element:this.appConfig.ELEMENTS.relatedContent}),this.miniNavView=new u.TouchView({element:this.appConfig.ELEMENTS.miniNav,hideAfterTransition:!0}),this.miniNavItemsView=new d.View({element:this.appConfig.ELEMENTS.miniNavItems}),this.relatedHeaderView=new u.TouchView({element:this.appConfig.ELEMENTS.dictionaryHeader}),this.hasDict=!1,this.hasRelatedWords=!1,this.hasDefinition=!1,this.hasDeclesions=!1,this.hasExamples=!1,this.savedViewportWidth=window.innerWidth,this.isMiniNavShrunk=!1,this.listenApp(),this.listenAppModel(),this.listenDictModel(),this.listenComponents(),this.listenMiniNav(),this.listenScroll()}reset(){this.hasDict=!1,this.hasRelatedWords=!1,this.hasDefinition=!1,this.hasDeclesions=!1,this.hasExamples=!1,this.isMiniNavShrunk=!1,this.hideMiniNav()}handleStateChange(){this.canShowMiniNav()?this.showMiniNav():this.hideMiniNav();const e=!(this.hasRelatedWords||this.hasDict||this.hasDeclesions);this.appView.setState({rightEmpty:e&&!this.appConfig.ENABLE_SEO_SSR})}listenAppModel(){this.appModel.onChange(["text","srcLang","dstLang"],n.default.debounce(()=>{this.relatedHeaderView.isVisible()&&this.app.emit("action:disableCustomMode")}))}listenApp(){this.app.on("resize",()=>{this.handleResize()}).onAction("enableCustomMode",()=>{const{selTr:e,selText:t}=this.appModel.getProps(),s=e||t;this.relatedHeaderView.setTextContent(`${this.appConfig.LOCALIZATIONS.disableCustomMode} ${s}`).setVisible(!0)}).onAction("disableCustomMode",()=>this.relatedHeaderView.setVisible(!1))}listenComponents(){return!1}listenDictModel(){this.app.getDictionaryModel().on(a.DICTIONARY_EVENTS.DICT_FETCHED,e=>{this.hasDict=e&&e.length,this.handleStateChange()}).on(o.RELATED_WORDS_EVENTS.WORDS_FETCHED,({visible:e})=>{this.hasRelatedWords=e,this.handleStateChange()}).on(l.DEFINITION_EVENTS.DEF_FETCHED,({definition:e})=>{this.hasDefinition=Boolean(e),this.handleStateChange()}).onChange(["srcLang","dstLang","text"],n.default.debounce(()=>this.reset()))}listenMiniNav(){this.miniNavView.onTap(e=>{const t=n.default.getDataAttr(e.target,"mini-nav-target"),s=n.default.getDataAttr(e.target,"mini-nav-scroll");if(t)return this.scrollToMiniNavTarget(t),void this.trackMiniNavItemClick(t);s&&(this.scrollMiniNav("left"===s?-200:200),this.trackMiniNavControlClick(s))}).on("mouseover",()=>{this.isMiniNavShrunk&&this.growMiniNav()}).bindDOMEvents("mouseover"),this.miniNavItemsView.on("scroll",n.default.throttleWithCallGuarantee(()=>{this.updateMiniNavControls()},100)).bindDOMEvents("scroll")}listenScroll(){window.addEventListener("scroll",n.default.throttleWithCallGuarantee(()=>{this.isMiniNavVisible()&&(this.isMiniNavShrunk?0===document.documentElement.scrollTop&&this.growMiniNav():this.shrinkMiniNav())},500))}handleResize(){const e=window.innerWidth;e!==this.savedViewportWidth&&(this.savedViewportWidth=e,this.updateMiniNavWidth(),this.updateMiniNavControls())}setMiniNavControlVisibility({elem:e,isVisible:t}){e.style.display=t?"flex":"none"}scrollMiniNav(e){const t=this.appConfig.ELEMENTS.miniNavItems;n.default.smoothScrollTo(t,0,t.scrollLeft+e)}updateMiniNavControls(){const e=this.appConfig.ELEMENTS.miniNavItems,t=e.scrollWidth-e.clientWidth;this.setMiniNavControlVisibility({elem:this.appConfig.ELEMENTS.miniNavControlLeft,isVisible:e.scrollLeft>0}),this.setMiniNavControlVisibility({elem:this.appConfig.ELEMENTS.miniNavControlRight,isVisible:e.scrollLeft<t})}updateMiniNavWidth(){const e={maxWidth:this.calcMiniNavWidth()+"px"};this.miniNavView.setStyle(e)}scrollToMiniNavTarget(e){const t=this.appConfig.ELEMENTS[e];if(t){const e=this.appConfig.ELEMENTS.header,s=t.offsetTop-e.clientHeight;n.default.smoothScrollTo(document.documentElement,s)}}isMiniNavVisible(){return this.miniNavView.isVisible()}hideMiniNav(){this.miniNavView.setVisible(!1)}showMiniNav(){this.growMiniNav(),this.updateMiniNavWidth(),this.miniNavView.setVisible(!0),this.updateMiniNavControls()}shrinkMiniNav(){this.miniNavView.setState("shrunk",!0),this.isMiniNavShrunk=!0}growMiniNav(){this.miniNavView.setState("shrunk",!1),this.isMiniNavShrunk=!1}canShowMiniNav(){return this.hasDict&&this.hasRelatedWords&&this.hasDeclesions&&this.hasExamples}calcMiniNavWidth(){const{width:e}=this.appConfig.ELEMENTS.miniNavMeasurer.getBoundingClientRect();return e}trackMiniNavItemClick(e){c.$tracker.sendMetric(h.MINI_NAV_METRIKAS.ITEM_CLICK,{src:this.appModel.getProperty("text"),target:e})}trackMiniNavControlClick(e){c.$tracker.sendMetric(h.MINI_NAV_METRIKAS.CONTROL_CLICK,{src:this.appModel.getProperty("text"),direction:e})}}t.RelatedContentWithMiniNavModule=p},function(e,t,s){"use strict";t.__esModule=!0,t.MINI_NAV_METRIKAS=void 0,t.MINI_NAV_METRIKAS={ITEM_CLICK:"mini_nav_item_click",CONTROL_CLICK:"mini_nav_control_click"}},function(e,t,s){"use strict";t.__esModule=!0,t.IdiomDefinitionModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(3),a=s(148),l=s(134),c=s(295);class d extends r.AppModule{constructor(e,t){super(e,t),this.idiomComponent=new c.IdiomDefinitionComponent({},{container:this.appConfig.ELEMENTS.idiomDefinition,hideAfterTransition:!0,skipFadeoutTransition:!0}),this.listenApp(),this.listenAppModel(),this.listenDictionaryModel()}reset(){this.idiomComponent.setProperty({idiom:null}).setVisible(!1)}listenDictionaryModel(){this.app.getDictionaryModel().on(a.IDIOMS_EVENTS.IDIOM_FETCHED,e=>{e?(this.idiomComponent.setProperty({idiom:e}).setVisible(!0),o.$tracker.sendMetric("idioms_rendered",{idiomText:e.definition,src:this.appModel.getProperty("text")}),o.$tracker.sendMetric(l.DEFINITION_METRIKAS.DEFINITION_RENDERED,{text:e.definition,type:l.DEFINITION_TYPES.IDIOM})):this.reset()})}listenApp(){this.app.on("translationError",()=>this.reset()).onComplaintSend(()=>{const e=this.app.getComplaintTarget(),t="idiom"===n.default.getAttribute(e,"data-complaint-type"),s=this.app.getComplaintCommentInput().getView();t&&o.$tracker.sendMetric("idioms_complaint_send",{idiomsText:this.idiomComponent.getProperty("text"),src:this.appModel.getProperty("text"),comment:s.getValue(),lang:this.app.getLangsPair()})})}listenAppModel(){this.appModel.onChange(["trText","srcLang","dstLang"],()=>this.reset())}}t.IdiomDefinitionModule=d},function(e,t,s){"use strict";t.__esModule=!0,t.IdiomDefinitionComponent=void 0;var i,n=s(6),r=(i=s(0))&&i.__esModule?i:{default:i},o=s(164);class a extends n.Component{constructor(e,t){super(e,t),this.onChange(()=>this.update())}template({html:e,cn:t,nothing:s}){const{idiom:i}=this.getProps(),n=t("definition");return r.default.isEmpty(i)?s:e`
             <div class="${n()}">
                <div class=${n("card")}>
                    <div class=${n("content")}>
                        <p class=${n("label")}>${o.i18n.definitionIdiomLabel}</p>
                        <p class=${n("text")}>${i.text}</p>
                        <p class=${n("source")}>${o.i18n.definitionSourceRobot}</p>
                        <p
                            class=${n("meaning")}
                            data-prevent-focus="true"
                            data-complaint-type="idiom"
                            data-complaint-target="true"
                            data-title="${i.definition}">
                                ${i.definition}
                        </p>
                    </div>
                </div>
            </div>
        `}}t.IdiomDefinitionComponent=a,a.defaults={idiom:null}},function(e,t,s){"use strict";t.__esModule=!0,t.FileDropModule=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(144);class o extends r.FileDropModule{constructor(e,t){super(e,t),this.dropOverlay.on("formatError",()=>{this.appModel.setProperty("toast",n.default.parseString(this.appConfig.TOAST_MESSAGES.unsupportedFormat,this.appConfig.ALLOWED_FORMATS))}).on("sizeError",()=>{this.appModel.setProperty("toast",n.default.parseString(this.appConfig.TOAST_MESSAGES.maxSize,this.appConfig.MAX_FILE_SIZE_MB))})}}t.FileDropModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.StoriesModule=t.APP_EVENTS=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(11),o=s(298),a=s(143),l=s(299);t.APP_EVENTS={};class c extends o.AbstractStoriesModule{constructor(e,t){super(e,t),this.appConfig.DISABLE_STORIES_VIEWER&&this.$collapseEmojiStory(),this.listenAppView()}makeViewer(){return new l.StoriesViewer({stories:this.appConfig.stories},{container:document.getElementById("storiesViewer"),hideAfterTransition:!0})}handleActionOcr(e){this.redirectToAction("/ocr?"+n.default.toQueryString({ocr_image_url:e}))}handleActionUrl(e){this.redirectToAction("/translate?"+n.default.toQueryString({url:e}))}redirectToAction(e){window.open(e,"_blank")}listenAppView(){this.appView.on("keydown",({keyCode:e})=>{if(this.viewer.isVisible())switch(e){case r.KEYBOARD_KEYS.RIGHT:this.viewer.updateActiveCard(1,a.STORY_MOVE_TYPES.KEYBOARD);break;case r.KEYBOARD_KEYS.LEFT:this.viewer.updateActiveCard(-1,a.STORY_MOVE_TYPES.KEYBOARD);break;case r.KEYBOARD_KEYS.ESCAPE:this.viewer.closeViewer(a.STORY_CLOSE_TYPES.ESC)}})}}t.StoriesModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractStoriesModule=t.APP_EVENTS=void 0;var i=s(10),n=s(5),r=s(3),o=s(153),a=s(143);t.APP_EVENTS={};class l extends n.AppModule{constructor(e,t){super(e,t),this.moduleName="stories",this.appConfig.COLLAPSE_EMOJI_STORY&&this.$collapseEmojiStory(),this.viewer=this.makeViewer(),(0,i.getGlobalEmitter)().on(o.STORY_GLOBAL_EVENTS.RUN_ACTION,e=>this.handleStoryAction(e)),this.listenApp()}$collapseEmojiStory(){this.appConfig.stories.forEach(e=>{if("emoji"===e.type&&2===e.stories.length){const t=e.stories.pop();e.stories[0].controls=t.controls}})}handleActionEmoji(e){this.appModel.setProperty({srcLang:"emj",dstLang:this.appConfig.UI_LANG,text:e},{sender:"story"})}handleActionOcr(e){}handleActionUrl(e){}handleStoryAction(e){this.viewer.closeViewer(a.STORY_CLOSE_TYPES.ACTIVATION);const t=e.stories[e.stories.length-1].controls;switch(r.$tracker.sendMetric("stories_activate",{action:t.type,story:e.id}),t.type){case"emoji":this.handleActionEmoji(t.meta.text);break;case"ocr":this.handleActionOcr(t.meta.imageUrl);break;case"url":this.handleActionUrl(t.meta.url)}}openStory(e){if(this.appConfig.DISABLE_STORIES_VIEWER)return this.handleStoryAction(e);this.viewer.setActive(this.appConfig.stories.indexOf(e)).setVisible(!0)}listenApp(){this.app.on("stories:open",e=>this.openStory(e))}}t.AbstractStoriesModule=l},function(e,t,s){"use strict";t.__esModule=!0,t.StoriesViewer=void 0;var i=s(300),n=s(301),r=s(153),o=s(15),a=s(143);class l extends n.AbstractStoriesViewer{template({html:e,cn:t,nothing:s}){const{stories:l,active:c,prevActive:d,storyCardIndex:u}=this.getProps(),h=l[c],p=l.slice(0,c),g=l.slice(c+1),E=p.length>0,_=g.length>0,T=t("storiesViewer"),m=t("storyPreview"),f=t("button")({size:"l",view:"clear",round:!0,icn:!0}),S=f+" button_close",C=(e,t)=>this.getStoryCard(e).getDirective({view:r.STORY_CARD_VIEWS.STORY,storyIndex:0,clickHandler:t}),A=t=>{const s=l.indexOf(t);return e`
                <div class=${m({prevActive:d===s})}>
                    ${C(t,e=>{e.stopPropagation(),this.setActive(s,!0)})}
                </div>
            `};return e`
            <div class=${T("prev")}>
                ${(0,i.repeat)(p,e=>e.id,A)}
            </div>

            <div class=${T("active")}
                 @click=${e=>e.stopPropagation()}
                 data-ref-id=${this.refs.activeStory}
                 data-move-dir=${n.moveDirs.center}>
                <div class=${T("controls",{left:!0})}>
                    ${E?e`
                        <button
                            @click=${()=>this.updateActiveCard(-1,a.STORY_MOVE_TYPES.ARROW_TAP)}
                            class=${f}>${(0,o.icn)("arrow-short-back")}</button>
                    `:s}
                </div>

                ${this.storyCardTemplate(h,u,T)}

                <div class=${T("controls",{right:!0})}>
                    <button
                        @click=${()=>this.closeViewer(a.STORY_CLOSE_TYPES.BUTTON_TAP)}
                        class=${S}>${(0,o.icn)("clear")}</button>
                    ${_?e`
                        <button
                            @click=${()=>this.updateActiveCard(1,a.STORY_MOVE_TYPES.ARROW_TAP)}
                            class=${f}>${(0,o.icn)("arrow-short-forward")}</button>
                    `:s}
                </div>
            </div>

            <div class=${T("next")}>
                ${(0,i.repeat)(g,e=>e.id,A)}
            </div>
        `}}t.StoriesViewer=l},function(e,t,s){},function(e,t,s){"use strict";t.__esModule=!0,t.moveDirs=t.AbstractStoriesViewer=void 0,s(10);var i=s(6);s(153),s(3),s(143);const n={left:"left",right:"right",center:"center",self:"self"};t.moveDirs=n;class r extends i.Component{constructor(e,t){super(e,t),this.progressTs=null,this.progressTotalMs=0,this.progressPaused=!1,this.nextCardTimeout=null,this.refs={activeStory:"activeStory",activeProgress:"activeProgress"},this.onRendered(()=>!1),this.on("click",()=>!1)}getActiveStory(){return!1}runMoveAnimation(){return!1}resetMoveAnimation(){return!1}updateStoryMoveDir(e){return!1}resetProgress(){return!1}runProgressTimer(e){return!1}resetVisualProgress(){return!1}runActiveStoryAction(){return!1}setActive(e,t=!1){return!1}updateActiveCard(e,t){return!1}updateActiveStory(e,t){return!1}closeViewer(e){return!1}toggleProgressState(e){return!1}handleMouseleave(){return!1}getStoryCard(e){return!1}getStoryDirective(e,t){return!1}progressTemplate(e,t){return!1}storyCardTemplate(e,t,s,i=null){return!1}}t.AbstractStoriesViewer=r,r.defaults={stories:[],active:0,prevActive:null,storyCardIndex:0,storyChanged:!1,storyDuration:4e3}},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerModule=void 0;var i=s(11),n=s(303),r=s(307),o=s(310);class a extends n.AbstractSpellerModule{listenTextArea(){super.listenTextArea(),this.textareaView.onTap(e=>{e.target===this.textareaView.getContentElement()&&setTimeout(()=>{const e=this.textareaPresenter.getCaret();this.spellerComponent.onChunkClick(e)},100)})}listenAppView(){const e=this.textareaView.getContentElement();this.appView.onTap(t=>{if(this.$elements.spellerDialog){const s=e.contains(t.target),i=this.$elements.spellerDialog.contains(t.target);s||i||this.closeSpellerDialog()}}).on("keydown",({keyCode:e})=>{this.spellerDialog.isVisible()&&e===i.KEYBOARD_KEYS.ESCAPE&&this.closeSpellerDialog()}).onStateChanged("select",e=>{e&&this.closeSpellerDialog()})}handleChunkSelection(e,t,s){super.handleChunkSelection(e,t,s);const i=e.misspellValue||e.value;this.spellerDialog.setAutoCorrectedMode(e.autoCorrected).setErroneousValue(i).handlePosition(s)}makeSpellerDialog(){return new o.SpellerDialog({},{container:this.$elements.spellerDialog,hideAfterTransition:!0})}makeSpellerComponent(){return new r.SpellerComponent({isWordNonCorrectable:e=>this.spellerStorage.containsWord(e,this.spellerModel.getProperty("lang"))},{container:this.$elements.speller})}}t.SpellerModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractSpellerModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5),o=s(304),a=(s(3),s(306)),l=s(154);class c extends r.AppModule{$log(e,t={}){return!1}constructor(e,t){super(e,t),this.moduleName="speller",this.$elements={speller:document.getElementById("speller"),spellerDialog:document.getElementById("spellerDialog")},this.spellerComponent=this.makeSpellerComponent(),this.spellerModel=this.makeSpellerModel(),this.spellerStorage=this.makeSpellerStorage(),this.spellerDialog=this.makeSpellerDialog(),this.textareaPresenter=this.app.getTextareaPresenter(),this.textareaView=this.app.getTextareaPresenter().getView(),this.checkSourceText=this.debounceMethod(()=>this.spellerModel.requestData(),200),this.listenAppModel(),this.listenAppView(),this.listenSpellerModel(),this.listenSpellerComponent(),this.listenSpellerDialog(),this.listenTextArea(),this.listenSettings(),this.setupSpellerModel(),this.chunkShowTimeout=null}closeSpellerDialog(){return!1}saveUserWords(e=[]){return!1}handleCorrectionDecline(e,t,s){return!1}setCorrectedSourceText(e=!1,t=0,s){return!1}listenAppView(){}listenAppModel(){this.appModel.onChange("text",(e,t={})=>{const s=t.oldValue;if(this.spellerModel.setProperty("text",e).setProperty("textPasted","paste"===t.reason&&!s).abort(),"speller"===t.sender)return;const i=this.textareaPresenter.getCaret();this.spellerComponent.moveMisspellsPositions(e,i),this.checkSourceText(),this.closeSpellerDialog(),clearTimeout(this.chunkShowTimeout),this.chunkShowTimeout=setTimeout(()=>this.spellerComponent.showCurrentMisspell(),l.CHUNK_SHOW_TIMEOUT)}).onChange("srcLang",e=>{this.spellerModel.setProperty("lang",e),this.checkSourceText(),this.spellerComponent.resetChunks()})}listenTextArea(){this.app.getTextInputView().on("scroll",()=>{this.spellerComponent.setScrollTop(this.app.getTextInputView().getScrollTop())}),this.textareaView.onTap(n.default.debounce(()=>!1))}listenSpellerDialog(){this.spellerDialog.onManualCorrection(e=>{const t=this.spellerComponent.getChunk(this.activeChunkIndex);if(!t)return;let s=t.value===e?"speller_accept":"speller_apply";this.$log(s,{word:t.value,pos:t.pos,replacement:e}),this.spellerComponent.correctChunkByPos(t.pos,e)}).onCorrectionDecline((e,t)=>this.handleCorrectionDecline(e,t))}listenSpellerComponent(){this.spellerComponent.onTextCorrect((e,t,s)=>this.setCorrectedSourceText(e,t,s)).onCorrectionDecline((e,t,s)=>this.handleCorrectionDecline(e,t,s)).onChunkSelect((e,t,s)=>this.handleChunkSelection(e,t,s)).onWordSaved(e=>this.saveUserWords(e))}listenSpellerModel(){this.spellerModel.on("response",e=>{const t=this.prepareMisspells(e),s=this.spellerModel.getProperty("textPasted");this.spellerComponent.setMisspells(t),s&&this.app.autoSpellerEnabled()&&this.spellerComponent.correctAllChunks();const i=this.textareaPresenter.getCaret(),n=this.app.autoSpellerEnabled();this.spellerComponent.checkAndCorrect(i,n)})}prepareMisspells(e){const t=n.default.safeParseJSON(e);return n.default.isArray(t)?t:[]}listenSettings(){this.app.onToggleSpellerOption(e=>{if(e)return this.spellerComponent.correctAllChunks(!0),void this.$log("speller_switch_on");this.$log("speller_switch_off")})}setupSpellerModel(){const{text:e,srcLang:t}=this.appModel.getProps();e&&this.spellerModel.setProperty("text",e),t&&this.spellerModel.setProperty("lang",t)}makeSpellerStorage(){return new a.SpellerStorage({},{name:"touchSpeller"})}handleChunkSelection(e,t){this.$log("speller_click",{word:e.value,pos:e.pos,isAutocorrected:Boolean(e.autoCorrected)}),this.activeChunkIndex=t,this.spellerComponent.highlightChunk(t,!0),this.spellerDialog.setCorrections(e.corrections)}makeSpellerModel(){return new o.SpellerModel({srv:this.appConfig.SRV,url:this.appConfig.SPELLER_URL,options:o.SpellerModel.options.IGNORE_URLS+o.SpellerModel.options.IGNORE_CAPITALIZATION},{validators:{text:e=>e&&n.default.trim(e)&&e.length<=this.appConfig.MAX_SPELLER_LENGTH,lang:e=>n.default.hasProperty(this.appConfig.SPELLER_LANGS,e)}})}}t.AbstractSpellerModule=c},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerModel=void 0;var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(8),o=s(29),a=s(65),l=s(17),c=s(305);class d extends a.SyncModel{getData(){const e=this.toJSON();return{text:e.text,lang:e.lang,options:e.options}}getParams(){const e=this.toJSON();return{sid:e.sid,srv:e.srv}}getDefaults(){return{url:"/",srv:"",sid:this.getId(),text:"",oldText:"",lang:"",data:"",lastCaret:0,options:0}}validateResponse(e){const t=e&&e.body;return n.default.isArray(t)&&t.every(e=>"number"==typeof e.pos&&"number"==typeof e.code&&"number"==typeof e.len&&"string"==typeof e.word&&n.default.isArray(e.s))}runRequest(){const e=new l.HTTPRequest(this.getProperty("url")),t=this.getData();return this.setRequest(e.setType(l.HTTPRequest.types.FORM).setData(t).setParams(this.getParams()).setMethod(l.HTTPRequest.methods.POST).send((e,t)=>{const s=e&&e.code===o.HTTPError.ABORT;if(!(t&&t.code===l.HTTPRequest.codes.OK)||s||this.validateResponse(t)||(0,r.logError)(new c.SpellerApiError),e)return this.emit("error",e);this.emit("response",t.text)}))}requestData(){if(this.abort(),!this.isValid())return this;this.getSid().then(()=>this.runRequest())}}t.SpellerModel=d,d.options={IGNORE_UPPERCASE:1,IGNORE_DIGITS:2,IGNORE_URLS:4,FIND_REPEAT_WORDS:8,IGNORE_LATIN:16,NO_SUGGEST:32,FLAG_LATIN:128,BY_WORDS:256,IGNORE_CAPITALIZATION:512,IGNORE_ROMAN_NUMERALS:2048,ONLY_AUTOCORRECTIONS:4096}},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerApiError=void 0;class i extends Error{constructor(...e){super(...e),this.message="Speller Api Error"}}t.SpellerApiError=i},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerStorage=void 0;var i=s(63);class n extends i.Storage{wasSpellerPopupShown(){return!1}setSpellerPopupShown(e){return!1}saveUserWord(e,t){return!1}containsWord(e,t){return!1}deleteUserWord(e,t){return!1}}t.SpellerStorage=n},function(e,t,s){"use strict";t.__esModule=!0,t.SpellerComponent=void 0,s(1);var i=s(308);s(154);class n extends i.AbstractSpellerComponent{onChunkClick(e){return!1}}t.SpellerComponent=n},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractSpellerComponent=void 0,s(1),(i=s(0))&&i.__esModule;var i,n=s(6),r=(s(309),s(154));class o extends n.Component{constructor(e,t){super(e,t),this.refs={chunk:"chunk"},this.onChange("chunks",()=>this.updateAsync())}getCorrectedText(){return!1}getChunk(e){return!1}markNonCorrectableMisspells(e){return!1}findChunkByCaret(e){return!1}findChunkBySelectedText(e,t){return!1}correctChunkByPos(e,t){return!1}correctAllChunks(e=!1){return!1}showCurrentMisspell(){return!1}checkAndCorrect(e,t){return!1}declineChunkCorrection(e,t){return!1}makeChunks(){return!1}moveMisspellsPositions(e,t){return!1}setScrollTop(e){return!1}setText(e){return!1}setMisspells(e){return!1}highlightChunk(e,t=!1){return!1}resetHighlights(){return!1}resetChunks(){return!1}getFirstErroneousChunk(){return!1}getFirstAutoCorrectedChunk(){return!1}getErroneousChunkRect(){return!1}hasUnderlinedChunks(){return!1}onTextCorrect(e){return this.on(r.SPELLER_EVENTS.CORRECTED_TEXT_READY,e)}onCorrectionDecline(e){return this.on(r.SPELLER_EVENTS.DECLINE_CORRECTION,e)}onChunkSelect(e){return this.on(r.SPELLER_EVENTS.CHUNK_SELECTED,e)}onWordSaved(e){return this.on(r.SPELLER_EVENTS.SAVE_WORD,e)}template({html:e,cn:t}){const{chunks:s}=this.getProps();return t("speller"),e}}t.AbstractSpellerComponent=o,o.defaults={text:"",chunks:[],misspells:[],lastClickedChunk:null,isWordNonCorrectable:()=>!1}},function(e,t,s){"use strict";var i;t.__esModule=!0,t.showCurrentMisspell=t.moveMisspellsPositions=t.mergeMisspells=t.makeChunks=t.getWordsToSave=t.findChunkBySelectedText=t.findChunkByCaret=t.declineChunkCorrection=t.correctExactMisspell=t.canAutoDeclineCorrection=t.autoReplaceAllMisspells=t.autoCorrectFinishedWords=void 0,(i=s(0))&&i.__esModule,t.autoReplaceAllMisspells=((e=[],t="")=>!1),t.correctExactMisspell=((e,t,s,i)=>!1),t.moveMisspellsPositions=((e="",t="",s,i=[])=>!1),t.mergeMisspells=((e,t)=>!1),t.makeChunks=((e="",t=[])=>!1),t.findChunkByCaret=((e,t=[])=>!1),t.findChunkBySelectedText=((e,t,s=[])=>!1),t.declineChunkCorrection=((e,t=[],s)=>!1),t.autoCorrectFinishedWords=((e,t,s,i)=>!1),t.canAutoDeclineCorrection=((e,t,s)=>e&&e.autoCorrected&&e.new&&t[s]&&t[s].misspellValue),t.getWordsToSave=((e,t,s,i)=>!1),t.showCurrentMisspell=(e=>e.map(e=>({...e,current:!1})))},function(e,t,s){"use strict";function i(e,t,s){return!1}function n(e){return!1}t.__esModule=!0,t.SpellerDialog=void 0,s(1);var r=s(311);class o extends r.AbstractSpellerDialog{constructor(e,t){super(e,t),this.titlePrefix="",this.titlePostfix="",[this.titlePrefix,this.titlePostfix]=this.locales.spellerExplanation.split("{}")}handlePosition(e){return!1}declineCorrection(){return!1}setAutoCorrectedMode(e){return!1}getExplanationLabel(){return!1}template({html:e,cn:t}){return!1}}t.SpellerDialog=o,o.defaults={...i(n(o),"defaults",o),autoCorrectedMode:!1}},function(e,t,s){"use strict";t.__esModule=!0,t.AbstractSpellerDialog=void 0;var i=s(6),n=s(30),r=s(154);class o extends i.Component{constructor(e,t){let s;super(e,t),this.locales=n.locales.speller,this.onVisibilityChanged(e=>{clearTimeout(s),e||(s=setTimeout(()=>{this.setErroneousValue(null).setCorrections([])},200))}).onRendered(()=>{const{corrections:e}=this.getProps();e&&e.length&&this.setEnabled(!0).setVisible(!0)}).onChange(()=>this.updateAsync())}setCorrections(e=[]){return this.setProperty({corrections:e})}setErroneousValue(e){return this.setProperty({erroneousValue:e})}correctMisspell(e){this.setVisible(!1).emit(r.SPELLER_EVENTS.CORRECT_TEXT,e)}declineCorrection(){const{erroneousValue:e,corrections:t}=this.getProps();this.setVisible(!1).emit(r.SPELLER_EVENTS.DECLINE_CORRECTION,e,t[0])}onManualCorrection(e){return this.on(r.SPELLER_EVENTS.CORRECT_TEXT,e)}onCorrectionDecline(e){return this.on(r.SPELLER_EVENTS.DECLINE_CORRECTION,e)}template(){return this.getRenderHelpers().nothing}}t.AbstractSpellerDialog=o,o.defaults={corrections:[],erroneousValue:""}},function(e,t,s){"use strict";t.__esModule=!0,t.BlocksVisibilityModule=void 0,s(1);var i,n=(i=s(0))&&i.__esModule?i:{default:i},r=s(5);s(3);class o extends r.AppModule{constructor(e,t){super(e,t),this.moduleName="blocksVisibility",n.default.isIntersectionObserverSupported()&&(this.blocks=[{id:"examples",threshold:.1},{id:"dictionary",threshold:.5},{id:"relatedWords",threshold:.5},{id:"declensions",threshold:.5},{id:"definition",threshold:.5},{id:"idiomDefinition",threshold:.5}].map(e=>({...e,elem:t.ELEMENTS[e.id]})),this.seenBlocks={},this.observeBlocks(),this.listenAppModel())}resetBlocksVisibility(){return!1}trackVisibility(e,t){return!1}observeBlocks(){return!1}listenAppModel(){return!1}}t.BlocksVisibilityModule=o},function(e,t,s){"use strict";t.__esModule=!0,t.ScrollHeaderModule=void 0,(i=s(0))&&i.__esModule,s(3);var i,n=s(5),r=s(16),o=s(2);class a extends n.AppModule{constructor(e,t){super(e,t),this.$elements={header:document.getElementById("header"),headerNavMenuPopup:document.getElementById("headerNavMenuPopup"),headerNavMenuBtn:document.getElementById("headerNavMenuBtn"),headerTranslateText:document.getElementById("headerTranslateText")},this.headerView=new r.View({element:this.$elements.header}),this.headerNavMenuBtnView=new o.TouchView({element:this.$elements.headerNavMenuBtn}),this.headerNavMenuPopupView=new o.TouchView({element:this.$elements.headerNavMenuPopup}),this.headerTranslateText=new o.TouchView({element:this.$elements.headerTranslateText}),this.hasScrollLock=!1,this.listenAppScroll(),this.listenAppResize(),this.listenNavBtn(),this.listenNavPopup(),this.listenAppTextChange(),this.listenHeaderTranslateText()}handleAppScroll(){return!1}listenAppScroll(){return!1}listenAppResize(){return!1}listenNavBtn(){return!1}listenNavPopup(){return!1}activateScrolledState(){return!1}deactivateScrolledState(){return!1}setScrollingToTopState(){return!1}handleAppTextChange(){this.headerView.setState("large-text",this.isAppTextLarge())}listenAppTextChange(){this.appModel.onChange("text",e=>{this.headerTranslateText.setTextContent(e),this.handleAppTextChange()})}listenHeaderTranslateText(){return!1}scrollToTop(){return!1}isAppTextLarge(){return(this.appModel.getProperty("text")||"").length>=20}}t.ScrollHeaderModule=a},function(e,t,s){"use strict";t.__esModule=!0,t.getTextTemplates=function(){return!1},s(67),s(15),window.config.LOCALIZATIONS},function(e,t,s){"use strict";t.__esModule=!0,t.getTextElements=function(){return{textbox:i("textbox"),fakeArea:i("fakeArea"),textarea:i("textarea"),dictionary:i("dictionary"),textSpeaker:i("textSpeaker"),examples:i("examples"),historyRecent:i("historyRecent"),idiomDefinition:i("idiomDefinition"),cardsCarousel:i("cardsCarousel"),relatedWords:i("relatedWords"),declensions:i("declensions"),definition:i("definition"),sourceTranslit:i("sourceTranslit"),targetTranslit:i("targetTranslit"),textApp:i("textApp")}};const i=e=>document.getElementById(e)}]);